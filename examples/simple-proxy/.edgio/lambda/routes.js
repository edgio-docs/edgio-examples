var df=Object.create;var an=Object.defineProperty;var hf=Object.getOwnPropertyDescriptor;var ff=Object.getOwnPropertyNames;var pf=Object.getPrototypeOf,gf=Object.prototype.hasOwnProperty;var p=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),mf=(e,t)=>{for(var r in t)an(e,r,{get:t[r],enumerable:!0})},Ua=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of ff(t))!gf.call(e,s)&&s!==r&&an(e,s,{get:()=>t[s],enumerable:!(n=hf(t,s))||n.enumerable});return e};var Wa=(e,t,r)=>(r=e!=null?df(pf(e)):{},Ua(t||!e||!e.__esModule?an(r,"default",{value:e,enumerable:!0}):r,e)),vf=e=>Ua(an({},"__esModule",{value:!0}),e);var re=p(q=>{"use strict";Object.defineProperty(q,"__esModule",{value:!0});q.LAYER0_CONFIG_FILE="layer0.config.js";q.EDGIO_CONFIG_FILE="edgio.config.js";q.EDGIO_ASSET_ALIASES_FILE="asset-aliases.json";q.EDGIO_ENV_VARIABLES={config:"EDGIO_CONFIG",deploymentType:"EDGIO_DEPLOYMENT_TYPE",versionOverride:"EDGIO_VERSION_OVERRIDE",productionBuild:"EDGIO_PRODUCTION_BUILD"};q.EDGIO_DEPLOYMENT_TYPE_AWS="AWS";q.EDGIO_HEADERS_PREFIX="x-0-";q.EDGIO_MAX_USER_HEADERS_ALLOWED=70;q.EDGIO_TOO_MANY_HEADERS_STATUS_CODE=542;q.EDGIO_UNCACHED_PREFETCH_STATUS=412;q.ACTIONS={setHeader:"set-header",updateHeader:"update-header",removeHeader:"remove-header",syntheticRes:"synthetic-response",updatePath:"update-path",proxy:"proxy",addCookie:"add-cookie",updateCookie:"update-cookie",removeCookie:"remove-cookie"};q.BACKENDS={js:"__js__",static:"__static__",permanentStatic:"__permanent_static__",imageOptimizer:"__image_optimizer__"};q.JS_BACKEND_HOSTNAME="127.0.0.1";q.HTTP_METHODS={head:"head",get:"get",post:"post",delete:"delete",put:"put",patch:"patch",options:"options"};q.HTTP_HEADERS={acceptEncoding:"accept-encoding",authorization:"authorization",cacheControl:"cache-control",contentEncoding:"content-encoding",contentLength:"content-length",contentType:"content-type",cookie:"cookie",host:"host",location:"location",serverTiming:"server-timing",setCookie:"set-cookie",userAgent:"user-agent",vary:"vary",via:"via",x0Browser:"x-0-browser",x0CacheControl:"x-0-cache-control",x0CacheVersion:"x-0-cache-version",x0CachingStatus:"x-0-caching-status",x0ClientIp:"x-0-client-ip",x0Components:"x-0-components",x0Destination:"x-0-destination",x0Device:"x-0-device",x0DeviceIsBot:"x-0-device-is-bot",x0GeoCity:"x-0-geo-city",x0GeoCountryCode:"x-0-geo-country-code",x0GeoLatitude:"x-0-geo-latitude",x0GeoLongitude:"x-0-geo-longitude",x0GeoPostalCode:"x-0-geo-postal-code",x0MatchedRoutes:"x-0-matched-routes",x0Protocol:"x-0-protocol",x0Route:"x-0-route",x0Status:"x-0-status",x0SurrogateKey:"x-0-surrogate-key",x0T:"x-0-t",x0UserT:"x-0-user-t",x0Vendor:"x-0-vendor",x0Version:"x-0-version",xForwardedFor:"x-forwarded-for",xRequestId:"x-request-id",xSwCacheControl:"x-sw-cache-control"};q.CACHING_STATUS={ok:"ok",private:"private",method:"method",bodyTooBig:"body-too-big",code:"code",setCookie:"set-cookie",noMaxAge:"no-max-age"};q.CACHEABLE_METHODS=new Set(["get","head"]);q.THROTTLED_QUERY_PARAM="edgio_prefetch";q.PREFETCH_QUERY_PARAM=q.THROTTLED_QUERY_PARAM;q.PREFETCH_TTL_PARAM="edgio_prefetch_ttl";q.DEVTOOLS_PREFETCH_QUERY_PARAM="edgio_dt_pf";q.HEAD_QUERY_PARAM="edgio_head";q.POST_BODY_QUERY_PARAM="pref_edgio_body";q.METHOD_QUERY_PARAM="pref_edgio_method";q.ROUTES_FALLBACK="fallback";q.ROUTES_CATCH_GROUP="catch";q.ROUTES_NOINDEX_GROUP="noindex";q.HOSTS_NOINDEX_PERMALINK_REGEX=/\.layer0\.link|\.layer0-perma\.link|\.edgio\.link|\.edgio-perma\.link|\.layer0-limelight\.link/;q.EDGIO_IMAGE_OPTIMIZER_PATH="/__layer0_image_optimizer";q.IS_BROWSER=typeof window<"u";q.BROTLI_ENCODING="br";q.GZIP_ENCODING="gzip"});var qt=p(nt=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0});var ys=re();function Ga(){return process.env[ys.EDGIO_ENV_VARIABLES.deploymentType]===ys.EDGIO_DEPLOYMENT_TYPE_AWS}nt.isCloud=Ga;function yf(){return process.env.EDGIO_LOCAL==="true"}nt.isLocal=yf;function Ka(){return process.env.NODE_ENV==="production"||process.env[ys.EDGIO_ENV_VARIABLES.productionBuild]==="true"}nt.isProductionBuild=Ka;function _f(){return!Ga()&&!Ka()}nt.isEdgioRunDev=_f;function bf(){return typeof window<"u"}nt.isBrowser=bf});var or=p((dE,za)=>{"use strict";za.exports=e=>{let t=/^\\\\\?\\/.test(e),r=/[^\u0000-\u0080]+/.test(e);return t||r?e:e.replace(/\\/g,"/")}});var Ge=p((exports,module)=>{"use strict";var __importDefault=exports&&exports.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var slash_1=__importDefault(or());function nonWebpackRequire(modulePath,{ignoreErrors=!1}={}){try{return eval("require")(slash_1.default(modulePath))}catch(e){if(ignoreErrors)return;throw e}}exports.default=nonWebpackRequire});var Xa=p(st=>{"use strict";var Ef=st&&st.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(st,"__esModule",{value:!0});var wf=qt(),Ya=Ef(Ge()),Ja="edgio",_s;function Rf(e){return wf.isLocal()?Af().runAndReturn(e):(global.__edgio_timings__=new bs,e())}st.withContext=Rf;function Qa(){return global.__edgio_timings__||Cf()}function Af(){let e=Ya.default("cls-hooked");return _s||(_s=e.createNamespace(Ja)),_s}function Cf(){return Ya.default("cls-hooked").getNamespace(Ja)}function Sf(e,t){try{let r=Qa(),n=r.get(e);return n==null&&(n=t,r.set(e,t)),n}catch{return t}}st.get=Sf;function Tf(e,t){try{Qa().set(e,t)}catch{throw new Error("set must be called within withContext")}}st.set=Tf;var bs=class{constructor(){this.values={}}get(t){return this.values[t]}set(t,r){this.values[t]=r}}});var Cs=p(be=>{"use strict";Object.defineProperty(be,"__esModule",{value:!0});var un=re(),ws=Xa();be.NOT_ENDED_VALUE="na";var ln=class{constructor(t,r=!0){this.duration=0,this.ended=!1,this.name=t,(r?Rs():As()).push(this)}start(){return this.startTime=new Date,this.ended=!1,this}set(t){return this.discreteValue=t,this}end(){return this.startTime?(this.ended=!0,this.duration+=new Date().getTime()-this.startTime.getTime(),this):(console.warn(`Timing ${this.name} not started.`),this)}pause(){return this.end()}resume(){return this.start()}get value(){return this.discreteValue!=null?this.discreteValue:this.ended?this.duration:be.NOT_ENDED_VALUE}};be.InternalTiming=ln;function xf(e){return(...t)=>ws.withContext(()=>e(...t))}be.withTimings=xf;function Of(e){var t;return(t=Rs().find(r=>r.name===e))===null||t===void 0?void 0:t.value}be.getInternalTiming=Of;function Rs(){return ws.get("internalTimings",[])}function As(){return ws.get("userTimings",[])}function Pf(e){let t=As(),r=Rs();t.length&&(e.setHeader(un.HTTP_HEADERS.x0UserT,Za(t)),e.setHeader(un.HTTP_HEADERS.serverTiming,Hf(e))),r.length&&e.setHeader(un.HTTP_HEADERS.x0T,Za(r))}be.addTimings=Pf;function Za(e){return e.map(t=>`${t.name}=${t.value}`).join(",")}function Hf(e){let t=e.getHeader(un.HTTP_HEADERS.serverTiming),r=As().map(n=>`${n.name};dur=${n.value}`);return Array.isArray(t)?r.push(...t):t&&r.push(t),r.join(", ")}var Es=class extends ln{constructor(t){super(t,!1)}};be.default=Es;var Nf;(function(e){e.edgeCache="ecc",e.transformRequest="wa",e.transformResponse="wz",e.routeMatching="wr",e.proxying="wp"})(Nf=be.InternalNames||(be.InternalNames={}));var qf;(function(e){e.hit="hit",e.pass="pass",e.cached="cached"})(qf=be.CacheValue||(be.CacheValue={}))});var Ts=p(Ss=>{"use strict";Object.defineProperty(Ss,"__esModule",{value:!0});Ss.default=If;var Df=Mf(require("crypto"));function Mf(e){return e&&e.__esModule?e:{default:e}}var dn=new Uint8Array(256),cn=dn.length;function If(){return cn>dn.length-16&&(Df.default.randomFillSync(dn),cn=0),dn.slice(cn,cn+=16)}});var eu=p(hn=>{"use strict";Object.defineProperty(hn,"__esModule",{value:!0});hn.default=void 0;var Vf=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;hn.default=Vf});var ar=p(fn=>{"use strict";Object.defineProperty(fn,"__esModule",{value:!0});fn.default=void 0;var Bf=kf(eu());function kf(e){return e&&e.__esModule?e:{default:e}}function jf(e){return typeof e=="string"&&Bf.default.test(e)}var Lf=jf;fn.default=Lf});var ur=p(pn=>{"use strict";Object.defineProperty(pn,"__esModule",{value:!0});pn.default=void 0;var Ff=$f(ar());function $f(e){return e&&e.__esModule?e:{default:e}}var le=[];for(let e=0;e<256;++e)le.push((e+256).toString(16).substr(1));function Uf(e,t=0){let r=(le[e[t+0]]+le[e[t+1]]+le[e[t+2]]+le[e[t+3]]+"-"+le[e[t+4]]+le[e[t+5]]+"-"+le[e[t+6]]+le[e[t+7]]+"-"+le[e[t+8]]+le[e[t+9]]+"-"+le[e[t+10]]+le[e[t+11]]+le[e[t+12]]+le[e[t+13]]+le[e[t+14]]+le[e[t+15]]).toLowerCase();if(!(0,Ff.default)(r))throw TypeError("Stringified UUID is invalid");return r}var Wf=Uf;pn.default=Wf});var nu=p(gn=>{"use strict";Object.defineProperty(gn,"__esModule",{value:!0});gn.default=void 0;var Gf=ru(Ts()),Kf=ru(ur());function ru(e){return e&&e.__esModule?e:{default:e}}var tu,xs,Os=0,Ps=0;function zf(e,t,r){let n=t&&r||0,s=t||new Array(16);e=e||{};let i=e.node||tu,o=e.clockseq!==void 0?e.clockseq:xs;if(i==null||o==null){let h=e.random||(e.rng||Gf.default)();i==null&&(i=tu=[h[0]|1,h[1],h[2],h[3],h[4],h[5]]),o==null&&(o=xs=(h[6]<<8|h[7])&16383)}let a=e.msecs!==void 0?e.msecs:Date.now(),u=e.nsecs!==void 0?e.nsecs:Ps+1,l=a-Os+(u-Ps)/1e4;if(l<0&&e.clockseq===void 0&&(o=o+1&16383),(l<0||a>Os)&&e.nsecs===void 0&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Os=a,Ps=u,xs=o,a+=122192928e5;let c=((a&268435455)*1e4+u)%4294967296;s[n++]=c>>>24&255,s[n++]=c>>>16&255,s[n++]=c>>>8&255,s[n++]=c&255;let d=a/4294967296*1e4&268435455;s[n++]=d>>>8&255,s[n++]=d&255,s[n++]=d>>>24&15|16,s[n++]=d>>>16&255,s[n++]=o>>>8|128,s[n++]=o&255;for(let h=0;h<6;++h)s[n+h]=i[h];return t||(0,Kf.default)(s)}var Yf=zf;gn.default=Yf});var Hs=p(mn=>{"use strict";Object.defineProperty(mn,"__esModule",{value:!0});mn.default=void 0;var Jf=Qf(ar());function Qf(e){return e&&e.__esModule?e:{default:e}}function Xf(e){if(!(0,Jf.default)(e))throw TypeError("Invalid UUID");let t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=t&255,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=t&255,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=t&255,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=t&255,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=t&255,r}var Zf=Xf;mn.default=Zf});var Ns=p(it=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0});it.default=np;it.URL=it.DNS=void 0;var ep=su(ur()),tp=su(Hs());function su(e){return e&&e.__esModule?e:{default:e}}function rp(e){e=unescape(encodeURIComponent(e));let t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}var iu="6ba7b810-9dad-11d1-80b4-00c04fd430c8";it.DNS=iu;var ou="6ba7b811-9dad-11d1-80b4-00c04fd430c8";it.URL=ou;function np(e,t,r){function n(s,i,o,a){if(typeof s=="string"&&(s=rp(s)),typeof i=="string"&&(i=(0,tp.default)(i)),i.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+s.length);if(u.set(i),u.set(s,i.length),u=r(u),u[6]=u[6]&15|t,u[8]=u[8]&63|128,o){a=a||0;for(let l=0;l<16;++l)o[a+l]=u[l];return o}return(0,ep.default)(u)}try{n.name=e}catch{}return n.DNS=iu,n.URL=ou,n}});var au=p(vn=>{"use strict";Object.defineProperty(vn,"__esModule",{value:!0});vn.default=void 0;var sp=ip(require("crypto"));function ip(e){return e&&e.__esModule?e:{default:e}}function op(e){return Array.isArray(e)?e=Buffer.from(e):typeof e=="string"&&(e=Buffer.from(e,"utf8")),sp.default.createHash("md5").update(e).digest()}var ap=op;vn.default=ap});var lu=p(yn=>{"use strict";Object.defineProperty(yn,"__esModule",{value:!0});yn.default=void 0;var up=uu(Ns()),lp=uu(au());function uu(e){return e&&e.__esModule?e:{default:e}}var cp=(0,up.default)("v3",48,lp.default),dp=cp;yn.default=dp});var du=p(_n=>{"use strict";Object.defineProperty(_n,"__esModule",{value:!0});_n.default=void 0;var hp=cu(Ts()),fp=cu(ur());function cu(e){return e&&e.__esModule?e:{default:e}}function pp(e,t,r){e=e||{};let n=e.random||(e.rng||hp.default)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){r=r||0;for(let s=0;s<16;++s)t[r+s]=n[s];return t}return(0,fp.default)(n)}var gp=pp;_n.default=gp});var hu=p(bn=>{"use strict";Object.defineProperty(bn,"__esModule",{value:!0});bn.default=void 0;var mp=vp(require("crypto"));function vp(e){return e&&e.__esModule?e:{default:e}}function yp(e){return Array.isArray(e)?e=Buffer.from(e):typeof e=="string"&&(e=Buffer.from(e,"utf8")),mp.default.createHash("sha1").update(e).digest()}var _p=yp;bn.default=_p});var pu=p(En=>{"use strict";Object.defineProperty(En,"__esModule",{value:!0});En.default=void 0;var bp=fu(Ns()),Ep=fu(hu());function fu(e){return e&&e.__esModule?e:{default:e}}var wp=(0,bp.default)("v5",80,Ep.default),Rp=wp;En.default=Rp});var gu=p(wn=>{"use strict";Object.defineProperty(wn,"__esModule",{value:!0});wn.default=void 0;var Ap="00000000-0000-0000-0000-000000000000";wn.default=Ap});var mu=p(Rn=>{"use strict";Object.defineProperty(Rn,"__esModule",{value:!0});Rn.default=void 0;var Cp=Sp(ar());function Sp(e){return e&&e.__esModule?e:{default:e}}function Tp(e){if(!(0,Cp.default)(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}var xp=Tp;Rn.default=xp});var vu=p(Pe=>{"use strict";Object.defineProperty(Pe,"__esModule",{value:!0});Object.defineProperty(Pe,"v1",{enumerable:!0,get:function(){return Op.default}});Object.defineProperty(Pe,"v3",{enumerable:!0,get:function(){return Pp.default}});Object.defineProperty(Pe,"v4",{enumerable:!0,get:function(){return Hp.default}});Object.defineProperty(Pe,"v5",{enumerable:!0,get:function(){return Np.default}});Object.defineProperty(Pe,"NIL",{enumerable:!0,get:function(){return qp.default}});Object.defineProperty(Pe,"version",{enumerable:!0,get:function(){return Dp.default}});Object.defineProperty(Pe,"validate",{enumerable:!0,get:function(){return Mp.default}});Object.defineProperty(Pe,"stringify",{enumerable:!0,get:function(){return Ip.default}});Object.defineProperty(Pe,"parse",{enumerable:!0,get:function(){return Vp.default}});var Op=Ie(nu()),Pp=Ie(lu()),Hp=Ie(du()),Np=Ie(pu()),qp=Ie(gu()),Dp=Ie(mu()),Mp=Ie(ar()),Ip=Ie(ur()),Vp=Ie(Hs());function Ie(e){return e&&e.__esModule?e:{default:e}}});var Ds=p(lr=>{"use strict";var yu=lr&&lr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(lr,"__esModule",{value:!0});var Bp=yu(require("url")),kp=yu(require("querystring")),qs=class{constructor(t,r,n){}_readRedirectParams(t,r){let{statusCode:n=302,query:s={}}=typeof r=="number"?{statusCode:r}:r,i={},o=Bp.default.parse(t);return o!=null&&o.search&&(t=t.substr(0,t.length-o.search.length),i=kp.default.parse(o.query)),{to:t,statusCode:n,query:{...i,...s}}}cache(t){}redirect(t,r){}proxy(t,r){}render(t){}stream(t){}serveStatic(t,r){}updatePath(t){}rewrite(t,r){}setRequestHeader(t,r){}updateRequestHeader(t,r,n){}removeRequestHeader(t){}setUpstreamResponseHeader(t,r){}updateUpstreamResponseHeader(t,r,n){}removeUpstreamResponseHeader(t){}setResponseHeader(t,r){}updateResponseHeader(t,r,n){}removeResponseHeader(t){}addResponseCookie(t,r,n){}updateResponseCookie(t,r,n){}removeResponseCookie(t){}addUpstreamResponseCookie(t,r,n){}updateUpstreamResponseCookie(t,r,n){}removeUpstreamResponseCookie(t){}send(t,r,n){}compute(t){}serviceWorker(t){}allowCors(t){}appShell(t){}renderWithApp(t){}};lr.BaseResponseWriter=qs});var cr=p(ot=>{"use strict";Object.defineProperty(ot,"__esModule",{value:!0});var jp=e=>e;function Lp(e,t,r=jp){let n={};return Object.entries(e).every(([s,i])=>{let o=t[r(s)];if(i===null)return o===void 0;if(typeof i=="string"){if(typeof o=="string"&&bu(i)){let a=Eu(i);return n[a]=o,!0}i=new RegExp(`^${i}$`,"i")}return Ms(i,o)})&&n}ot.matchCriteriaRegexObjectWithRequestObject=Lp;function _u(e,t){return Object.entries(t).every(([r,n])=>{let s=e[r];return s?n instanceof RegExp?Ms(n,s):typeof n=="object"&&n!==null?_u(s,n):s==n:!1})}ot.deepMatchObject=_u;function bu(e){return typeof e=="string"&&/^:\w+$/.test(e)}ot.isParamMatcher=bu;function Eu(e){return e.slice(1)}ot.paramMatcherToParam=Eu;function Ms(e,t){return t==null?!1:(e.global&&(e=new RegExp(e)),Array.isArray(t)?t.some(r=>e.test(r)):e.test(t))}ot.testRegExp=Ms});var Vs=p(Is=>{"use strict";Object.defineProperty(Is,"__esModule",{value:!0});function Fp(e,t){let r={};for(let[n,s]of Object.entries(e))r[n]=t(s,n);return r}Is.default=Fp});var wu=p(dr=>{"use strict";var $p=dr&&dr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(dr,"__esModule",{value:!0});var Up=cr(),Wp=$p(Vs()),Ke=class{constructor(t){this.entries=t||[]}get cacheableEntries(){return this.entries.filter(Ke.isEntryCacheable)}get spaRoutes(){return this.cacheableEntries.filter(({cacheOptions:t})=>t.browser&&t.browser.spa).map(({route:t})=>new RegExp(t,"i"))}shouldPrefetch(t){let r=!1;return this.entries.some(n=>Ke.entryMatches(n,t)?(r=Ke.isEntryCacheable(n)||!!n.cacheOptions.prefetchUpstreamRequests,r||n.returnsResponse):!1),r}static entryMatches(t,r){return new RegExp(t.route,"i").test(r.pathname)&&Up.matchCriteriaRegexObjectWithRequestObject(Wp.default(t.query||{},n=>n?new RegExp(n,"i"):null),Object.fromEntries(Array.from(r.searchParams.entries())))&&(t.protocol?new RegExp(t.protocol,"i").test(r.protocol):!0)}static isEntryCacheable({cacheOptions:t}){return!!(t.browser&&(t.browser.serviceWorkerSeconds||0)>0&&t.edge&&(t.edge.maxAgeSeconds||0)>0)}static fromEntries(t){return new Ke(t)}toJSON(){return JSON.stringify(this.entries)}};dr.default=Ke});var Au=p(hr=>{"use strict";var Ru=hr&&hr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(hr,"__esModule",{value:!0});var Gp=Ds(),Kp=Ru(wu()),zp=Ru(Vs());function Yp(e){let t=new Kp.default,r=n=>{if(n!==void 0)return n instanceof RegExp?n.source:n};for(let n of e.routeGroups.getRoutes()){let s=new Bs;n.handler(s);let i={criteriaPath:n.criteria.path,route:n.toRegexString(),method:r(n.criteria.method),protocol:r(n.criteria.protocol),cacheOptions:s.cacheOptions,returnsResponse:s.returnsResponse};n.criteria.query&&(i.query=zp.default(n.criteria.query,o=>o?o.source:null)),!(n.criteria.headers||n.criteria.cookies)&&t.entries.push(i)}return t}hr.default=Yp;var Bs=class extends Gp.BaseResponseWriter{constructor(){super(...arguments),this.response={},this.request={},this.cacheOptions={},this.returnsResponse=!1,this.doesReturnResponse=()=>this.returnsResponse=!0,this.cache=t=>{this.cacheOptions=t},this.send=this.doesReturnResponse,this.compute=this.doesReturnResponse,this.proxy=this.doesReturnResponse,this.redirect=this.doesReturnResponse,this.render=this.doesReturnResponse,this.serveStatic=this.doesReturnResponse,this.serviceWorker=this.doesReturnResponse,this.renderWithApp=this.doesReturnResponse,this.appShell=this.doesReturnResponse,this.stream=this.doesReturnResponse}}});var xu=p((DE,Tu)=>{var Jp=require("path"),Qp=60*60*24*365*10,Xp={edge:{maxAgeSeconds:Qp},browser:!1},Cu="edgio_devtools_enabled",Zp="edgio_devtools_env_enabled";function Su(){return process.env.EDGIO_DEVTOOLS_ENABLED?process.env.EDGIO_DEVTOOLS_ENABLED==="true":process.env.PREVIEW_EDGIO_DEVTOOLS_ENABLED?process.env.PREVIEW_EDGIO_DEVTOOLS_ENABLED==="true":null}Tu.exports=function({router:t,local:r}){Su()!==null&&t.match("/(.*)",({addResponseCookie:n})=>{n(Zp,`${Su()}; Path=/`)}),r&&t.get("/__edgio__/caching",n=>{n.send(JSON.stringify({local:r,enabled:process.env.EDGIO_CACHE==="true"}))}).post("/__edgio__/caching",n=>{let s=n.request.query;s&&(process.env.EDGIO_CACHE=s.enabled),n.send("done")}),t.get("/__edgio__/devtools/enable",({redirect:n,addResponseCookie:s,cache:i})=>{s(Cu,"true; Path=/"),i({browser:!1,edge:!1}),n("/")}).get("/__edgio__/devtools/disable",({redirect:n,addResponseCookie:s,cache:i})=>{s(Cu,"false; Path=/"),i({browser:!1,edge:!1}),n("/")}).match("/__edgio__/devtools/:path*",({cache:n,serveStatic:s})=>{n(Xp),s(Jp.join("node_modules","@edgio","devtools","widget",":path*"))})}});var Pu=p(fr=>{"use strict";var eg=fr&&fr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(fr,"__esModule",{value:!0});var tg=eg(Au()),rg=qt(),Ou=re();function ng(e,t){sg(e);try{xu()({router:e,local:rg.isLocal()})}catch(r){if(r.code!=="MODULE_NOT_FOUND")throw r}t.indexPermalink||e.group(Ou.ROUTES_NOINDEX_GROUP,r=>r.match({headers:{host:Ou.HOSTS_NOINDEX_PERMALINK_REGEX}},({setResponseHeader:n})=>{n("x-robots-tag","noindex")}))}fr.default=ng;function sg(e){e.match("/__edgio__/cache-manifest.js",({cache:t,setResponseHeader:r,send:n,allowCors:s})=>{t({edge:{maxAgeSeconds:60*60*24*365},browser:{maxAgeSeconds:60}}),r("content-type","text/javascript"),s(),n(()=>`self.__EDGIO_CACHE_MANIFEST__=${tg.default(e).toJSON()}`)}),e.match("/__(layer0|xdn)__/cache-manifest.js",({redirect:t,allowCors:r})=>(r(),t("/__edgio__/cache-manifest.js",301)))}});var Hu=p(ks=>{"use strict";Object.defineProperty(ks,"__esModule",{value:!0});var ig=new Set(["cache","setRequestHeader","updateRequestHeader","removeRequestHeader","setResponseHeader","updateResponseHeader","removeResponseHeader","setUpstreamResponseHeader","updateUpstreamResponseHeader","removeUpstreamResponseHeader","addResponseCookie","updateResponseCookie","removeResponseCookie","addUpstreamResponseCookie","updateUpstreamResponseCookie","removeUpstreamResponseCookie"]),og=e=>{let t=(r,n)=>async function(...s){if(!!r.runningImmediately)return await r[n](...s)}.bind(r);return new Proxy(e,{get:(r,n)=>n==="serveStatic"?ag(r,r.serveStatic):ig.has(n.toString())?t(r,n):r[n]})};ks.default={create:og};function ag(e,t){return async(r,n={})=>{if(e.runningImmediately)return t.call(e,r,n);if(n.onNotFound)e.setCreateResponseAction(()=>e.runImmediately(()=>n.onNotFound(e)));else throw new Error("Should not get to serveStatic without onNotFound when running behind the edge.")}}});var An=p(js=>{"use strict";Object.defineProperty(js,"__esModule",{value:!0});function ug(e,t){let r=e,n=t.split(".");for(let s of n){if(typeof r>"u")return;r=r[s]}return r}js.default=ug});var Nu=p(pr=>{"use strict";var lg=pr&&pr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(pr,"__esModule",{value:!0});var cg=lg(An());function dg(e,t){return!!cg.default(e,t)}pr.default=dg});var Iu=p((kE,Mu)=>{"use strict";var hg=function(t){return fg(t)&&!pg(t)};function fg(e){return!!e&&typeof e=="object"}function pg(e){var t=Object.prototype.toString.call(e);return t==="[object RegExp]"||t==="[object Date]"||vg(e)}var gg=typeof Symbol=="function"&&Symbol.for,mg=gg?Symbol.for("react.element"):60103;function vg(e){return e.$$typeof===mg}function yg(e){return Array.isArray(e)?[]:{}}function gr(e,t){return t.clone!==!1&&t.isMergeableObject(e)?Dt(yg(e),e,t):e}function _g(e,t,r){return e.concat(t).map(function(n){return gr(n,r)})}function bg(e,t){if(!t.customMerge)return Dt;var r=t.customMerge(e);return typeof r=="function"?r:Dt}function Eg(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return e.propertyIsEnumerable(t)}):[]}function qu(e){return Object.keys(e).concat(Eg(e))}function Du(e,t){try{return t in e}catch{return!1}}function wg(e,t){return Du(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))}function Rg(e,t,r){var n={};return r.isMergeableObject(e)&&qu(e).forEach(function(s){n[s]=gr(e[s],r)}),qu(t).forEach(function(s){wg(e,s)||(Du(e,s)&&r.isMergeableObject(t[s])?n[s]=bg(s,r)(e[s],t[s],r):n[s]=gr(t[s],r))}),n}function Dt(e,t,r){r=r||{},r.arrayMerge=r.arrayMerge||_g,r.isMergeableObject=r.isMergeableObject||hg,r.cloneUnlessOtherwiseSpecified=gr;var n=Array.isArray(t),s=Array.isArray(e),i=n===s;return i?n?r.arrayMerge(e,t,r):Rg(e,t,r):gr(t,r)}Dt.all=function(t,r){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(n,s){return Dt(n,s,r)},{})};var Ag=Dt;Mu.exports=Ag});var ju=p(mr=>{"use strict";var Cg=mr&&mr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(mr,"__esModule",{value:!0});var Vu=require("os"),Cn=re(),Sg=qt(),Tg=Cg(Ge()),$s={$id:"/domainOrIpSchema",type:"string",minLength:1},Bu={$id:"/backendObjectSchema",type:"object",properties:{domainOrIp:{$ref:$s.$id},port:{type:"number",minimum:1,maximum:65535},hostHeader:{type:"string",minLength:1},disableCheckCert:{type:"boolean"},firstByteTimeout:{type:"number"},basePath:{type:"string"}},additionalProperties:!1,required:["domainOrIp"]},ku={$id:"/backendSchema",type:"object",patternProperties:{"^.*$":{oneOf:[{$ref:$s.$id},{$ref:Bu.$id}]}}},Ls={$id:"/edgioFileConfigurationSchema",type:"object",properties:{name:{type:"string"},team:{type:"string"},prerenderConcurrency:{type:"number"},production:{type:"boolean"},routes:{type:"string"},server:{type:"object",required:["path"],properties:{path:{type:"string"},export:{type:"string"}}},includeFiles:{type:"object"},sources:{type:"array",items:{type:"string"}},backends:{$ref:ku.$id},includeNodeModules:{type:"boolean"},connector:{type:"string"},disableImageOptimizer:{type:"boolean"}},additionalProperties:!1,required:[]},Fs=class{static validateEdgioFileConfiguration(t){if(Sg.isCloud())return t;let r=Tg.default("ajv");if(t.connector)try{let o=require(`${t.connector}/configSchema`);Object.assign(Ls.properties,o)}catch{}let n=new r({allErrors:!0,schemas:[Ls,ku,Bu,$s]}),s=[],i=n.getSchema(Ls.$id);if(t.backends&&t.backends.moov!=null&&s.push({message:"is a reserved backend name",dataPath:".backends['moov']"}),t.backends&&t.backends[Cn.BACKENDS.static]&&s.push({message:"is a reserved backend name",dataPath:`.backends.${Cn.BACKENDS.static}`}),t.backends&&t.backends[Cn.BACKENDS.js]&&s.push({message:"is a reserved backend name",dataPath:`.backends.${Cn.BACKENDS.js}`}),!i(t)&&i.errors&&(s=[...s,...i.errors]),s.length){let o=s.map((a,u)=>{let l=`${u+1}) config${a.dataPath}: ${a.message}`;return a.keyword==="additionalProperties"&&(l+=` '${a.params.additionalProperty}'`),l}).join(Vu.EOL);throw new Error(`Edgio configuration validation failed with errors: ${Vu.EOL}${o}`)}return t}};mr.default=Fs});var ut=p(yr=>{"use strict";var _r=yr&&yr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(yr,"__esModule",{value:!0});var xg=_r(An()),Og=_r(Nu()),Pg=_r(Iu()),Lu=require("fs"),vr=require("path"),at=re(),Hg=_r(ju()),Ng=_r(Ge()),Us=class{get(t,r){if(this.has(t))return xg.default(this.values,t);if(typeof r<"u")return r;throw new Error(`Edgio configuration key: "${t}" is not defined`)}has(t){return this.values||this.loadEdgioConfig(),Og.default(this.values,t)}get all(){return this.values||this.loadEdgioConfig(),this.values}loadEdgioConfig(){let t=this.loadFromFile(),r=this.loadFromEnv();this.values=this.trimStrings(Pg.default.all([{},this.getDefaults(),t,r]))}trimStrings(t){return Object.entries(t).forEach(([r,n])=>{typeof n=="object"?this.trimStrings(n):typeof n=="string"&&(t[r]=n.trim())}),t}loadFromFile(){let t=[vr.join(process.cwd(),at.LAYER0_CONFIG_FILE),vr.join(process.cwd(),at.LAYER0_CONFIG_FILE.replace(".js",".cjs")),vr.join(process.cwd(),at.EDGIO_CONFIG_FILE),vr.join(process.cwd(),at.EDGIO_CONFIG_FILE.replace(".js",".cjs"))].find(Lu.existsSync);if(t)try{let r=Ng.default(t);return Hg.default.validateEdgioFileConfiguration(r)}catch(r){throw new Error(`Failed to load ${t}: ${r.message}`)}return{}}loadFromEnv(){if(process.env[at.EDGIO_ENV_VARIABLES.config])try{return JSON.parse(process.env[at.EDGIO_ENV_VARIABLES.config])}catch{throw new Error(`Edgio configuration variable: ${at.EDGIO_ENV_VARIABLES.config}, is not parsable as json`)}return{}}getDefaults(){var t;return{production:!0,backends:{},includeNodeModules:!1,routes:(t=["routes.js","routes.ts","routes.cjs"].find(r=>Lu.existsSync(vr.join(process.cwd(),r))))!==null&&t!==void 0?t:"routes.js"}}};yr.default=new Us});var Tn=p(Sn=>{"use strict";Object.defineProperty(Sn,"__esModule",{value:!0});function qg(e){return`${e.ignoreCase?"(?i)":""}${e.source}`.replace(/\\\//g,"/")}Sn.default=qg;function Dg(e){let t=e.indexOf("(?i)")===0;return t&&(e=e.slice(4)),new RegExp(e.replace(/\//g,"/"),t?"i":"")}Sn.fromEdgeRegex=Dg});var Fu=p(Ws=>{"use strict";Object.defineProperty(Ws,"__esModule",{value:!0});function Mg(e){return new RegExp(`^${e}$`,"i")}Ws.default=Mg});var Uu=p(br=>{"use strict";var Ig=br&&br.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(br,"__esModule",{value:!0});var $u=Ig(Tn());function Vg(e){let t;return e===null?t=null:typeof e=="string"?t=$u.default(new RegExp(`^${e}$`,"i")):t=$u.default(e),t}br.default=Vg});var Ks=p(Gs=>{"use strict";Object.defineProperty(Gs,"__esModule",{value:!0});Gs.default=(e,t)=>{let r=e;if(/(^|[^$]){/.test(e))throw new Error(`{variable} syntax in the path option is no longer supported, use :variable instead (${e})`);for(let n in t){let s=t[n];Array.isArray(s)&&(s=s.join("/")),r=r.replace(new RegExp(`:${n}(\\([^)]*\\))?[?*+]?`,"g"),s===void 0?"":s)}return r=r.replace(/:\w+(\*|\+|\?)?/,""),r=r.replace("\\?","?"),r=r.replace(/\/+/g,"/").replace(/^([^:]+:)\//gi,"$1//"),r}});var xn=p(he=>{"use strict";Object.defineProperty(he,"__esModule",{value:!0});he.pathToRegexp=he.tokensToRegexp=he.regexpToFunction=he.match=he.tokensToFunction=he.compile=he.parse=void 0;function Bg(e){for(var t=[],r=0;r<e.length;){var n=e[r];if(n==="*"||n==="+"||n==="?"){t.push({type:"MODIFIER",index:r,value:e[r++]});continue}if(n==="\\"){t.push({type:"ESCAPED_CHAR",index:r++,value:e[r++]});continue}if(n==="{"){t.push({type:"OPEN",index:r,value:e[r++]});continue}if(n==="}"){t.push({type:"CLOSE",index:r,value:e[r++]});continue}if(n===":"){for(var s="",i=r+1;i<e.length;){var o=e.charCodeAt(i);if(o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122||o===95){s+=e[i++];continue}break}if(!s)throw new TypeError("Missing parameter name at ".concat(r));t.push({type:"NAME",index:r,value:s}),r=i;continue}if(n==="("){var a=1,u="",i=r+1;if(e[i]==="?")throw new TypeError('Pattern cannot start with "?" at '.concat(i));for(;i<e.length;){if(e[i]==="\\"){u+=e[i++]+e[i++];continue}if(e[i]===")"){if(a--,a===0){i++;break}}else if(e[i]==="("&&(a++,e[i+1]!=="?"))throw new TypeError("Capturing groups are not allowed at ".concat(i));u+=e[i++]}if(a)throw new TypeError("Unbalanced pattern at ".concat(r));if(!u)throw new TypeError("Missing pattern at ".concat(r));t.push({type:"PATTERN",index:r,value:u}),r=i;continue}t.push({type:"CHAR",index:r,value:e[r++]})}return t.push({type:"END",index:r,value:""}),t}function zs(e,t){t===void 0&&(t={});for(var r=Bg(e),n=t.prefixes,s=n===void 0?"./":n,i="[^".concat(Mt(t.delimiter||"/#?"),"]+?"),o=[],a=0,u=0,l="",c=function(U){if(u<r.length&&r[u].type===U)return r[u++].value},d=function(U){var de=c(U);if(de!==void 0)return de;var Q=r[u],Re=Q.type,Ae=Q.index;throw new TypeError("Unexpected ".concat(Re," at ").concat(Ae,", expected ").concat(U))},h=function(){for(var U="",de;de=c("CHAR")||c("ESCAPED_CHAR");)U+=de;return U};u<r.length;){var g=c("CHAR"),v=c("NAME"),f=c("PATTERN");if(v||f){var w=g||"";s.indexOf(w)===-1&&(l+=w,w=""),l&&(o.push(l),l=""),o.push({name:v||a++,prefix:w,suffix:"",pattern:f||i,modifier:c("MODIFIER")||""});continue}var R=g||c("ESCAPED_CHAR");if(R){l+=R;continue}l&&(o.push(l),l="");var $=c("OPEN");if($){var w=h(),ee=c("NAME")||"",H=c("PATTERN")||"",ue=h();d("CLOSE"),o.push({name:ee||(H?a++:""),pattern:ee&&!H?i:H,prefix:w,suffix:ue,modifier:c("MODIFIER")||""});continue}d("END")}return o}he.parse=zs;function kg(e,t){return Wu(zs(e,t),t)}he.compile=kg;function Wu(e,t){t===void 0&&(t={});var r=Ys(t),n=t.encode,s=n===void 0?function(u){return u}:n,i=t.validate,o=i===void 0?!0:i,a=e.map(function(u){if(typeof u=="object")return new RegExp("^(?:".concat(u.pattern,")$"),r)});return function(u){for(var l="",c=0;c<e.length;c++){var d=e[c];if(typeof d=="string"){l+=d;continue}var h=u?u[d.name]:void 0,g=d.modifier==="?"||d.modifier==="*",v=d.modifier==="*"||d.modifier==="+";if(Array.isArray(h)){if(!v)throw new TypeError('Expected "'.concat(d.name,'" to not repeat, but got an array'));if(h.length===0){if(g)continue;throw new TypeError('Expected "'.concat(d.name,'" to not be empty'))}for(var f=0;f<h.length;f++){var w=s(h[f],d);if(o&&!a[c].test(w))throw new TypeError('Expected all "'.concat(d.name,'" to match "').concat(d.pattern,'", but got "').concat(w,'"'));l+=d.prefix+w+d.suffix}continue}if(typeof h=="string"||typeof h=="number"){var w=s(String(h),d);if(o&&!a[c].test(w))throw new TypeError('Expected "'.concat(d.name,'" to match "').concat(d.pattern,'", but got "').concat(w,'"'));l+=d.prefix+w+d.suffix;continue}if(!g){var R=v?"an array":"a string";throw new TypeError('Expected "'.concat(d.name,'" to be ').concat(R))}}return l}}he.tokensToFunction=Wu;function jg(e,t){var r=[],n=Js(e,r,t);return Gu(n,r,t)}he.match=jg;function Gu(e,t,r){r===void 0&&(r={});var n=r.decode,s=n===void 0?function(i){return i}:n;return function(i){var o=e.exec(i);if(!o)return!1;for(var a=o[0],u=o.index,l=Object.create(null),c=function(h){if(o[h]===void 0)return"continue";var g=t[h-1];g.modifier==="*"||g.modifier==="+"?l[g.name]=o[h].split(g.prefix+g.suffix).map(function(v){return s(v,g)}):l[g.name]=s(o[h],g)},d=1;d<o.length;d++)c(d);return{path:a,index:u,params:l}}}he.regexpToFunction=Gu;function Mt(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function Ys(e){return e&&e.sensitive?"":"i"}function Lg(e,t){if(!t)return e;for(var r=/\((?:\?<(.*?)>)?(?!\?)/g,n=0,s=r.exec(e.source);s;)t.push({name:s[1]||n++,prefix:"",suffix:"",modifier:"",pattern:""}),s=r.exec(e.source);return e}function Fg(e,t,r){var n=e.map(function(s){return Js(s,t,r).source});return new RegExp("(?:".concat(n.join("|"),")"),Ys(r))}function $g(e,t,r){return Ku(zs(e,r),t,r)}function Ku(e,t,r){r===void 0&&(r={});for(var n=r.strict,s=n===void 0?!1:n,i=r.start,o=i===void 0?!0:i,a=r.end,u=a===void 0?!0:a,l=r.encode,c=l===void 0?function(Ae){return Ae}:l,d=r.delimiter,h=d===void 0?"/#?":d,g=r.endsWith,v=g===void 0?"":g,f="[".concat(Mt(v),"]|$"),w="[".concat(Mt(h),"]"),R=o?"^":"",$=0,ee=e;$<ee.length;$++){var H=ee[$];if(typeof H=="string")R+=Mt(c(H));else{var ue=Mt(c(H.prefix)),U=Mt(c(H.suffix));if(H.pattern)if(t&&t.push(H),ue||U)if(H.modifier==="+"||H.modifier==="*"){var de=H.modifier==="*"?"?":"";R+="(?:".concat(ue,"((?:").concat(H.pattern,")(?:").concat(U).concat(ue,"(?:").concat(H.pattern,"))*)").concat(U,")").concat(de)}else R+="(?:".concat(ue,"(").concat(H.pattern,")").concat(U,")").concat(H.modifier);else H.modifier==="+"||H.modifier==="*"?R+="((?:".concat(H.pattern,")").concat(H.modifier,")"):R+="(".concat(H.pattern,")").concat(H.modifier);else R+="(?:".concat(ue).concat(U,")").concat(H.modifier)}}if(u)s||(R+="".concat(w,"?")),R+=r.endsWith?"(?=".concat(f,")"):"$";else{var Q=e[e.length-1],Re=typeof Q=="string"?w.indexOf(Q[Q.length-1])>-1:Q===void 0;s||(R+="(?:".concat(w,"(?=").concat(f,"))?")),Re||(R+="(?=".concat(w,"|").concat(f,")"))}return new RegExp(R,Ys(r))}he.tokensToRegexp=Ku;function Js(e,t,r){return e instanceof RegExp?Lg(e,t):Array.isArray(e)?Fg(e,t,r):$g(e,t,r)}he.pathToRegexp=Js});var Yu=p(It=>{"use strict";var Ug=It&&It.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(It,"__esModule",{value:!0});var Wg=Ug(Ks()),Gg=xn();function Kg(e,t){if(e==null)return t;let r=zu(e);return Wg.default(t,r)}It.default=Kg;function zu(e){if(!e)return{};let t=e.match(/https?:\/\/[^/]+(.*)/);t&&(e=`/${t[1]}`);let r=1,n={};return Gg.parse(e).forEach(s=>{typeof s!="string"&&(n[s.name]=`\\${r++}`)}),n}It.getBackReferences=zu});var Ju=p(Qs=>{"use strict";Object.defineProperty(Qs,"__esModule",{value:!0});function zg(e){return e?typeof e.length=="number"?!e.length:!(typeof e=="object"&&Object.keys(e).length):!0}Qs.default=zg});var Qu=p(Zs=>{"use strict";Object.defineProperty(Zs,"__esModule",{value:!0});var Xs=class extends Error{constructor(t){super(t.message),this.type="BackendFetchError",this.cause=t}};Zs.default=Xs});var ri=p(ti=>{"use strict";Object.defineProperty(ti,"__esModule",{value:!0});var ei="__";function Yg(e,t){let r=new URL(e,`https://${ei}`).searchParams,n=new URL(t,`https://${ei}`);return r.forEach((s,i)=>{n.searchParams.get(i)||n.searchParams.set(i,s)}),n.hostname===ei?`${n.pathname}${n.search}`:n.toString()}ti.default=Yg});var rl=p(Er=>{"use strict";var Pn=Er&&Er.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Er,"__esModule",{value:!0});var Jg=require("url"),Xu=Pn(require("https")),Qg=Pn(require("http")),Zu=require("path"),ni=Pn(Qu()),Xg=Pn(ri()),el=re(),Zg=["transfer-encoding","content-length"],On=class{constructor(t){this.config=t}static setImpl(t){tl=t}static create(t){return new tl(t)}async fetch(t,r,n){let{path:s,headers:i}=n||{},o=this.getProxyTarget(t,s),a=this.getProxyRequestOptions(o,t,i,n==null?void 0:n.removeEmptySearchParamValues);return new Promise((u,l)=>{let d=(o.protocol==="https:"?Xu.default:Qg.default).request(a,h=>{let g=[];h.on("data",v=>g.push(v)).on("end",()=>{h.complete&&(Object.entries(h.headers).filter(([v])=>!Zg.includes(v.toLowerCase())).forEach(([v,f])=>{try{r.setHeader(v,f)}catch(w){console.warn(`Could not relay upstream response header ${v} with value ${f}`,w)}}),r.statusCode=h.statusCode,r.statusMessage=h.statusMessage,r.body=Buffer.concat(g),process.env.DEBUG==="true"&&console.log("proxy",`[${r.statusCode} ${r.statusMessage}]`,o),u(void 0))}).on("error",v=>{l(new ni.default(v))}).on("close",()=>{h.complete||l(new ni.default(new Error("The connection was terminated while the message was still being sent")))})});d.on("error",h=>l(new ni.default(h))),d.end(t.rawBody)})}getProxyTarget(t,r){let n=r?Xg.default(t.url,r):t.url,{domainOrIp:s,basePath:i,port:o}=this.config;if(i&&(n=Zu.join(i,n)),s){let u=s.match(/^(127.0.0.1|localhost)(:\d+)?$/)?"http":"https",l=`${s}${o?`:${o}`:""}`;n=`${u}://${Zu.join(l,n)}`}let a=Jg.parse(n,!0);return t.getHeader(el.HTTP_HEADERS.x0Protocol)==="http"&&(a.protocol="http:"),a}isLocal(t){return t.hostname===el.JS_BACKEND_HOSTNAME}getProxyRequestOptions(t,r,n,s){let i=null;this.config.disableCheckCert&&t.protocol==="https:"&&(i=new Xu.default.Agent({rejectUnauthorized:!1}));let o={...r.headers,...n,host:this.config.hostHeader||r.headers.host};this.isLocal(t)&&(o["x-forwarded-proto"]=r.secure?"https":"http");let a=t.path;return s===!0&&a&&(a=a.replace(/=(?=&|$)/gm,"")),{...t,path:a,method:r.method,timeout:this.config.firstByteTimeout||0,agent:i,body:r.rawBody,headers:o}}};Er.default=On;var tl=On});var Nn=p(si=>{"use strict";si.parse=rm;si.serialize=nm;var em=decodeURIComponent,tm=encodeURIComponent,Hn=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function rm(e,t){if(typeof e!="string")throw new TypeError("argument str must be a string");for(var r={},n=t||{},s=e.split(";"),i=n.decode||em,o=0;o<s.length;o++){var a=s[o],u=a.indexOf("=");if(!(u<0)){var l=a.substring(0,u).trim();if(r[l]==null){var c=a.substring(u+1,a.length).trim();c[0]==='"'&&(c=c.slice(1,-1)),r[l]=sm(c,i)}}}return r}function nm(e,t,r){var n=r||{},s=n.encode||tm;if(typeof s!="function")throw new TypeError("option encode is invalid");if(!Hn.test(e))throw new TypeError("argument name is invalid");var i=s(t);if(i&&!Hn.test(i))throw new TypeError("argument val is invalid");var o=e+"="+i;if(n.maxAge!=null){var a=n.maxAge-0;if(isNaN(a)||!isFinite(a))throw new TypeError("option maxAge is invalid");o+="; Max-Age="+Math.floor(a)}if(n.domain){if(!Hn.test(n.domain))throw new TypeError("option domain is invalid");o+="; Domain="+n.domain}if(n.path){if(!Hn.test(n.path))throw new TypeError("option path is invalid");o+="; Path="+n.path}if(n.expires){if(typeof n.expires.toUTCString!="function")throw new TypeError("option expires is invalid");o+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(o+="; HttpOnly"),n.secure&&(o+="; Secure"),n.sameSite){var u=typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite;switch(u){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return o}function sm(e,t){try{return t(e)}catch{return e}}});var nl=p(ii=>{"use strict";Object.defineProperty(ii,"__esModule",{value:!0});function im(e){return e}ii.default=im});var oi=p(wr=>{"use strict";var sl=wr&&wr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(wr,"__esModule",{value:!0});var om=sl(Nn()),am=require("querystring"),um=sl(nl());function il(e,t,r){if(typeof r=="string")return lm(e,t,r);if(!Array.isArray(r))return r;let n=[];return r.forEach(s=>{n.push(il(e,t,s))}),n}wr.default=il;function lm(e,t,r){let n=r.replace(/\\\${/g,"--backslashdollar--").replace(/\${/g,"--separator--${").split("--separator--"),s={};e!=null&&e.headers.cookie&&(s=om.default.parse(e.headers.cookie,{decode:um.default}));let i={};if(e!=null&&e.url){let l=e.url.indexOf("?");if(l>=0){let c=e.url.substring(l+1);i=am.parse(c)}}let o=[],a=6,u=8;return n.forEach(l=>{if(e){l=l.replace(/\${method}/,e.method),l=l.replace(/\${path}/,e.path),l=l.replace(/\${url}/,e.url);let d=l.search(/\${query:/);if(d>=0){let g=l.substring(d+u),v=g.indexOf("}");if(v<=0)throw new Error(`Cannot interpolate substring "${l}" of value "${r}" (1)`);g=g.substring(0,v);let f=i[g]||"";Array.isArray(f)&&(f=f[0]),l=l.replace(/\${query:.*?}/,f)}let h=l.search(/\${req:/);if(h>=0){let g=l.substring(h+a),v=g.indexOf("}");if(v<=0)throw new Error(`Cannot interpolate substring "${l}" of value "${r}" (2)`);g=g.substring(0,v);let f="";if(g.indexOf("cookie:")===0){let w=g.split(":")[1];f=s[w]||""}else if(g.indexOf("param:")===0){let w=g.split(":")[1];e.params&&e.params[w]&&(f=String(e.params[w]))}else f=e.headers[g]||"";l=l.replace(/\${req:.*?}/,f)}}let c=l.search(/\${res:/);if(c>=0){if(!t)throw new Error(`Cannot interpolate response parameter "${l}" during receive phase`);let d=l.substring(c+a),h=d.indexOf("}");if(h<=0)throw new Error(`Cannot interpolate substring "${l}" of value "${r}" (3)`);d=d.substring(0,h),l=l.replace(/\${res:.*?}/,t.getHeader(d)||"")}if(l.search(/\${/)>=0)throw new Error(`Cannot interpolate substring "${l}" of "${r}" (4)`);o.push(l)}),o.join("").replace(/--backslashdollar--/g,"${")}});var al=p((tw,ai)=>{"use strict";var cm=Object.prototype.hasOwnProperty,ge="~";function Rr(){}Object.create&&(Rr.prototype=Object.create(null),new Rr().__proto__||(ge=!1));function dm(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function ol(e,t,r,n,s){if(typeof r!="function")throw new TypeError("The listener must be a function");var i=new dm(r,n||e,s),o=ge?ge+t:t;return e._events[o]?e._events[o].fn?e._events[o]=[e._events[o],i]:e._events[o].push(i):(e._events[o]=i,e._eventsCount++),e}function qn(e,t){--e._eventsCount===0?e._events=new Rr:delete e._events[t]}function fe(){this._events=new Rr,this._eventsCount=0}fe.prototype.eventNames=function(){var t=[],r,n;if(this._eventsCount===0)return t;for(n in r=this._events)cm.call(r,n)&&t.push(ge?n.slice(1):n);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(r)):t};fe.prototype.listeners=function(t){var r=ge?ge+t:t,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var s=0,i=n.length,o=new Array(i);s<i;s++)o[s]=n[s].fn;return o};fe.prototype.listenerCount=function(t){var r=ge?ge+t:t,n=this._events[r];return n?n.fn?1:n.length:0};fe.prototype.emit=function(t,r,n,s,i,o){var a=ge?ge+t:t;if(!this._events[a])return!1;var u=this._events[a],l=arguments.length,c,d;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),l){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,r),!0;case 3:return u.fn.call(u.context,r,n),!0;case 4:return u.fn.call(u.context,r,n,s),!0;case 5:return u.fn.call(u.context,r,n,s,i),!0;case 6:return u.fn.call(u.context,r,n,s,i,o),!0}for(d=1,c=new Array(l-1);d<l;d++)c[d-1]=arguments[d];u.fn.apply(u.context,c)}else{var h=u.length,g;for(d=0;d<h;d++)switch(u[d].once&&this.removeListener(t,u[d].fn,void 0,!0),l){case 1:u[d].fn.call(u[d].context);break;case 2:u[d].fn.call(u[d].context,r);break;case 3:u[d].fn.call(u[d].context,r,n);break;case 4:u[d].fn.call(u[d].context,r,n,s);break;default:if(!c)for(g=1,c=new Array(l-1);g<l;g++)c[g-1]=arguments[g];u[d].fn.apply(u[d].context,c)}}return!0};fe.prototype.on=function(t,r,n){return ol(this,t,r,n,!1)};fe.prototype.once=function(t,r,n){return ol(this,t,r,n,!0)};fe.prototype.removeListener=function(t,r,n,s){var i=ge?ge+t:t;if(!this._events[i])return this;if(!r)return qn(this,i),this;var o=this._events[i];if(o.fn)o.fn===r&&(!s||o.once)&&(!n||o.context===n)&&qn(this,i);else{for(var a=0,u=[],l=o.length;a<l;a++)(o[a].fn!==r||s&&!o[a].once||n&&o[a].context!==n)&&u.push(o[a]);u.length?this._events[i]=u.length===1?u[0]:u:qn(this,i)}return this};fe.prototype.removeAllListeners=function(t){var r;return t?(r=ge?ge+t:t,this._events[r]&&qn(this,r)):(this._events=new Rr,this._eventsCount=0),this};fe.prototype.off=fe.prototype.removeListener;fe.prototype.addListener=fe.prototype.on;fe.prefixed=ge;fe.EventEmitter=fe;typeof ai<"u"&&(ai.exports=fe)});var ll=p((rw,ul)=>{"use strict";ul.exports=function(t,r){if(r=r.split(":")[0],t=+t,!t)return!1;switch(r){case"http":case"ws":return t!==80;case"https":case"wss":return t!==443;case"ftp":return t!==21;case"gopher":return t!==70;case"file":return!1}return t!==0}});var Dn=p(dl=>{var Ve=dl,hm=require("url"),cl=require("util")._extend,fm=ll(),pm=/(^|,)\s*upgrade\s*($|,)/i,ui=/^https|wss/;Ve.isSSL=ui;Ve.setupOutgoing=function(e,t,r,n){e.port=t[n||"target"].port||(ui.test(t[n||"target"].protocol)?443:80),["host","hostname","socketPath","pfx","key","passphrase","cert","ca","ciphers","secureProtocol"].forEach(function(a){e[a]=t[n||"target"][a]}),e.method=t.method||r.method,e.headers=cl({},r.headers),t.headers&&cl(e.headers,t.headers),t.auth&&(e.auth=t.auth),t.ca&&(e.ca=t.ca),ui.test(t[n||"target"].protocol)&&(e.rejectUnauthorized=typeof t.secure>"u"?!0:t.secure),e.agent=t.agent||!1,e.localAddress=t.localAddress,e.agent||(e.headers=e.headers||{},(typeof e.headers.connection!="string"||!pm.test(e.headers.connection))&&(e.headers.connection="close"));var s=t[n||"target"],i=s&&t.prependPath!==!1&&s.path||"",o=t.toProxy?r.url:hm.parse(r.url).path||"";return o=t.ignorePath?"":o,e.path=Ve.urlJoin(i,o),t.changeOrigin&&(e.headers.host=fm(e.port,t[n||"target"].protocol)&&!gm(e.host)?e.host+":"+e.port:e.host),e};Ve.setupSocket=function(e){return e.setTimeout(0),e.setNoDelay(!0),e.setKeepAlive(!0,0),e};Ve.getPort=function(e){var t=e.headers.host?e.headers.host.match(/:(\d+)/):"";return t?t[1]:Ve.hasEncryptedConnection(e)?"443":"80"};Ve.hasEncryptedConnection=function(e){return Boolean(e.connection.encrypted||e.connection.pair)};Ve.urlJoin=function(){var e=Array.prototype.slice.call(arguments),t=e.length-1,r=e[t],n=r.split("?"),s;return e[t]=n.shift(),s=[e.filter(Boolean).join("/").replace(/\/+/g,"/").replace("http:/","http://").replace("https:/","https://")],s.push.apply(s,n),s.join("?")};Ve.rewriteCookieProperty=function e(t,r,n){return Array.isArray(t)?t.map(function(s){return e(s,r,n)}):t.replace(new RegExp("(;\\s*"+n+"=)([^;]+)","i"),function(s,i,o){var a;if(o in r)a=r[o];else if("*"in r)a=r["*"];else return s;return a?i+a:""})};function gm(e){return!!~e.indexOf(":")}});var gl=p((sw,pl)=>{var hl=require("url"),fl=Dn(),mm=/^201|30(1|2|7|8)$/;pl.exports={removeChunked:function(t,r,n){t.httpVersion==="1.0"&&delete n.headers["transfer-encoding"]},setConnection:function(t,r,n){t.httpVersion==="1.0"?n.headers.connection=t.headers.connection||"close":t.httpVersion!=="2.0"&&!n.headers.connection&&(n.headers.connection=t.headers.connection||"keep-alive")},setRedirectHostRewrite:function(t,r,n,s){if((s.hostRewrite||s.autoRewrite||s.protocolRewrite)&&n.headers.location&&mm.test(n.statusCode)){var i=hl.parse(s.target),o=hl.parse(n.headers.location);if(i.host!=o.host)return;s.hostRewrite?o.host=s.hostRewrite:s.autoRewrite&&(o.host=t.headers.host),s.protocolRewrite&&(o.protocol=s.protocolRewrite),n.headers.location=o.format()}},writeHeaders:function(t,r,n,s){var i=s.cookieDomainRewrite,o=s.cookiePathRewrite,a=s.preserveHeaderKeyCase,u,l=function(h,g){g!=null&&(i&&h.toLowerCase()==="set-cookie"&&(g=fl.rewriteCookieProperty(g,i,"domain")),o&&h.toLowerCase()==="set-cookie"&&(g=fl.rewriteCookieProperty(g,o,"path")),r.setHeader(String(h).trim(),g))};if(typeof i=="string"&&(i={"*":i}),typeof o=="string"&&(o={"*":o}),a&&n.rawHeaders!=null){u={};for(var c=0;c<n.rawHeaders.length;c+=2){var d=n.rawHeaders[c];u[d.toLowerCase()]=d}}Object.keys(n.headers).forEach(function(h){var g=n.headers[h];a&&u&&(h=u[h]||h),l(h,g)})},writeStatusCode:function(t,r,n){n.statusMessage?(r.statusCode=n.statusCode,r.statusMessage=n.statusMessage):r.statusCode=n.statusCode}}});var vl=p((iw,ml)=>{var Vt=1e3,Bt=Vt*60,kt=Bt*60,lt=kt*24,vm=lt*7,ym=lt*365.25;ml.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0)return _m(e);if(r==="number"&&isFinite(e))return t.long?Em(e):bm(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function _m(e){if(e=String(e),!(e.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!!t){var r=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*ym;case"weeks":case"week":case"w":return r*vm;case"days":case"day":case"d":return r*lt;case"hours":case"hour":case"hrs":case"hr":case"h":return r*kt;case"minutes":case"minute":case"mins":case"min":case"m":return r*Bt;case"seconds":case"second":case"secs":case"sec":case"s":return r*Vt;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function bm(e){var t=Math.abs(e);return t>=lt?Math.round(e/lt)+"d":t>=kt?Math.round(e/kt)+"h":t>=Bt?Math.round(e/Bt)+"m":t>=Vt?Math.round(e/Vt)+"s":e+"ms"}function Em(e){var t=Math.abs(e);return t>=lt?Mn(e,t,lt,"day"):t>=kt?Mn(e,t,kt,"hour"):t>=Bt?Mn(e,t,Bt,"minute"):t>=Vt?Mn(e,t,Vt,"second"):e+" ms"}function Mn(e,t,r,n){var s=t>=r*1.5;return Math.round(e/r)+" "+n+(s?"s":"")}});var li=p((ow,yl)=>{function wm(e){r.debug=r,r.default=r,r.coerce=u,r.disable=i,r.enable=s,r.enabled=o,r.humanize=vl(),r.destroy=l,Object.keys(e).forEach(c=>{r[c]=e[c]}),r.names=[],r.skips=[],r.formatters={};function t(c){let d=0;for(let h=0;h<c.length;h++)d=(d<<5)-d+c.charCodeAt(h),d|=0;return r.colors[Math.abs(d)%r.colors.length]}r.selectColor=t;function r(c){let d,h=null,g,v;function f(...w){if(!f.enabled)return;let R=f,$=Number(new Date),ee=$-(d||$);R.diff=ee,R.prev=d,R.curr=$,d=$,w[0]=r.coerce(w[0]),typeof w[0]!="string"&&w.unshift("%O");let H=0;w[0]=w[0].replace(/%([a-zA-Z%])/g,(U,de)=>{if(U==="%%")return"%";H++;let Q=r.formatters[de];if(typeof Q=="function"){let Re=w[H];U=Q.call(R,Re),w.splice(H,1),H--}return U}),r.formatArgs.call(R,w),(R.log||r.log).apply(R,w)}return f.namespace=c,f.useColors=r.useColors(),f.color=r.selectColor(c),f.extend=n,f.destroy=r.destroy,Object.defineProperty(f,"enabled",{enumerable:!0,configurable:!1,get:()=>h!==null?h:(g!==r.namespaces&&(g=r.namespaces,v=r.enabled(c)),v),set:w=>{h=w}}),typeof r.init=="function"&&r.init(f),f}function n(c,d){let h=r(this.namespace+(typeof d>"u"?":":d)+c);return h.log=this.log,h}function s(c){r.save(c),r.namespaces=c,r.names=[],r.skips=[];let d,h=(typeof c=="string"?c:"").split(/[\s,]+/),g=h.length;for(d=0;d<g;d++)!h[d]||(c=h[d].replace(/\*/g,".*?"),c[0]==="-"?r.skips.push(new RegExp("^"+c.slice(1)+"$")):r.names.push(new RegExp("^"+c+"$")))}function i(){let c=[...r.names.map(a),...r.skips.map(a).map(d=>"-"+d)].join(",");return r.enable(""),c}function o(c){if(c[c.length-1]==="*")return!0;let d,h;for(d=0,h=r.skips.length;d<h;d++)if(r.skips[d].test(c))return!1;for(d=0,h=r.names.length;d<h;d++)if(r.names[d].test(c))return!0;return!1}function a(c){return c.toString().substring(2,c.toString().length-2).replace(/\.\*\?$/,"*")}function u(c){return c instanceof Error?c.stack||c.message:c}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}yl.exports=wm});var _l=p((Ee,In)=>{Ee.formatArgs=Am;Ee.save=Cm;Ee.load=Sm;Ee.useColors=Rm;Ee.storage=Tm();Ee.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();Ee.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Rm(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Am(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+In.exports.humanize(this.diff),!this.useColors)return;let t="color: "+this.color;e.splice(1,0,t,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,s=>{s!=="%%"&&(r++,s==="%c"&&(n=r))}),e.splice(n,0,t)}Ee.log=console.debug||console.log||(()=>{});function Cm(e){try{e?Ee.storage.setItem("debug",e):Ee.storage.removeItem("debug")}catch{}}function Sm(){let e;try{e=Ee.storage.getItem("debug")}catch{}return!e&&typeof process<"u"&&"env"in process&&(e=process.env.DEBUG),e}function Tm(){try{return localStorage}catch{}}In.exports=li()(Ee);var{formatters:xm}=In.exports;xm.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var El=p((aw,bl)=>{"use strict";bl.exports=(e,t=process.argv)=>{let r=e.startsWith("-")?"":e.length===1?"-":"--",n=t.indexOf(r+e),s=t.indexOf("--");return n!==-1&&(s===-1||n<s)}});var hi=p((uw,Rl)=>{"use strict";var Om=require("os"),wl=require("tty"),Ce=El(),{env:ie}=process,ze;Ce("no-color")||Ce("no-colors")||Ce("color=false")||Ce("color=never")?ze=0:(Ce("color")||Ce("colors")||Ce("color=true")||Ce("color=always"))&&(ze=1);"FORCE_COLOR"in ie&&(ie.FORCE_COLOR==="true"?ze=1:ie.FORCE_COLOR==="false"?ze=0:ze=ie.FORCE_COLOR.length===0?1:Math.min(parseInt(ie.FORCE_COLOR,10),3));function ci(e){return e===0?!1:{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function di(e,t){if(ze===0)return 0;if(Ce("color=16m")||Ce("color=full")||Ce("color=truecolor"))return 3;if(Ce("color=256"))return 2;if(e&&!t&&ze===void 0)return 0;let r=ze||0;if(ie.TERM==="dumb")return r;if(process.platform==="win32"){let n=Om.release().split(".");return Number(n[0])>=10&&Number(n[2])>=10586?Number(n[2])>=14931?3:2:1}if("CI"in ie)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(n=>n in ie)||ie.CI_NAME==="codeship"?1:r;if("TEAMCITY_VERSION"in ie)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(ie.TEAMCITY_VERSION)?1:0;if(ie.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in ie){let n=parseInt((ie.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(ie.TERM_PROGRAM){case"iTerm.app":return n>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(ie.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(ie.TERM)||"COLORTERM"in ie?1:r}function Pm(e){let t=di(e,e&&e.isTTY);return ci(t)}Rl.exports={supportsColor:Pm,stdout:ci(di(!0,wl.isatty(1))),stderr:ci(di(!0,wl.isatty(2)))}});var Cl=p((ce,Bn)=>{var Hm=require("tty"),Vn=require("util");ce.init=Bm;ce.log=Mm;ce.formatArgs=qm;ce.save=Im;ce.load=Vm;ce.useColors=Nm;ce.destroy=Vn.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");ce.colors=[6,2,3,4,5,1];try{let e=hi();e&&(e.stderr||e).level>=2&&(ce.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}ce.inspectOpts=Object.keys(process.env).filter(e=>/^debug_/i.test(e)).reduce((e,t)=>{let r=t.substring(6).toLowerCase().replace(/_([a-z])/g,(s,i)=>i.toUpperCase()),n=process.env[t];return/^(yes|on|true|enabled)$/i.test(n)?n=!0:/^(no|off|false|disabled)$/i.test(n)?n=!1:n==="null"?n=null:n=Number(n),e[r]=n,e},{});function Nm(){return"colors"in ce.inspectOpts?Boolean(ce.inspectOpts.colors):Hm.isatty(process.stderr.fd)}function qm(e){let{namespace:t,useColors:r}=this;if(r){let n=this.color,s="\x1B[3"+(n<8?n:"8;5;"+n),i=`  ${s};1m${t} \x1B[0m`;e[0]=i+e[0].split(`
`).join(`
`+i),e.push(s+"m+"+Bn.exports.humanize(this.diff)+"\x1B[0m")}else e[0]=Dm()+t+" "+e[0]}function Dm(){return ce.inspectOpts.hideDate?"":new Date().toISOString()+" "}function Mm(...e){return process.stderr.write(Vn.format(...e)+`
`)}function Im(e){e?process.env.DEBUG=e:delete process.env.DEBUG}function Vm(){return process.env.DEBUG}function Bm(e){e.inspectOpts={};let t=Object.keys(ce.inspectOpts);for(let r=0;r<t.length;r++)e.inspectOpts[t[r]]=ce.inspectOpts[t[r]]}Bn.exports=li()(ce);var{formatters:Al}=Bn.exports;Al.o=function(e){return this.inspectOpts.colors=this.useColors,Vn.inspect(e,this.inspectOpts).split(`
`).map(t=>t.trim()).join(" ")};Al.O=function(e){return this.inspectOpts.colors=this.useColors,Vn.inspect(e,this.inspectOpts)}});var Sl=p((lw,fi)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?fi.exports=_l():fi.exports=Cl()});var xl=p((cw,Tl)=>{var Ar;Tl.exports=function(){if(!Ar){try{Ar=Sl()("follow-redirects")}catch{}typeof Ar!="function"&&(Ar=function(){})}Ar.apply(null,arguments)}});var Il=p((dw,yi)=>{var ct=require("url"),pi=ct.URL,km=require("http"),jm=require("https"),Hl=require("stream").Writable,Nl=require("assert"),ql=xl(),mi=["abort","aborted","connect","error","socket","timeout"],vi=Object.create(null);mi.forEach(function(e){vi[e]=function(t,r,n){this._redirectable.emit(e,t,r,n)}});var Lm=Sr("ERR_INVALID_URL","Invalid URL",TypeError),Ol=Sr("ERR_FR_REDIRECTION_FAILURE","Redirected request failed"),Fm=Sr("ERR_FR_TOO_MANY_REDIRECTS","Maximum number of redirects exceeded"),$m=Sr("ERR_FR_MAX_BODY_LENGTH_EXCEEDED","Request body larger than maxBodyLength limit"),Um=Sr("ERR_STREAM_WRITE_AFTER_END","write after end");function we(e,t){Hl.call(this),this._sanitizeOptions(e),this._options=e,this._ended=!1,this._ending=!1,this._redirectCount=0,this._redirects=[],this._requestBodyLength=0,this._requestBodyBuffers=[],t&&this.on("response",t);var r=this;this._onNativeResponse=function(n){r._processResponse(n)},this._performRequest()}we.prototype=Object.create(Hl.prototype);we.prototype.abort=function(){Ml(this._currentRequest),this.emit("abort")};we.prototype.write=function(e,t,r){if(this._ending)throw new Um;if(!dt(e)&&!Km(e))throw new TypeError("data should be a string, Buffer or Uint8Array");if(Cr(t)&&(r=t,t=null),e.length===0){r&&r();return}this._requestBodyLength+e.length<=this._options.maxBodyLength?(this._requestBodyLength+=e.length,this._requestBodyBuffers.push({data:e,encoding:t}),this._currentRequest.write(e,t,r)):(this.emit("error",new $m),this.abort())};we.prototype.end=function(e,t,r){if(Cr(e)?(r=e,e=t=null):Cr(t)&&(r=t,t=null),!e)this._ended=this._ending=!0,this._currentRequest.end(null,null,r);else{var n=this,s=this._currentRequest;this.write(e,t,function(){n._ended=!0,s.end(null,null,r)}),this._ending=!0}};we.prototype.setHeader=function(e,t){this._options.headers[e]=t,this._currentRequest.setHeader(e,t)};we.prototype.removeHeader=function(e){delete this._options.headers[e],this._currentRequest.removeHeader(e)};we.prototype.setTimeout=function(e,t){var r=this;function n(o){o.setTimeout(e),o.removeListener("timeout",o.destroy),o.addListener("timeout",o.destroy)}function s(o){r._timeout&&clearTimeout(r._timeout),r._timeout=setTimeout(function(){r.emit("timeout"),i()},e),n(o)}function i(){r._timeout&&(clearTimeout(r._timeout),r._timeout=null),r.removeListener("abort",i),r.removeListener("error",i),r.removeListener("response",i),t&&r.removeListener("timeout",t),r.socket||r._currentRequest.removeListener("socket",s)}return t&&this.on("timeout",t),this.socket?s(this.socket):this._currentRequest.once("socket",s),this.on("socket",n),this.on("abort",i),this.on("error",i),this.on("response",i),this};["flushHeaders","getHeader","setNoDelay","setSocketKeepAlive"].forEach(function(e){we.prototype[e]=function(t,r){return this._currentRequest[e](t,r)}});["aborted","connection","socket"].forEach(function(e){Object.defineProperty(we.prototype,e,{get:function(){return this._currentRequest[e]}})});we.prototype._sanitizeOptions=function(e){if(e.headers||(e.headers={}),e.host&&(e.hostname||(e.hostname=e.host),delete e.host),!e.pathname&&e.path){var t=e.path.indexOf("?");t<0?e.pathname=e.path:(e.pathname=e.path.substring(0,t),e.search=e.path.substring(t))}};we.prototype._performRequest=function(){var e=this._options.protocol,t=this._options.nativeProtocols[e];if(!t){this.emit("error",new TypeError("Unsupported protocol "+e));return}if(this._options.agents){var r=e.slice(0,-1);this._options.agent=this._options.agents[r]}var n=this._currentRequest=t.request(this._options,this._onNativeResponse);n._redirectable=this;for(var s of mi)n.on(s,vi[s]);if(this._currentUrl=/^\//.test(this._options.path)?ct.format(this._options):this._options.path,this._isRedirect){var i=0,o=this,a=this._requestBodyBuffers;(function u(l){if(n===o._currentRequest)if(l)o.emit("error",l);else if(i<a.length){var c=a[i++];n.finished||n.write(c.data,c.encoding,u)}else o._ended&&n.end()})()}};we.prototype._processResponse=function(e){var t=e.statusCode;this._options.trackRedirects&&this._redirects.push({url:this._currentUrl,headers:e.headers,statusCode:t});var r=e.headers.location;if(!r||this._options.followRedirects===!1||t<300||t>=400){e.responseUrl=this._currentUrl,e.redirects=this._redirects,this.emit("response",e),this._requestBodyBuffers=[];return}if(Ml(this._currentRequest),e.destroy(),++this._redirectCount>this._options.maxRedirects){this.emit("error",new Fm);return}var n,s=this._options.beforeRedirect;s&&(n=Object.assign({Host:e.req.getHeader("host")},this._options.headers));var i=this._options.method;((t===301||t===302)&&this._options.method==="POST"||t===303&&!/^(?:GET|HEAD)$/.test(this._options.method))&&(this._options.method="GET",this._requestBodyBuffers=[],gi(/^content-/i,this._options.headers));var o=gi(/^host$/i,this._options.headers),a=ct.parse(this._currentUrl),u=o||a.host,l=/^\w+:/.test(r)?this._currentUrl:ct.format(Object.assign(a,{host:u})),c;try{c=ct.resolve(l,r)}catch(v){this.emit("error",new Ol({cause:v}));return}ql("redirecting to",c),this._isRedirect=!0;var d=ct.parse(c);if(Object.assign(this._options,d),(d.protocol!==a.protocol&&d.protocol!=="https:"||d.host!==u&&!Gm(d.host,u))&&gi(/^(?:authorization|cookie)$/i,this._options.headers),Cr(s)){var h={headers:e.headers,statusCode:t},g={url:l,method:i,headers:n};try{s(this._options,h,g)}catch(v){this.emit("error",v);return}this._sanitizeOptions(this._options)}try{this._performRequest()}catch(v){this.emit("error",new Ol({cause:v}))}};function Dl(e){var t={maxRedirects:21,maxBodyLength:10485760},r={};return Object.keys(e).forEach(function(n){var s=n+":",i=r[s]=e[n],o=t[n]=Object.create(i);function a(l,c,d){if(dt(l)){var h;try{h=Pl(new pi(l))}catch{h=ct.parse(l)}if(!dt(h.protocol))throw new Lm({input:l});l=h}else pi&&l instanceof pi?l=Pl(l):(d=c,c=l,l={protocol:s});return Cr(c)&&(d=c,c=null),c=Object.assign({maxRedirects:t.maxRedirects,maxBodyLength:t.maxBodyLength},l,c),c.nativeProtocols=r,!dt(c.host)&&!dt(c.hostname)&&(c.hostname="::1"),Nl.equal(c.protocol,s,"protocol mismatch"),ql("options",c),new we(c,d)}function u(l,c,d){var h=o.request(l,c,d);return h.end(),h}Object.defineProperties(o,{request:{value:a,configurable:!0,enumerable:!0,writable:!0},get:{value:u,configurable:!0,enumerable:!0,writable:!0}})}),t}function Wm(){}function Pl(e){var t={protocol:e.protocol,hostname:e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,hash:e.hash,search:e.search,pathname:e.pathname,path:e.pathname+e.search,href:e.href};return e.port!==""&&(t.port=Number(e.port)),t}function gi(e,t){var r;for(var n in t)e.test(n)&&(r=t[n],delete t[n]);return r===null||typeof r>"u"?void 0:String(r).trim()}function Sr(e,t,r){function n(s){Error.captureStackTrace(this,this.constructor),Object.assign(this,s||{}),this.code=e,this.message=this.cause?t+": "+this.cause.message:t}return n.prototype=new(r||Error),n.prototype.constructor=n,n.prototype.name="Error ["+e+"]",n}function Ml(e){for(var t of mi)e.removeListener(t,vi[t]);e.on("error",Wm),e.abort()}function Gm(e,t){Nl(dt(e)&&dt(t));var r=e.length-t.length-1;return r>0&&e[r]==="."&&e.endsWith(t)}function dt(e){return typeof e=="string"||e instanceof String}function Cr(e){return typeof e=="function"}function Km(e){return typeof e=="object"&&"length"in e}yi.exports=Dl({http:km,https:jm});yi.exports.wrap=Dl});var Bl=p((hw,Vl)=>{var zm=require("http"),Ym=require("https"),Tr=gl(),kn=Dn(),Jm=Il();Tr=Object.keys(Tr).map(function(e){return Tr[e]});var Qm={http:zm,https:Ym};Vl.exports={deleteLength:function(t,r,n){(t.method==="DELETE"||t.method==="OPTIONS")&&!t.headers["content-length"]&&(t.headers["content-length"]="0",delete t.headers["transfer-encoding"])},timeout:function(t,r,n){n.timeout&&t.socket.setTimeout(n.timeout)},XHeaders:function(t,r,n){if(!!n.xfwd){var s=t.isSpdy||kn.hasEncryptedConnection(t),i={for:t.connection.remoteAddress||t.socket.remoteAddress,port:kn.getPort(t),proto:s?"https":"http"};["for","port","proto"].forEach(function(o){t.headers["x-forwarded-"+o]=(t.headers["x-forwarded-"+o]||"")+(t.headers["x-forwarded-"+o]?",":"")+i[o]}),t.headers["x-forwarded-host"]=t.headers["x-forwarded-host"]||t.headers.host||""}},stream:function(t,r,n,s,i,o){i.emit("start",t,r,n.target||n.forward);var a=n.followRedirects?Jm:Qm,u=a.http,l=a.https;if(n.forward){var c=(n.forward.protocol==="https:"?l:u).request(kn.setupOutgoing(n.ssl||{},n,t,"forward")),d=v(c,n.forward);if(t.on("error",d),c.on("error",d),(n.buffer||t).pipe(c),!n.target)return r.end()}var h=(n.target.protocol==="https:"?l:u).request(kn.setupOutgoing(n.ssl||{},n,t));h.on("socket",function(f){i&&!h.getHeader("expect")&&i.emit("proxyReq",h,t,r,n)}),n.proxyTimeout&&h.setTimeout(n.proxyTimeout,function(){h.abort()}),t.on("aborted",function(){h.abort()});var g=v(h,n.target);t.on("error",g),h.on("error",g);function v(f,w){return function($){if(t.socket.destroyed&&$.code==="ECONNRESET")return i.emit("econnreset",$,t,r,w),f.abort();o?o($,t,r,w):i.emit("error",$,t,r,w)}}(n.buffer||t).pipe(h),h.on("response",function(f){if(i&&i.emit("proxyRes",f,t,r),!r.headersSent&&!n.selfHandleResponse)for(var w=0;w<Tr.length&&!Tr[w](t,r,f,n);w++);r.finished?i&&i.emit("end",t,r,f):(f.on("end",function(){i&&i.emit("end",t,r,f)}),n.selfHandleResponse||f.pipe(r))})}}});var jl=p((fw,kl)=>{var Xm=require("http"),Zm=require("https"),jt=Dn();kl.exports={checkMethodAndHeader:function(t,r){if(t.method!=="GET"||!t.headers.upgrade||t.headers.upgrade.toLowerCase()!=="websocket")return r.destroy(),!0},XHeaders:function(t,r,n){if(!!n.xfwd){var s={for:t.connection.remoteAddress||t.socket.remoteAddress,port:jt.getPort(t),proto:jt.hasEncryptedConnection(t)?"wss":"ws"};["for","port","proto"].forEach(function(i){t.headers["x-forwarded-"+i]=(t.headers["x-forwarded-"+i]||"")+(t.headers["x-forwarded-"+i]?",":"")+s[i]})}},stream:function(t,r,n,s,i,o){var a=function(c,d){return Object.keys(d).reduce(function(h,g){var v=d[g];if(!Array.isArray(v))return h.push(g+": "+v),h;for(var f=0;f<v.length;f++)h.push(g+": "+v[f]);return h},[c]).join(`\r
`)+`\r
\r
`};jt.setupSocket(r),s&&s.length&&r.unshift(s);var u=(jt.isSSL.test(n.target.protocol)?Zm:Xm).request(jt.setupOutgoing(n.ssl||{},n,t));return i&&i.emit("proxyReqWs",u,t,r,n,s),u.on("error",l),u.on("response",function(c){c.upgrade||(r.write(a("HTTP/"+c.httpVersion+" "+c.statusCode+" "+c.statusMessage,c.headers)),c.pipe(r))}),u.on("upgrade",function(c,d,h){d.on("error",l),d.on("end",function(){i.emit("close",c,d,h)}),r.on("error",function(){d.end()}),jt.setupSocket(d),h&&h.length&&d.unshift(h),r.write(a("HTTP/1.1 101 Switching Protocols",c.headers)),d.pipe(r).pipe(d),i.emit("open",d),i.emit("proxySocket",d)}),u.end();function l(c){o?o(c,t,r):i.emit("error",c,t,r),r.end()}}}});var Kl=p((pw,Gl)=>{var Ul=Gl.exports,Ll=require("util")._extend,ev=require("url").parse,Wl=al(),tv=require("http"),rv=require("https"),Fl=Bl(),$l=jl();Ul.Server=ht;function _i(e){return function(t){return function(r,n){var s=e==="ws"?this.wsPasses:this.webPasses,i=[].slice.call(arguments),o=i.length-1,a,u;typeof i[o]=="function"&&(u=i[o],o--);var l=t;if(!(i[o]instanceof Buffer)&&i[o]!==n&&(l=Ll({},t),Ll(l,i[o]),o--),i[o]instanceof Buffer&&(a=i[o]),["target","forward"].forEach(function(d){typeof l[d]=="string"&&(l[d]=ev(l[d]))}),!l.target&&!l.forward)return this.emit("error",new Error("Must provide a proper URL as target"));for(var c=0;c<s.length&&!s[c](r,n,l,a,this,u);c++);}}}Ul.createRightProxy=_i;function ht(e){Wl.call(this),e=e||{},e.prependPath=e.prependPath!==!1,this.web=this.proxyRequest=_i("web")(e),this.ws=this.proxyWebsocketRequest=_i("ws")(e),this.options=e,this.webPasses=Object.keys(Fl).map(function(t){return Fl[t]}),this.wsPasses=Object.keys($l).map(function(t){return $l[t]}),this.on("error",this.onError,this)}require("util").inherits(ht,Wl);ht.prototype.onError=function(e){if(this.listeners("error").length===1)throw e};ht.prototype.listen=function(e,t){var r=this,n=function(s,i){r.web(s,i)};return this._server=this.options.ssl?rv.createServer(this.options.ssl,n):tv.createServer(n),this.options.ws&&this._server.on("upgrade",function(s,i,o){r.ws(s,i,o)}),this._server.listen(e,t),this};ht.prototype.close=function(e){var t=this;this._server&&this._server.close(r);function r(){t._server=null,e&&e.apply(null,arguments)}};ht.prototype.before=function(e,t,r){if(e!=="ws"&&e!=="web")throw new Error("type must be `web` or `ws`");var n=e==="ws"?this.wsPasses:this.webPasses,s=!1;if(n.forEach(function(i,o){i.name===t&&(s=o)}),s===!1)throw new Error("No such pass");n.splice(s,0,r)};ht.prototype.after=function(e,t,r){if(e!=="ws"&&e!=="web")throw new Error("type must be `web` or `ws`");var n=e==="ws"?this.wsPasses:this.webPasses,s=!1;if(n.forEach(function(i,o){i.name===t&&(s=o)}),s===!1)throw new Error("No such pass");n.splice(s++,0,r)}});var Yl=p((gw,zl)=>{var xr=Kl().Server;function bi(e){return new xr(e)}xr.createProxyServer=bi;xr.createServer=bi;xr.createProxy=bi;zl.exports=xr});var Ql=p((mw,Jl)=>{Jl.exports=Yl()});var Xl=p(Or=>{"use strict";var nv=Or&&Or.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Or,"__esModule",{value:!0});var sv=nv(Ql()),iv=sv.default.createProxyServer({changeOrigin:!0});function ov(e,t,r,n){let i={target:{protocol:r.domainOrIp==="127.0.0.1"?"http":"https",host:r.domainOrIp,port:r.port}};iv.web(e,t,i,n||Function.prototype)}Or.default=ov});var Ei=p(me=>{"use strict";Object.defineProperty(me,"__esModule",{value:!0});me.EDGIO_PROHIBITED_HEADER_NAMES=[/^\s*x-0-platform\s*/i,/^\s*x-0-version\s*$/i,/^\s*x-0-t\s*$/i,/^\s*x-0-components\s*$/i,/^\s*x-0-status\s*$/i,/^\s*x-0-lambda-name\s*$/i,/^\s*x-0-lambda-schedule-timeout\s*$/i,/^\s*x-0-received-at\s*$/i,/^\s*host\s*$/i,/^\s*x-request-id\s*$/i,/^\s*content-length\s*$/i,/^\s*via\s*$/i];me.EDGIO_PROHIBITED_COOKIE_NAMES=[/^edgio_/i];me.EDGIO_WHITELISTED_COOKIE_NAMES=[/^edgio_devtools/i];var Lt=e=>{if(me.EDGIO_PROHIBITED_HEADER_NAMES.find(t=>e.match(t)))throw new Error(`Header "${e}" is reserved and cannot be modified`)},av=e=>{if(me.EDGIO_PROHIBITED_COOKIE_NAMES.find(t=>e.match(t))&&!me.EDGIO_WHITELISTED_COOKIE_NAMES.find(t=>e.match(t)))throw new Error(`Cookie "${e}" is reserved and cannot be modified`)};me.validateSetResponseHeader=e=>{Lt(e)};me.validateUpdateResponseHeader=e=>{Lt(e)};me.validateRemoveResponseHeader=e=>{Lt(e)};me.validateSetRequestHeader=e=>{Lt(e)};me.validateUpdateRequestHeader=e=>{Lt(e)};me.validateRemoveRequestHeader=e=>{Lt(e)};me.validateCookieName=e=>{av(e)}});var Ri=p(wi=>{"use strict";Object.defineProperty(wi,"__esModule",{value:!0});function uv(e){return e==null?{}:typeof e=="string"?{path:e}:e}wi.default=uv});var Ai=p(jn=>{"use strict";Object.defineProperty(jn,"__esModule",{value:!0});var lv=xn(),Pr=class extends Error{constructor(t){super(`Route pattern "${t}" contains invalid syntax. See https://docs.edg.io/guides/routing#section_route_pattern_syntax`),this.isUserError=!0}};jn.PathMatcherError=Pr;var Ft=class{constructor(t){this.pattern=t}match(t){if(!this.matcher)try{this.matcher=lv.match(this.pattern,{decode:decodeURIComponent})}catch{throw new Pr(this.pattern)}Ft.validatePattern(this.pattern);let r=this.matcher(t);return r?r.params:void 0}static validatePattern(t){let r=t.match(this.PARTIAL_SPLAT_ROUTE);if(r){let[n,s,i]=r,o=t.replace(`${s}${i}`,`${s}:suffix/${i}`);throw new Pr(`Partial splat routes are not supported. Use "${o}" instead of "${t}"`)}return!0}};jn.default=Ft;Ft.PARTIAL_SPLAT_ROUTE=/(\/[^:/]+)(:[^*/#?]+\*)/});var Zl=p(Ci=>{"use strict";Object.defineProperty(Ci,"__esModule",{value:!0});function cv(e){return typeof e!="string"?"":e.toLowerCase()}Ci.default=cv});var $n=p(pt=>{"use strict";var Fn=pt&&pt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},dv=pt&&pt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(pt,"__esModule",{value:!0});var hv=re(),Ln=cr(),fv=Nn(),pv=xn(),gv=Fn(Ri()),ec=dv(Ai()),mv=Fn(require("querystring")),vv=Fn(Tn()),yv=Fn(Zl()),ft=class{constructor(t,r,n){this.criteria=gv.default(t),this.handler=r,this.options=n,this.criteria.path&&(this.matcher=new ec.default(this.criteria.path))}match(t){let r=[this.matchPath,this.matchProtocol,this.matchMethod,this.matchHeaders,this.matchQueryParams,this.matchCookies],n={};for(let s of r){let i=s.bind(this)(t);if(!i)return!1;Object.assign(n,i)}return t.params=n,n}matchResponse(t){return this.matchResponseStatus(t)}matchResponseStatus(t){var r,n,s;return!((n=(r=this.criteria)===null||r===void 0?void 0:r.response)===null||n===void 0)&&n.statusCode?!!(!((s=t.statusCode)===null||s===void 0)&&s.toString().match(this.criteria.response.statusCode)):!1}matchPath(t){return this.matcher?this.matcher.match(t.path):{}}matchMethod(t){return!this.criteria.method||!t.method?!0:new RegExp(this.criteria.method,"i").test(t.method)}matchHeaders(t){return this.criteria.headers?Ln.matchCriteriaRegexObjectWithRequestObject(this.criteria.headers,t.headers,yv.default):!0}matchQueryParams(t){return this.criteria.query?t.query?Ln.matchCriteriaRegexObjectWithRequestObject(this.criteria.query,t.query):!1:!0}matchCookies(t){if(this.criteria.cookies){let r=t.headers.cookie;if(r==null)return Object.values(this.criteria.cookies).every(i=>i===null);let n=Array.isArray(r)?r.join("; "):r,s=fv.parse(n);return Ln.matchCriteriaRegexObjectWithRequestObject(this.criteria.cookies,s)}return!0}matchProtocol(t){let r=t.headers&&t.headers[hv.HTTP_HEADERS.x0Protocol]||"https",n;return typeof this.criteria.protocol=="string"?n=new RegExp(`^${this.criteria.protocol}$`,"i"):n=new RegExp(this.criteria.protocol||"^https$","i"),Ln.testRegExp(n,r)}toString(){let{path:t,...r}=this.criteria;return Object.keys(r).length?JSON.stringify(this.criteria):t||"fallback"}toRegex(){return ft.toRegexp(this.criteria.path)}toJson(){var t;return JSON.stringify({...this.criteria,label:(t=this.options)===null||t===void 0?void 0:t.label},(r,n)=>n instanceof RegExp?n.toString():n)}toRegexString(){return this.toRegex().source}toEdgeRegexString(){return ft.toEdgeRegexString(this.criteria.path)}isRespRoute(){return!!this.criteria.response}static toRegexp(t){if(t)try{return pv.pathToRegexp(t)}catch{throw new ec.PathMatcherError(t)}else return/^.*$/}static toEdgeRegexString(t){return vv.default(ft.toRegexp(t))}static pathWithQueryString(t,r){let n=mv.default.stringify(r).replace(/%3A/g,":");return t+(n&&`\\?${n}`)}};pt.default=ft});var rc=p(Si=>{"use strict";Object.defineProperty(Si,"__esModule",{value:!0});var tc=require("zlib"),gt=re();function _v(e){var t;let r=(t=e.getHeader(gt.HTTP_HEADERS.contentEncoding))===null||t===void 0?void 0:t.toLowerCase();if(!r)return!0;switch(r){case gt.GZIP_ENCODING:return Buffer.isBuffer(e.body)?(e.body=tc.gunzipSync(e.body),e.removeHeader(gt.HTTP_HEADERS.contentEncoding),e.setHeader(gt.HTTP_HEADERS.contentLength,Buffer.byteLength(e.body)),!0):!1;case gt.BROTLI_ENCODING:return Buffer.isBuffer(e.body)?(e.body=tc.brotliDecompressSync(e.body),e.removeHeader(gt.HTTP_HEADERS.contentEncoding),e.setHeader(gt.HTTP_HEADERS.contentLength,Buffer.byteLength(e.body)),!0):!1;default:return!1}}Si.default=_v});var sc=p((Aw,nc)=>{"use strict";nc.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}});var oc=p((Cw,ic)=>{"use strict";ic.exports=M;M.Node=mt;M.create=M;function M(e){var t=this;if(t instanceof M||(t=new M),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(s){t.push(s)});else if(arguments.length>0)for(var r=0,n=arguments.length;r<n;r++)t.push(arguments[r]);return t}M.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t};M.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}};M.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}};M.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)Ev(this,arguments[e]);return this.length};M.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)wv(this,arguments[e]);return this.length};M.prototype.pop=function(){if(!!this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}};M.prototype.shift=function(){if(!!this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}};M.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;r!==null;n++)e.call(t,r.value,n,this),r=r.next};M.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;r!==null;n--)e.call(t,r.value,n,this),r=r.prev};M.prototype.get=function(e){for(var t=0,r=this.head;r!==null&&t<e;t++)r=r.next;if(t===e&&r!==null)return r.value};M.prototype.getReverse=function(e){for(var t=0,r=this.tail;r!==null&&t<e;t++)r=r.prev;if(t===e&&r!==null)return r.value};M.prototype.map=function(e,t){t=t||this;for(var r=new M,n=this.head;n!==null;)r.push(e.call(t,n.value,this)),n=n.next;return r};M.prototype.mapReverse=function(e,t){t=t||this;for(var r=new M,n=this.tail;n!==null;)r.push(e.call(t,n.value,this)),n=n.prev;return r};M.prototype.reduce=function(e,t){var r,n=this.head;if(arguments.length>1)r=t;else if(this.head)n=this.head.next,r=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var s=0;n!==null;s++)r=e(r,n.value,s),n=n.next;return r};M.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(arguments.length>1)r=t;else if(this.tail)n=this.tail.prev,r=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var s=this.length-1;n!==null;s--)r=e(r,n.value,s),n=n.prev;return r};M.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;r!==null;t++)e[t]=r.value,r=r.next;return e};M.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;r!==null;t++)e[t]=r.value,r=r.prev;return e};M.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var r=new M;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var n=0,s=this.head;s!==null&&n<e;n++)s=s.next;for(;s!==null&&n<t;n++,s=s.next)r.push(s.value);return r};M.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var r=new M;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var n=this.length,s=this.tail;s!==null&&n>t;n--)s=s.prev;for(;s!==null&&n>e;n--,s=s.prev)r.push(s.value);return r};M.prototype.splice=function(e,t,...r){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,s=this.head;s!==null&&n<e;n++)s=s.next;for(var i=[],n=0;s&&n<t;n++)i.push(s.value),s=this.removeNode(s);s===null&&(s=this.tail),s!==this.head&&s!==this.tail&&(s=s.prev);for(var n=0;n<r.length;n++)s=bv(this,s,r[n]);return i};M.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;r!==null;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this};function bv(e,t,r){var n=t===e.head?new mt(r,null,t,e):new mt(r,t,t.next,e);return n.next===null&&(e.tail=n),n.prev===null&&(e.head=n),e.length++,n}function Ev(e,t){e.tail=new mt(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function wv(e,t){e.head=new mt(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function mt(e,t,r,n){if(!(this instanceof mt))return new mt(e,t,r,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}try{sc()(M)}catch{}});var dc=p((Sw,cc)=>{"use strict";var Rv=oc(),vt=Symbol("max"),ke=Symbol("length"),$t=Symbol("lengthCalculator"),Nr=Symbol("allowStale"),yt=Symbol("maxAge"),Be=Symbol("dispose"),ac=Symbol("noDisposeOnSet"),oe=Symbol("lruList"),He=Symbol("cache"),lc=Symbol("updateAgeOnGet"),Ti=()=>1,Oi=class{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");let r=this[vt]=t.max||1/0,n=t.length||Ti;if(this[$t]=typeof n!="function"?Ti:n,this[Nr]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[yt]=t.maxAge||0,this[Be]=t.dispose,this[ac]=t.noDisposeOnSet||!1,this[lc]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[vt]=t||1/0,Hr(this)}get max(){return this[vt]}set allowStale(t){this[Nr]=!!t}get allowStale(){return this[Nr]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[yt]=t,Hr(this)}get maxAge(){return this[yt]}set lengthCalculator(t){typeof t!="function"&&(t=Ti),t!==this[$t]&&(this[$t]=t,this[ke]=0,this[oe].forEach(r=>{r.length=this[$t](r.value,r.key),this[ke]+=r.length})),Hr(this)}get lengthCalculator(){return this[$t]}get length(){return this[ke]}get itemCount(){return this[oe].length}rforEach(t,r){r=r||this;for(let n=this[oe].tail;n!==null;){let s=n.prev;uc(this,t,n,r),n=s}}forEach(t,r){r=r||this;for(let n=this[oe].head;n!==null;){let s=n.next;uc(this,t,n,r),n=s}}keys(){return this[oe].toArray().map(t=>t.key)}values(){return this[oe].toArray().map(t=>t.value)}reset(){this[Be]&&this[oe]&&this[oe].length&&this[oe].forEach(t=>this[Be](t.key,t.value)),this[He]=new Map,this[oe]=new Rv,this[ke]=0}dump(){return this[oe].map(t=>Un(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[oe]}set(t,r,n){if(n=n||this[yt],n&&typeof n!="number")throw new TypeError("maxAge must be a number");let s=n?Date.now():0,i=this[$t](r,t);if(this[He].has(t)){if(i>this[vt])return Ut(this,this[He].get(t)),!1;let u=this[He].get(t).value;return this[Be]&&(this[ac]||this[Be](t,u.value)),u.now=s,u.maxAge=n,u.value=r,this[ke]+=i-u.length,u.length=i,this.get(t),Hr(this),!0}let o=new Pi(t,r,i,s,n);return o.length>this[vt]?(this[Be]&&this[Be](t,r),!1):(this[ke]+=o.length,this[oe].unshift(o),this[He].set(t,this[oe].head),Hr(this),!0)}has(t){if(!this[He].has(t))return!1;let r=this[He].get(t).value;return!Un(this,r)}get(t){return xi(this,t,!0)}peek(t){return xi(this,t,!1)}pop(){let t=this[oe].tail;return t?(Ut(this,t),t.value):null}del(t){Ut(this,this[He].get(t))}load(t){this.reset();let r=Date.now();for(let n=t.length-1;n>=0;n--){let s=t[n],i=s.e||0;if(i===0)this.set(s.k,s.v);else{let o=i-r;o>0&&this.set(s.k,s.v,o)}}}prune(){this[He].forEach((t,r)=>xi(this,r,!1))}},xi=(e,t,r)=>{let n=e[He].get(t);if(n){let s=n.value;if(Un(e,s)){if(Ut(e,n),!e[Nr])return}else r&&(e[lc]&&(n.value.now=Date.now()),e[oe].unshiftNode(n));return s.value}},Un=(e,t)=>{if(!t||!t.maxAge&&!e[yt])return!1;let r=Date.now()-t.now;return t.maxAge?r>t.maxAge:e[yt]&&r>e[yt]},Hr=e=>{if(e[ke]>e[vt])for(let t=e[oe].tail;e[ke]>e[vt]&&t!==null;){let r=t.prev;Ut(e,t),t=r}},Ut=(e,t)=>{if(t){let r=t.value;e[Be]&&e[Be](r.key,r.value),e[ke]-=r.length,e[He].delete(r.key),e[oe].removeNode(t)}},Pi=class{constructor(t,r,n,s,i){this.key=t,this.value=r,this.length=n,this.now=s,this.maxAge=i||0}},uc=(e,t,r,n)=>{let s=r.value;Un(e,s)&&(Ut(e,r),e[Nr]||(s=void 0)),s&&t.call(n,s.value,s.key,e)};cc.exports=Oi});var Wi=p((qr,Wt)=>{var Av=200,Rc="__lodash_hash_undefined__",Ac=9007199254740991,Bi="[object Arguments]",Cv="[object Array]",Cc="[object Boolean]",Sc="[object Date]",Sv="[object Error]",ki="[object Function]",Tc="[object GeneratorFunction]",Wn="[object Map]",xc="[object Number]",ji="[object Object]",hc="[object Promise]",Oc="[object RegExp]",Gn="[object Set]",Pc="[object String]",Hc="[object Symbol]",Ni="[object WeakMap]",Nc="[object ArrayBuffer]",Kn="[object DataView]",qc="[object Float32Array]",Dc="[object Float64Array]",Mc="[object Int8Array]",Ic="[object Int16Array]",Vc="[object Int32Array]",Bc="[object Uint8Array]",kc="[object Uint8ClampedArray]",jc="[object Uint16Array]",Lc="[object Uint32Array]",Tv=/[\\^$.*+?()[\]{}|]/g,xv=/\w*$/,Ov=/^\[object .+?Constructor\]$/,Pv=/^(?:0|[1-9]\d*)$/,j={};j[Bi]=j[Cv]=j[Nc]=j[Kn]=j[Cc]=j[Sc]=j[qc]=j[Dc]=j[Mc]=j[Ic]=j[Vc]=j[Wn]=j[xc]=j[ji]=j[Oc]=j[Gn]=j[Pc]=j[Hc]=j[Bc]=j[kc]=j[jc]=j[Lc]=!0;j[Sv]=j[ki]=j[Ni]=!1;var Hv=typeof global=="object"&&global&&global.Object===Object&&global,Nv=typeof self=="object"&&self&&self.Object===Object&&self,je=Hv||Nv||Function("return this")(),Fc=typeof qr=="object"&&qr&&!qr.nodeType&&qr,fc=Fc&&typeof Wt=="object"&&Wt&&!Wt.nodeType&&Wt,qv=fc&&fc.exports===Fc;function Dv(e,t){return e.set(t[0],t[1]),e}function Mv(e,t){return e.add(t),e}function Iv(e,t){for(var r=-1,n=e?e.length:0;++r<n&&t(e[r],r,e)!==!1;);return e}function Vv(e,t){for(var r=-1,n=t.length,s=e.length;++r<n;)e[s+r]=t[r];return e}function $c(e,t,r,n){var s=-1,i=e?e.length:0;for(n&&i&&(r=e[++s]);++s<i;)r=t(r,e[s],s,e);return r}function Bv(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}function kv(e,t){return e==null?void 0:e[t]}function Uc(e){var t=!1;if(e!=null&&typeof e.toString!="function")try{t=!!(e+"")}catch{}return t}function pc(e){var t=-1,r=Array(e.size);return e.forEach(function(n,s){r[++t]=[s,n]}),r}function Li(e,t){return function(r){return e(t(r))}}function gc(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var jv=Array.prototype,Lv=Function.prototype,zn=Object.prototype,Hi=je["__core-js_shared__"],mc=function(){var e=/[^.]+$/.exec(Hi&&Hi.keys&&Hi.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Wc=Lv.toString,Ye=zn.hasOwnProperty,Yn=zn.toString,Fv=RegExp("^"+Wc.call(Ye).replace(Tv,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),vc=qv?je.Buffer:void 0,yc=je.Symbol,_c=je.Uint8Array,$v=Li(Object.getPrototypeOf,Object),Uv=Object.create,Wv=zn.propertyIsEnumerable,Gv=jv.splice,bc=Object.getOwnPropertySymbols,Kv=vc?vc.isBuffer:void 0,zv=Li(Object.keys,Object),qi=zt(je,"DataView"),Dr=zt(je,"Map"),Di=zt(je,"Promise"),Mi=zt(je,"Set"),Ii=zt(je,"WeakMap"),Mr=zt(Object,"create"),Yv=Et(qi),Jv=Et(Dr),Qv=Et(Di),Xv=Et(Mi),Zv=Et(Ii),Ec=yc?yc.prototype:void 0,wc=Ec?Ec.valueOf:void 0;function bt(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ey(){this.__data__=Mr?Mr(null):{}}function ty(e){return this.has(e)&&delete this.__data__[e]}function ry(e){var t=this.__data__;if(Mr){var r=t[e];return r===Rc?void 0:r}return Ye.call(t,e)?t[e]:void 0}function ny(e){var t=this.__data__;return Mr?t[e]!==void 0:Ye.call(t,e)}function sy(e,t){var r=this.__data__;return r[e]=Mr&&t===void 0?Rc:t,this}bt.prototype.clear=ey;bt.prototype.delete=ty;bt.prototype.get=ry;bt.prototype.has=ny;bt.prototype.set=sy;function Le(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function iy(){this.__data__=[]}function oy(e){var t=this.__data__,r=Jn(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():Gv.call(t,r,1),!0}function ay(e){var t=this.__data__,r=Jn(t,e);return r<0?void 0:t[r][1]}function uy(e){return Jn(this.__data__,e)>-1}function ly(e,t){var r=this.__data__,n=Jn(r,e);return n<0?r.push([e,t]):r[n][1]=t,this}Le.prototype.clear=iy;Le.prototype.delete=oy;Le.prototype.get=ay;Le.prototype.has=uy;Le.prototype.set=ly;function Gt(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function cy(){this.__data__={hash:new bt,map:new(Dr||Le),string:new bt}}function dy(e){return Qn(this,e).delete(e)}function hy(e){return Qn(this,e).get(e)}function fy(e){return Qn(this,e).has(e)}function py(e,t){return Qn(this,e).set(e,t),this}Gt.prototype.clear=cy;Gt.prototype.delete=dy;Gt.prototype.get=hy;Gt.prototype.has=fy;Gt.prototype.set=py;function Kt(e){this.__data__=new Le(e)}function gy(){this.__data__=new Le}function my(e){return this.__data__.delete(e)}function vy(e){return this.__data__.get(e)}function yy(e){return this.__data__.has(e)}function _y(e,t){var r=this.__data__;if(r instanceof Le){var n=r.__data__;if(!Dr||n.length<Av-1)return n.push([e,t]),this;r=this.__data__=new Gt(n)}return r.set(e,t),this}Kt.prototype.clear=gy;Kt.prototype.delete=my;Kt.prototype.get=vy;Kt.prototype.has=yy;Kt.prototype.set=_y;function by(e,t){var r=$i(e)||Uy(e)?Bv(e.length,String):[],n=r.length,s=!!n;for(var i in e)(t||Ye.call(e,i))&&!(s&&(i=="length"||jy(i,n)))&&r.push(i);return r}function Gc(e,t,r){var n=e[t];(!(Ye.call(e,t)&&Jc(n,r))||r===void 0&&!(t in e))&&(e[t]=r)}function Jn(e,t){for(var r=e.length;r--;)if(Jc(e[r][0],t))return r;return-1}function Ey(e,t){return e&&Kc(t,Ui(t),e)}function Vi(e,t,r,n,s,i,o){var a;if(n&&(a=i?n(e,s,i,o):n(e)),a!==void 0)return a;if(!Xn(e))return e;var u=$i(e);if(u){if(a=Vy(e),!t)return Dy(e,a)}else{var l=_t(e),c=l==ki||l==Tc;if(Gy(e))return Ty(e,t);if(l==ji||l==Bi||c&&!i){if(Uc(e))return i?e:{};if(a=By(c?{}:e),!t)return My(e,Ey(a,e))}else{if(!j[l])return i?e:{};a=ky(e,l,Vi,t)}}o||(o=new Kt);var d=o.get(e);if(d)return d;if(o.set(e,a),!u)var h=r?Iy(e):Ui(e);return Iv(h||e,function(g,v){h&&(v=g,g=e[v]),Gc(a,v,Vi(g,t,r,n,v,e,o))}),a}function wy(e){return Xn(e)?Uv(e):{}}function Ry(e,t,r){var n=t(e);return $i(e)?n:Vv(n,r(e))}function Ay(e){return Yn.call(e)}function Cy(e){if(!Xn(e)||Fy(e))return!1;var t=Xc(e)||Uc(e)?Fv:Ov;return t.test(Et(e))}function Sy(e){if(!Yc(e))return zv(e);var t=[];for(var r in Object(e))Ye.call(e,r)&&r!="constructor"&&t.push(r);return t}function Ty(e,t){if(t)return e.slice();var r=new e.constructor(e.length);return e.copy(r),r}function Fi(e){var t=new e.constructor(e.byteLength);return new _c(t).set(new _c(e)),t}function xy(e,t){var r=t?Fi(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}function Oy(e,t,r){var n=t?r(pc(e),!0):pc(e);return $c(n,Dv,new e.constructor)}function Py(e){var t=new e.constructor(e.source,xv.exec(e));return t.lastIndex=e.lastIndex,t}function Hy(e,t,r){var n=t?r(gc(e),!0):gc(e);return $c(n,Mv,new e.constructor)}function Ny(e){return wc?Object(wc.call(e)):{}}function qy(e,t){var r=t?Fi(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}function Dy(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}function Kc(e,t,r,n){r||(r={});for(var s=-1,i=t.length;++s<i;){var o=t[s],a=n?n(r[o],e[o],o,r,e):void 0;Gc(r,o,a===void 0?e[o]:a)}return r}function My(e,t){return Kc(e,zc(e),t)}function Iy(e){return Ry(e,Ui,zc)}function Qn(e,t){var r=e.__data__;return Ly(t)?r[typeof t=="string"?"string":"hash"]:r.map}function zt(e,t){var r=kv(e,t);return Cy(r)?r:void 0}var zc=bc?Li(bc,Object):Yy,_t=Ay;(qi&&_t(new qi(new ArrayBuffer(1)))!=Kn||Dr&&_t(new Dr)!=Wn||Di&&_t(Di.resolve())!=hc||Mi&&_t(new Mi)!=Gn||Ii&&_t(new Ii)!=Ni)&&(_t=function(e){var t=Yn.call(e),r=t==ji?e.constructor:void 0,n=r?Et(r):void 0;if(n)switch(n){case Yv:return Kn;case Jv:return Wn;case Qv:return hc;case Xv:return Gn;case Zv:return Ni}return t});function Vy(e){var t=e.length,r=e.constructor(t);return t&&typeof e[0]=="string"&&Ye.call(e,"index")&&(r.index=e.index,r.input=e.input),r}function By(e){return typeof e.constructor=="function"&&!Yc(e)?wy($v(e)):{}}function ky(e,t,r,n){var s=e.constructor;switch(t){case Nc:return Fi(e);case Cc:case Sc:return new s(+e);case Kn:return xy(e,n);case qc:case Dc:case Mc:case Ic:case Vc:case Bc:case kc:case jc:case Lc:return qy(e,n);case Wn:return Oy(e,n,r);case xc:case Pc:return new s(e);case Oc:return Py(e);case Gn:return Hy(e,n,r);case Hc:return Ny(e)}}function jy(e,t){return t=t??Ac,!!t&&(typeof e=="number"||Pv.test(e))&&e>-1&&e%1==0&&e<t}function Ly(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Fy(e){return!!mc&&mc in e}function Yc(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||zn;return e===r}function Et(e){if(e!=null){try{return Wc.call(e)}catch{}try{return e+""}catch{}}return""}function $y(e){return Vi(e,!0,!0)}function Jc(e,t){return e===t||e!==e&&t!==t}function Uy(e){return Wy(e)&&Ye.call(e,"callee")&&(!Wv.call(e,"callee")||Yn.call(e)==Bi)}var $i=Array.isArray;function Qc(e){return e!=null&&Ky(e.length)&&!Xc(e)}function Wy(e){return zy(e)&&Qc(e)}var Gy=Kv||Jy;function Xc(e){var t=Xn(e)?Yn.call(e):"";return t==ki||t==Tc}function Ky(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Ac}function Xn(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function zy(e){return!!e&&typeof e=="object"}function Ui(e){return Qc(e)?by(e):Sy(e)}function Yy(){return[]}function Jy(){return!1}Wt.exports=$y});var Ki=p(Fe=>{"use strict";var ed=Fe&&Fe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Fe,"__esModule",{value:!0});var ae=re(),Qy=ed(dc()),Xy=ed(Wi()),Gi;function Zy(){return process.env.EDGIO_CACHE==="true"}Fe.isCacheEnabled=Zy;function Zn(){return Gi||(Gi=new Qy.default),Gi}Fe.getCache=Zn;function e0(){Zn().reset()}Fe.clearCache=e0;function t0(e){return Zn().get(e.toString())}Fe.getCachedResponse=t0;function r0({response:e,cacheKey:t,context:r}){var n;let s=(n=t.method)===null||n===void 0?void 0:n.toLowerCase();if(s&&!ae.CACHEABLE_METHODS.has(s)&&r.cacheRouteMethod!==s)return e.setHeader(ae.HTTP_HEADERS.x0CachingStatus,ae.CACHING_STATUS.method),!1;if(t.body&&Buffer.from(t.body,"utf8").length>8e3)return e.setHeader(ae.HTTP_HEADERS.x0CachingStatus,ae.CACHING_STATUS.bodyTooBig),!1;if(e.statusCode&&e.statusCode>=400)return e.setHeader(ae.HTTP_HEADERS.x0CachingStatus,ae.CACHING_STATUS.code),!1;if(e.getHeader(ae.HTTP_HEADERS.setCookie))return e.setHeader(ae.HTTP_HEADERS.x0CachingStatus,ae.CACHING_STATUS.setCookie),!1;let i=s0(e);return i.private&&!r.forcePrivateCaching?(e.setHeader(ae.HTTP_HEADERS.x0CachingStatus,ae.CACHING_STATUS.private),!1):i.maxAge?(Zn().set(t.toString(),n0(e),i.maxAge*1e3),e.setHeader(ae.HTTP_HEADERS.x0CachingStatus,ae.CACHING_STATUS.ok),!0):(e.setHeader(ae.HTTP_HEADERS.x0CachingStatus,ae.CACHING_STATUS.noMaxAge),!1)}Fe.maybeCacheResponse=r0;function n0(e){return{statusCode:e.statusCode,statusMessage:e.statusMessage,headers:Xy.default(e.getHeaders()),body:e.body}}function s0(e){return{...{private:!1,maxAge:0},...Zc(e.getHeader(ae.HTTP_HEADERS.cacheControl)),...Zc(e.getHeader(ae.HTTP_HEADERS.x0CacheControl))}}function Zc(e){let t={};if(e){Array.isArray(e)||(e=[e]);let r={};for(let n of e){let s=n.split(/,\s*/).map(i=>i.split(/=/));for(let[i,o]of s)i&&o&&(r[i.toLowerCase()]=o),i.toLowerCase()==="private"&&(t.private=!0);t.maxAge=parseInt(r["s-maxage"]||r["max-age"]||"0")}}return t}});var td=p(Vr=>{"use strict";var i0=Vr&&Vr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Vr,"__esModule",{value:!0});var Je=re(),o0=i0(require("crypto")),Ir=class{constructor(t,r){var n;this.cookies={};let{host:s}=t.headers;if(this.body=t.body,this.method=(n=t.method)===null||n===void 0?void 0:n.toLowerCase(),this.query=this.excludeEdgioQueryParams(t.query||{}),this.pathname=new URL(t.url,`http://${s}`).pathname,this.headers=this.getDefaultHeaders(t.headers),r)for(let i of r.getActions())i(this,t)}static create(t,r){return new Ir(t,r)}excludeEdgioQueryParams(t){let r={};for(let n in t)n.startsWith("edgio_")||(r[n]=t[n]);return r}toSortedArray(t){return Object.keys(t).sort().map(r=>[r,t[r]])}getDefaultHeaders(t){return{[Je.HTTP_HEADERS.host]:t[Je.HTTP_HEADERS.host],[Je.HTTP_HEADERS.acceptEncoding]:t[Je.HTTP_HEADERS.acceptEncoding],[Je.HTTP_HEADERS.x0Destination]:t[Je.HTTP_HEADERS.x0Destination],[Je.HTTP_HEADERS.x0Protocol]:t[Je.HTTP_HEADERS.x0Protocol]}}toString(){return JSON.stringify({pathname:this.pathname,method:this.method,query:this.toSortedArray(this.query),body:a0(this.body),headers:this.toSortedArray(this.headers),cookies:this.toSortedArray(this.cookies)})}};Vr.default=Ir;function a0(e){if(!e)return null;let t=o0.default.createHash("sha256");return t.update(e),t.digest("hex")}});var rd=p(Qe=>{"use strict";var u0=Qe&&Qe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Qe,"__esModule",{value:!0});var l0=u0(Ge()),zi,Br,Yi="info",Ji="warn",Qi="error";try{let e=l0.default("chalk");Br=e.grey("Edgio"),zi=e.bold("Edgio"),Yi=e.cyan(Yi),Ji=e.yellow(Ji),Qi=e.red(Qi)}catch{zi=Br="Edgio"}Qe.infoLogLabel=`${Br} ${Yi} -`;Qe.warnLogLabel=`${Br} ${Ji} -`;Qe.errorLogLabel=`${Br} ${Qi} -`;Qe.default=zi});var nd=p(Zi=>{"use strict";Object.defineProperty(Zi,"__esModule",{value:!0});var Xi=class{constructor(t){this.name=t}byPattern(t){this.pattern=t}toJSON(){if(!this.pattern)throw new Error("byPattern is required for group "+this.name);return{groupedValue:this.name,matchRegex:this.pattern.source}}};Zi.default=Xi});var sd=p(kr=>{"use strict";var c0=kr&&kr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(kr,"__esModule",{value:!0});var d0=c0(nd()),eo=class{constructor(){this.groups=[],this.name=null}group(t){let r=new d0.default(t);return this.groups.push(r),r}toJSON(){return this.groups.map(t=>t.toJSON())}};kr.default=eo});var es=p(Se=>{"use strict";var h0=Se&&Se.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Se,"__esModule",{value:!0});var id=h0(sd()),f0=Nn();Se.CUSTOM_CACHE_KEY_ACTIONS={blacklistAll:"blacklist-all-query-parameters",blacklistSome:"blacklist-some-query-parameters",whitelistSome:"whitelist-some-query-parameters",addValue:"add-value",removeMethod:"remove-method",removeBody:"remove-body"};var jr=class{constructor(){this.config=[],this.actions=[]}clone(){let t=new jr;return t.actions=this.actions,t.config=this.config,t}excludeAllQueryParameters(){return this.config.push({action:Se.CUSTOM_CACHE_KEY_ACTIONS.blacklistAll}),this.actions.push((t,r)=>{t.query={}}),this}excludeQueryParameters(...t){return this.config.push({action:Se.CUSTOM_CACHE_KEY_ACTIONS.blacklistSome,names:t}),this.actions.push((r,n)=>{for(let s of t)delete r.query[s]}),this}excludeAllQueryParametersExcept(...t){return this.config.push({action:Se.CUSTOM_CACHE_KEY_ACTIONS.whitelistSome,names:t}),this.actions.push((r,n)=>{let s=new Set(t);for(let i in r.query)s.has(i)||delete r.query[i]}),this}addHeader(t,r){return this.actions.push((n,s)=>{let i=s.headers[t];Array.isArray(i)||(i=[i]),r?n.headers[t]=this.createGroupedValue(r,i):n.headers[t]=i}),this.addValue(`\${req:${t}}`,r)}removeMethod(){return this.actions.push((t,r)=>{t.method=void 0}),this.config.push({action:Se.CUSTOM_CACHE_KEY_ACTIONS.removeMethod}),this}removeBody(){return this.actions.push((t,r)=>{t.body=void 0}),this.config.push({action:Se.CUSTOM_CACHE_KEY_ACTIONS.removeBody}),this}createGroupedValue(t,r){let n=new id.default,s=[];t(n);let i=this.findMatchingGroup(n,r);return i?s.push(i):s.push(...r),s}findMatchingGroup(t,r){var n;for(let s of t.groups)for(let i of r)if(!((n=s.pattern)===null||n===void 0)&&n.test(i))return s.name}addDevice(){return this.addHeader("x-0-device")}addVendor(){return this.addHeader("x-0-vendor")}addIsBot(){return this.addHeader("x-0-device-is-bot")}addBrowser(){return this.addHeader("x-0-browser")}addCookie(t,r){return this.actions.push((n,s)=>{let i=s.headers.cookie||"";Array.isArray(i)&&(i=i.join(";"));let a=f0.parse(i)[t];r?n.cookies[t]=this.createGroupedValue(r,[a]):n.cookies[t]=a}),this.addValue(`\${req:cookie:${t}}`,r)}addValue(t,r){let n={action:Se.CUSTOM_CACHE_KEY_ACTIONS.addValue,value:t};if(r!=null){let s=new id.default;r(s),n.groups=s.toJSON()}return this.config.push(n),this}getActions(){return this.actions}toJSON(){return this.config}};Se.default=jr});var ad=p((qw,od)=>{"use strict";od.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}});var to=p((Dw,ld)=>{var Lr=ad(),ud={};for(let e of Object.keys(Lr))ud[Lr[e]]=e;var A={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};ld.exports=A;for(let e of Object.keys(A)){if(!("channels"in A[e]))throw new Error("missing channels property: "+e);if(!("labels"in A[e]))throw new Error("missing channel labels property: "+e);if(A[e].labels.length!==A[e].channels)throw new Error("channel and label counts mismatch: "+e);let{channels:t,labels:r}=A[e];delete A[e].channels,delete A[e].labels,Object.defineProperty(A[e],"channels",{value:t}),Object.defineProperty(A[e],"labels",{value:r})}A.rgb.hsl=function(e){let t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.min(t,r,n),i=Math.max(t,r,n),o=i-s,a,u;i===s?a=0:t===i?a=(r-n)/o:r===i?a=2+(n-t)/o:n===i&&(a=4+(t-r)/o),a=Math.min(a*60,360),a<0&&(a+=360);let l=(s+i)/2;return i===s?u=0:l<=.5?u=o/(i+s):u=o/(2-i-s),[a,u*100,l*100]};A.rgb.hsv=function(e){let t,r,n,s,i,o=e[0]/255,a=e[1]/255,u=e[2]/255,l=Math.max(o,a,u),c=l-Math.min(o,a,u),d=function(h){return(l-h)/6/c+1/2};return c===0?(s=0,i=0):(i=c/l,t=d(o),r=d(a),n=d(u),o===l?s=n-r:a===l?s=1/3+t-n:u===l&&(s=2/3+r-t),s<0?s+=1:s>1&&(s-=1)),[s*360,i*100,l*100]};A.rgb.hwb=function(e){let t=e[0],r=e[1],n=e[2],s=A.rgb.hsl(e)[0],i=1/255*Math.min(t,Math.min(r,n));return n=1-1/255*Math.max(t,Math.max(r,n)),[s,i*100,n*100]};A.rgb.cmyk=function(e){let t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.min(1-t,1-r,1-n),i=(1-t-s)/(1-s)||0,o=(1-r-s)/(1-s)||0,a=(1-n-s)/(1-s)||0;return[i*100,o*100,a*100,s*100]};function p0(e,t){return(e[0]-t[0])**2+(e[1]-t[1])**2+(e[2]-t[2])**2}A.rgb.keyword=function(e){let t=ud[e];if(t)return t;let r=1/0,n;for(let s of Object.keys(Lr)){let i=Lr[s],o=p0(e,i);o<r&&(r=o,n=s)}return n};A.keyword.rgb=function(e){return Lr[e]};A.rgb.xyz=function(e){let t=e[0]/255,r=e[1]/255,n=e[2]/255;t=t>.04045?((t+.055)/1.055)**2.4:t/12.92,r=r>.04045?((r+.055)/1.055)**2.4:r/12.92,n=n>.04045?((n+.055)/1.055)**2.4:n/12.92;let s=t*.4124+r*.3576+n*.1805,i=t*.2126+r*.7152+n*.0722,o=t*.0193+r*.1192+n*.9505;return[s*100,i*100,o*100]};A.rgb.lab=function(e){let t=A.rgb.xyz(e),r=t[0],n=t[1],s=t[2];r/=95.047,n/=100,s/=108.883,r=r>.008856?r**(1/3):7.787*r+16/116,n=n>.008856?n**(1/3):7.787*n+16/116,s=s>.008856?s**(1/3):7.787*s+16/116;let i=116*n-16,o=500*(r-n),a=200*(n-s);return[i,o,a]};A.hsl.rgb=function(e){let t=e[0]/360,r=e[1]/100,n=e[2]/100,s,i,o;if(r===0)return o=n*255,[o,o,o];n<.5?s=n*(1+r):s=n+r-n*r;let a=2*n-s,u=[0,0,0];for(let l=0;l<3;l++)i=t+1/3*-(l-1),i<0&&i++,i>1&&i--,6*i<1?o=a+(s-a)*6*i:2*i<1?o=s:3*i<2?o=a+(s-a)*(2/3-i)*6:o=a,u[l]=o*255;return u};A.hsl.hsv=function(e){let t=e[0],r=e[1]/100,n=e[2]/100,s=r,i=Math.max(n,.01);n*=2,r*=n<=1?n:2-n,s*=i<=1?i:2-i;let o=(n+r)/2,a=n===0?2*s/(i+s):2*r/(n+r);return[t,a*100,o*100]};A.hsv.rgb=function(e){let t=e[0]/60,r=e[1]/100,n=e[2]/100,s=Math.floor(t)%6,i=t-Math.floor(t),o=255*n*(1-r),a=255*n*(1-r*i),u=255*n*(1-r*(1-i));switch(n*=255,s){case 0:return[n,u,o];case 1:return[a,n,o];case 2:return[o,n,u];case 3:return[o,a,n];case 4:return[u,o,n];case 5:return[n,o,a]}};A.hsv.hsl=function(e){let t=e[0],r=e[1]/100,n=e[2]/100,s=Math.max(n,.01),i,o;o=(2-r)*n;let a=(2-r)*s;return i=r*s,i/=a<=1?a:2-a,i=i||0,o/=2,[t,i*100,o*100]};A.hwb.rgb=function(e){let t=e[0]/360,r=e[1]/100,n=e[2]/100,s=r+n,i;s>1&&(r/=s,n/=s);let o=Math.floor(6*t),a=1-n;i=6*t-o,(o&1)!==0&&(i=1-i);let u=r+i*(a-r),l,c,d;switch(o){default:case 6:case 0:l=a,c=u,d=r;break;case 1:l=u,c=a,d=r;break;case 2:l=r,c=a,d=u;break;case 3:l=r,c=u,d=a;break;case 4:l=u,c=r,d=a;break;case 5:l=a,c=r,d=u;break}return[l*255,c*255,d*255]};A.cmyk.rgb=function(e){let t=e[0]/100,r=e[1]/100,n=e[2]/100,s=e[3]/100,i=1-Math.min(1,t*(1-s)+s),o=1-Math.min(1,r*(1-s)+s),a=1-Math.min(1,n*(1-s)+s);return[i*255,o*255,a*255]};A.xyz.rgb=function(e){let t=e[0]/100,r=e[1]/100,n=e[2]/100,s,i,o;return s=t*3.2406+r*-1.5372+n*-.4986,i=t*-.9689+r*1.8758+n*.0415,o=t*.0557+r*-.204+n*1.057,s=s>.0031308?1.055*s**(1/2.4)-.055:s*12.92,i=i>.0031308?1.055*i**(1/2.4)-.055:i*12.92,o=o>.0031308?1.055*o**(1/2.4)-.055:o*12.92,s=Math.min(Math.max(0,s),1),i=Math.min(Math.max(0,i),1),o=Math.min(Math.max(0,o),1),[s*255,i*255,o*255]};A.xyz.lab=function(e){let t=e[0],r=e[1],n=e[2];t/=95.047,r/=100,n/=108.883,t=t>.008856?t**(1/3):7.787*t+16/116,r=r>.008856?r**(1/3):7.787*r+16/116,n=n>.008856?n**(1/3):7.787*n+16/116;let s=116*r-16,i=500*(t-r),o=200*(r-n);return[s,i,o]};A.lab.xyz=function(e){let t=e[0],r=e[1],n=e[2],s,i,o;i=(t+16)/116,s=r/500+i,o=i-n/200;let a=i**3,u=s**3,l=o**3;return i=a>.008856?a:(i-16/116)/7.787,s=u>.008856?u:(s-16/116)/7.787,o=l>.008856?l:(o-16/116)/7.787,s*=95.047,i*=100,o*=108.883,[s,i,o]};A.lab.lch=function(e){let t=e[0],r=e[1],n=e[2],s;s=Math.atan2(n,r)*360/2/Math.PI,s<0&&(s+=360);let o=Math.sqrt(r*r+n*n);return[t,o,s]};A.lch.lab=function(e){let t=e[0],r=e[1],s=e[2]/360*2*Math.PI,i=r*Math.cos(s),o=r*Math.sin(s);return[t,i,o]};A.rgb.ansi16=function(e,t=null){let[r,n,s]=e,i=t===null?A.rgb.hsv(e)[2]:t;if(i=Math.round(i/50),i===0)return 30;let o=30+(Math.round(s/255)<<2|Math.round(n/255)<<1|Math.round(r/255));return i===2&&(o+=60),o};A.hsv.ansi16=function(e){return A.rgb.ansi16(A.hsv.rgb(e),e[2])};A.rgb.ansi256=function(e){let t=e[0],r=e[1],n=e[2];return t===r&&r===n?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(r/255*5)+Math.round(n/255*5)};A.ansi16.rgb=function(e){let t=e%10;if(t===0||t===7)return e>50&&(t+=3.5),t=t/10.5*255,[t,t,t];let r=(~~(e>50)+1)*.5,n=(t&1)*r*255,s=(t>>1&1)*r*255,i=(t>>2&1)*r*255;return[n,s,i]};A.ansi256.rgb=function(e){if(e>=232){let i=(e-232)*10+8;return[i,i,i]}e-=16;let t,r=Math.floor(e/36)/5*255,n=Math.floor((t=e%36)/6)/5*255,s=t%6/5*255;return[r,n,s]};A.rgb.hex=function(e){let r=(((Math.round(e[0])&255)<<16)+((Math.round(e[1])&255)<<8)+(Math.round(e[2])&255)).toString(16).toUpperCase();return"000000".substring(r.length)+r};A.hex.rgb=function(e){let t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];let r=t[0];t[0].length===3&&(r=r.split("").map(a=>a+a).join(""));let n=parseInt(r,16),s=n>>16&255,i=n>>8&255,o=n&255;return[s,i,o]};A.rgb.hcg=function(e){let t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(Math.max(t,r),n),i=Math.min(Math.min(t,r),n),o=s-i,a,u;return o<1?a=i/(1-o):a=0,o<=0?u=0:s===t?u=(r-n)/o%6:s===r?u=2+(n-t)/o:u=4+(t-r)/o,u/=6,u%=1,[u*360,o*100,a*100]};A.hsl.hcg=function(e){let t=e[1]/100,r=e[2]/100,n=r<.5?2*t*r:2*t*(1-r),s=0;return n<1&&(s=(r-.5*n)/(1-n)),[e[0],n*100,s*100]};A.hsv.hcg=function(e){let t=e[1]/100,r=e[2]/100,n=t*r,s=0;return n<1&&(s=(r-n)/(1-n)),[e[0],n*100,s*100]};A.hcg.rgb=function(e){let t=e[0]/360,r=e[1]/100,n=e[2]/100;if(r===0)return[n*255,n*255,n*255];let s=[0,0,0],i=t%1*6,o=i%1,a=1-o,u=0;switch(Math.floor(i)){case 0:s[0]=1,s[1]=o,s[2]=0;break;case 1:s[0]=a,s[1]=1,s[2]=0;break;case 2:s[0]=0,s[1]=1,s[2]=o;break;case 3:s[0]=0,s[1]=a,s[2]=1;break;case 4:s[0]=o,s[1]=0,s[2]=1;break;default:s[0]=1,s[1]=0,s[2]=a}return u=(1-r)*n,[(r*s[0]+u)*255,(r*s[1]+u)*255,(r*s[2]+u)*255]};A.hcg.hsv=function(e){let t=e[1]/100,r=e[2]/100,n=t+r*(1-t),s=0;return n>0&&(s=t/n),[e[0],s*100,n*100]};A.hcg.hsl=function(e){let t=e[1]/100,n=e[2]/100*(1-t)+.5*t,s=0;return n>0&&n<.5?s=t/(2*n):n>=.5&&n<1&&(s=t/(2*(1-n))),[e[0],s*100,n*100]};A.hcg.hwb=function(e){let t=e[1]/100,r=e[2]/100,n=t+r*(1-t);return[e[0],(n-t)*100,(1-n)*100]};A.hwb.hcg=function(e){let t=e[1]/100,r=e[2]/100,n=1-r,s=n-t,i=0;return s<1&&(i=(n-s)/(1-s)),[e[0],s*100,i*100]};A.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]};A.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]};A.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]};A.gray.hsl=function(e){return[0,0,e[0]]};A.gray.hsv=A.gray.hsl;A.gray.hwb=function(e){return[0,100,e[0]]};A.gray.cmyk=function(e){return[0,0,0,e[0]]};A.gray.lab=function(e){return[e[0],0,0]};A.gray.hex=function(e){let t=Math.round(e[0]/100*255)&255,n=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(n.length)+n};A.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}});var dd=p((Mw,cd)=>{var ts=to();function g0(){let e={},t=Object.keys(ts);for(let r=t.length,n=0;n<r;n++)e[t[n]]={distance:-1,parent:null};return e}function m0(e){let t=g0(),r=[e];for(t[e].distance=0;r.length;){let n=r.pop(),s=Object.keys(ts[n]);for(let i=s.length,o=0;o<i;o++){let a=s[o],u=t[a];u.distance===-1&&(u.distance=t[n].distance+1,u.parent=n,r.unshift(a))}}return t}function v0(e,t){return function(r){return t(e(r))}}function y0(e,t){let r=[t[e].parent,e],n=ts[t[e].parent][e],s=t[e].parent;for(;t[s].parent;)r.unshift(t[s].parent),n=v0(ts[t[s].parent][s],n),s=t[s].parent;return n.conversion=r,n}cd.exports=function(e){let t=m0(e),r={},n=Object.keys(t);for(let s=n.length,i=0;i<s;i++){let o=n[i];t[o].parent!==null&&(r[o]=y0(o,t))}return r}});var fd=p((Iw,hd)=>{var ro=to(),_0=dd(),Yt={},b0=Object.keys(ro);function E0(e){let t=function(...r){let n=r[0];return n==null?n:(n.length>1&&(r=n),e(r))};return"conversion"in e&&(t.conversion=e.conversion),t}function w0(e){let t=function(...r){let n=r[0];if(n==null)return n;n.length>1&&(r=n);let s=e(r);if(typeof s=="object")for(let i=s.length,o=0;o<i;o++)s[o]=Math.round(s[o]);return s};return"conversion"in e&&(t.conversion=e.conversion),t}b0.forEach(e=>{Yt[e]={},Object.defineProperty(Yt[e],"channels",{value:ro[e].channels}),Object.defineProperty(Yt[e],"labels",{value:ro[e].labels});let t=_0(e);Object.keys(t).forEach(n=>{let s=t[n];Yt[e][n]=w0(s),Yt[e][n].raw=E0(s)})});hd.exports=Yt});var _d=p((Vw,yd)=>{"use strict";var pd=(e,t)=>(...r)=>`\x1B[${e(...r)+t}m`,gd=(e,t)=>(...r)=>{let n=e(...r);return`\x1B[${38+t};5;${n}m`},md=(e,t)=>(...r)=>{let n=e(...r);return`\x1B[${38+t};2;${n[0]};${n[1]};${n[2]}m`},rs=e=>e,vd=(e,t,r)=>[e,t,r],Jt=(e,t,r)=>{Object.defineProperty(e,t,{get:()=>{let n=r();return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0}),n},enumerable:!0,configurable:!0})},no,Qt=(e,t,r,n)=>{no===void 0&&(no=fd());let s=n?10:0,i={};for(let[o,a]of Object.entries(no)){let u=o==="ansi16"?"ansi":o;o===t?i[u]=e(r,s):typeof a=="object"&&(i[u]=e(a[t],s))}return i};function R0(){let e=new Map,t={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};t.color.gray=t.color.blackBright,t.bgColor.bgGray=t.bgColor.bgBlackBright,t.color.grey=t.color.blackBright,t.bgColor.bgGrey=t.bgColor.bgBlackBright;for(let[r,n]of Object.entries(t)){for(let[s,i]of Object.entries(n))t[s]={open:`\x1B[${i[0]}m`,close:`\x1B[${i[1]}m`},n[s]=t[s],e.set(i[0],i[1]);Object.defineProperty(t,r,{value:n,enumerable:!1})}return Object.defineProperty(t,"codes",{value:e,enumerable:!1}),t.color.close="\x1B[39m",t.bgColor.close="\x1B[49m",Jt(t.color,"ansi",()=>Qt(pd,"ansi16",rs,!1)),Jt(t.color,"ansi256",()=>Qt(gd,"ansi256",rs,!1)),Jt(t.color,"ansi16m",()=>Qt(md,"rgb",vd,!1)),Jt(t.bgColor,"ansi",()=>Qt(pd,"ansi16",rs,!0)),Jt(t.bgColor,"ansi256",()=>Qt(gd,"ansi256",rs,!0)),Jt(t.bgColor,"ansi16m",()=>Qt(md,"rgb",vd,!0)),t}Object.defineProperty(yd,"exports",{enumerable:!0,get:R0})});var Ed=p((Bw,bd)=>{"use strict";var A0=(e,t,r)=>{let n=e.indexOf(t);if(n===-1)return e;let s=t.length,i=0,o="";do o+=e.substr(i,n-i)+t+r,i=n+s,n=e.indexOf(t,i);while(n!==-1);return o+=e.substr(i),o},C0=(e,t,r,n)=>{let s=0,i="";do{let o=e[n-1]==="\r";i+=e.substr(s,(o?n-1:n)-s)+t+(o?`\r
`:`
`)+r,s=n+1,n=e.indexOf(`
`,s)}while(n!==-1);return i+=e.substr(s),i};bd.exports={stringReplaceAll:A0,stringEncaseCRLFWithFirstIndex:C0}});var Sd=p((kw,Cd)=>{"use strict";var S0=/(?:\\(u(?:[a-f\d]{4}|\{[a-f\d]{1,6}\})|x[a-f\d]{2}|.))|(?:\{(~)?(\w+(?:\([^)]*\))?(?:\.\w+(?:\([^)]*\))?)*)(?:[ \t]|(?=\r?\n)))|(\})|((?:.|[\r\n\f])+?)/gi,wd=/(?:^|\.)(\w+)(?:\(([^)]*)\))?/g,T0=/^(['"])((?:\\.|(?!\1)[^\\])*)\1$/,x0=/\\(u(?:[a-f\d]{4}|{[a-f\d]{1,6}})|x[a-f\d]{2}|.)|([^\\])/gi,O0=new Map([["n",`
`],["r","\r"],["t","	"],["b","\b"],["f","\f"],["v","\v"],["0","\0"],["\\","\\"],["e","\x1B"],["a","\x07"]]);function Ad(e){let t=e[0]==="u",r=e[1]==="{";return t&&!r&&e.length===5||e[0]==="x"&&e.length===3?String.fromCharCode(parseInt(e.slice(1),16)):t&&r?String.fromCodePoint(parseInt(e.slice(2,-1),16)):O0.get(e)||e}function P0(e,t){let r=[],n=t.trim().split(/\s*,\s*/g),s;for(let i of n){let o=Number(i);if(!Number.isNaN(o))r.push(o);else if(s=i.match(T0))r.push(s[2].replace(x0,(a,u,l)=>u?Ad(u):l));else throw new Error(`Invalid Chalk template style argument: ${i} (in style '${e}')`)}return r}function H0(e){wd.lastIndex=0;let t=[],r;for(;(r=wd.exec(e))!==null;){let n=r[1];if(r[2]){let s=P0(n,r[2]);t.push([n].concat(s))}else t.push([n])}return t}function Rd(e,t){let r={};for(let s of t)for(let i of s.styles)r[i[0]]=s.inverse?null:i.slice(1);let n=e;for(let[s,i]of Object.entries(r))if(!!Array.isArray(i)){if(!(s in n))throw new Error(`Unknown Chalk style: ${s}`);n=i.length>0?n[s](...i):n[s]}return n}Cd.exports=(e,t)=>{let r=[],n=[],s=[];if(t.replace(S0,(i,o,a,u,l,c)=>{if(o)s.push(Ad(o));else if(u){let d=s.join("");s=[],n.push(r.length===0?d:Rd(e,r)(d)),r.push({inverse:a,styles:H0(u)})}else if(l){if(r.length===0)throw new Error("Found extraneous } in Chalk template literal");n.push(Rd(e,r)(s.join(""))),s=[],r.pop()}else s.push(c)}),n.push(s.join("")),r.length>0){let i=`Chalk template literal is missing ${r.length} closing bracket${r.length===1?"":"s"} (\`}\`)`;throw new Error(i)}return n.join("")}});var lo=p((jw,Nd)=>{"use strict";var Fr=_d(),{stdout:io,stderr:oo}=hi(),{stringReplaceAll:N0,stringEncaseCRLFWithFirstIndex:q0}=Ed(),{isArray:ns}=Array,xd=["ansi","ansi","ansi256","ansi16m"],Xt=Object.create(null),D0=(e,t={})=>{if(t.level&&!(Number.isInteger(t.level)&&t.level>=0&&t.level<=3))throw new Error("The `level` option should be an integer from 0 to 3");let r=io?io.level:0;e.level=t.level===void 0?r:t.level},ao=class{constructor(t){return Od(t)}},Od=e=>{let t={};return D0(t,e),t.template=(...r)=>Hd(t.template,...r),Object.setPrototypeOf(t,ss.prototype),Object.setPrototypeOf(t.template,t),t.template.constructor=()=>{throw new Error("`chalk.constructor()` is deprecated. Use `new chalk.Instance()` instead.")},t.template.Instance=ao,t.template};function ss(e){return Od(e)}for(let[e,t]of Object.entries(Fr))Xt[e]={get(){let r=is(this,uo(t.open,t.close,this._styler),this._isEmpty);return Object.defineProperty(this,e,{value:r}),r}};Xt.visible={get(){let e=is(this,this._styler,!0);return Object.defineProperty(this,"visible",{value:e}),e}};var Pd=["rgb","hex","keyword","hsl","hsv","hwb","ansi","ansi256"];for(let e of Pd)Xt[e]={get(){let{level:t}=this;return function(...r){let n=uo(Fr.color[xd[t]][e](...r),Fr.color.close,this._styler);return is(this,n,this._isEmpty)}}};for(let e of Pd){let t="bg"+e[0].toUpperCase()+e.slice(1);Xt[t]={get(){let{level:r}=this;return function(...n){let s=uo(Fr.bgColor[xd[r]][e](...n),Fr.bgColor.close,this._styler);return is(this,s,this._isEmpty)}}}}var M0=Object.defineProperties(()=>{},{...Xt,level:{enumerable:!0,get(){return this._generator.level},set(e){this._generator.level=e}}}),uo=(e,t,r)=>{let n,s;return r===void 0?(n=e,s=t):(n=r.openAll+e,s=t+r.closeAll),{open:e,close:t,openAll:n,closeAll:s,parent:r}},is=(e,t,r)=>{let n=(...s)=>ns(s[0])&&ns(s[0].raw)?Td(n,Hd(n,...s)):Td(n,s.length===1?""+s[0]:s.join(" "));return Object.setPrototypeOf(n,M0),n._generator=e,n._styler=t,n._isEmpty=r,n},Td=(e,t)=>{if(e.level<=0||!t)return e._isEmpty?"":t;let r=e._styler;if(r===void 0)return t;let{openAll:n,closeAll:s}=r;if(t.indexOf("\x1B")!==-1)for(;r!==void 0;)t=N0(t,r.close,r.open),r=r.parent;let i=t.indexOf(`
`);return i!==-1&&(t=q0(t,s,n,i)),n+t+s},so,Hd=(e,...t)=>{let[r]=t;if(!ns(r)||!ns(r.raw))return t.join(" ");let n=t.slice(1),s=[r.raw[0]];for(let i=1;i<r.length;i++)s.push(String(n[i-1]).replace(/[{}\\]/g,"\\$&"),String(r.raw[i]));return so===void 0&&(so=Sd()),so(e,s.join(""))};Object.defineProperties(ss.prototype,Xt);var os=ss();os.supportsColor=io;os.stderr=ss({level:oo?oo.level:0});os.stderr.supportsColor=oo;Nd.exports=os});var Fd=p(as=>{"use strict";function qd(e,t,r,n,s,i,o){try{var a=e[i](o),u=a.value}catch(l){return void r(l)}a.done?t(u):Promise.resolve(u).then(n,s)}function wt(e){return function(){var t=this,r=arguments;return new Promise(function(n,s){var i=e.apply(t,r);function o(u){qd(i,n,s,o,a,"next",u)}function a(u){qd(i,n,s,o,a,"throw",u)}o(void 0)})}}function $r(){return($r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function B(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,(Object.setPrototypeOf||function(r,n){return r.__proto__=n,r})(e,t)}function Dd(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $e(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(s,i){if(s){if(typeof s=="string")return Dd(s,void 0);var o=Object.prototype.toString.call(s).slice(8,-1);return o==="Object"&&s.constructor&&(o=s.constructor.name),o==="Map"||o==="Set"?Array.from(s):o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?Dd(s,void 0):void 0}}(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}Object.defineProperty(as,"__esModule",{value:!0});var Md,ve=(function(e){var t=function(r){var n=Object.prototype,s=n.hasOwnProperty,i=typeof Symbol=="function"?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function l(E,b,O){return Object.defineProperty(E,b,{value:O,enumerable:!0,configurable:!0,writable:!0}),E[b]}try{l({},"")}catch{l=function(b,O,N){return b[O]=N}}function c(E,b,O,N){var T=Object.create((b&&b.prototype instanceof g?b:g).prototype),te=new Re(N||[]);return T._invoke=function(y,m,_){var C="suspendedStart";return function(S,V){if(C==="executing")throw new Error("Generator is already running");if(C==="completed"){if(S==="throw")throw V;return{value:void 0,done:!0}}for(_.method=S,_.arg=V;;){var K=_.delegate;if(K){var z=U(K,_);if(z){if(z===h)continue;return z}}if(_.method==="next")_.sent=_._sent=_.arg;else if(_.method==="throw"){if(C==="suspendedStart")throw C="completed",_.arg;_.dispatchException(_.arg)}else _.method==="return"&&_.abrupt("return",_.arg);C="executing";var Y=d(y,m,_);if(Y.type==="normal"){if(C=_.done?"completed":"suspendedYield",Y.arg===h)continue;return{value:Y.arg,done:_.done}}Y.type==="throw"&&(C="completed",_.method="throw",_.arg=Y.arg)}}}(E,O,te),T}function d(E,b,O){try{return{type:"normal",arg:E.call(b,O)}}catch(N){return{type:"throw",arg:N}}}r.wrap=c;var h={};function g(){}function v(){}function f(){}var w={};w[o]=function(){return this};var R=Object.getPrototypeOf,$=R&&R(R(Ae([])));$&&$!==n&&s.call($,o)&&(w=$);var ee=f.prototype=g.prototype=Object.create(w);function H(E){["next","throw","return"].forEach(function(b){l(E,b,function(O){return this._invoke(b,O)})})}function ue(E,b){var O;this._invoke=function(N,T){function te(){return new b(function(y,m){(function _(C,S,V,K){var z=d(E[C],E,S);if(z.type!=="throw"){var Y=z.arg,Z=Y.value;return Z&&typeof Z=="object"&&s.call(Z,"__await")?b.resolve(Z.__await).then(function(Oe){_("next",Oe,V,K)},function(Oe){_("throw",Oe,V,K)}):b.resolve(Z).then(function(Oe){Y.value=Oe,V(Y)},function(Oe){return _("throw",Oe,V,K)})}K(z.arg)})(N,T,y,m)})}return O=O?O.then(te,te):te()}}function U(E,b){var O=E.iterator[b.method];if(O===void 0){if(b.delegate=null,b.method==="throw"){if(E.iterator.return&&(b.method="return",b.arg=void 0,U(E,b),b.method==="throw"))return h;b.method="throw",b.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var N=d(O,E.iterator,b.arg);if(N.type==="throw")return b.method="throw",b.arg=N.arg,b.delegate=null,h;var T=N.arg;return T?T.done?(b[E.resultName]=T.value,b.next=E.nextLoc,b.method!=="return"&&(b.method="next",b.arg=void 0),b.delegate=null,h):T:(b.method="throw",b.arg=new TypeError("iterator result is not an object"),b.delegate=null,h)}function de(E){var b={tryLoc:E[0]};1 in E&&(b.catchLoc=E[1]),2 in E&&(b.finallyLoc=E[2],b.afterLoc=E[3]),this.tryEntries.push(b)}function Q(E){var b=E.completion||{};b.type="normal",delete b.arg,E.completion=b}function Re(E){this.tryEntries=[{tryLoc:"root"}],E.forEach(de,this),this.reset(!0)}function Ae(E){if(E){var b=E[o];if(b)return b.call(E);if(typeof E.next=="function")return E;if(!isNaN(E.length)){var O=-1,N=function T(){for(;++O<E.length;)if(s.call(E,O))return T.value=E[O],T.done=!1,T;return T.value=void 0,T.done=!0,T};return N.next=N}}return{next:vs}}function vs(){return{value:void 0,done:!0}}return v.prototype=ee.constructor=f,f.constructor=v,v.displayName=l(f,u,"GeneratorFunction"),r.isGeneratorFunction=function(E){var b=typeof E=="function"&&E.constructor;return!!b&&(b===v||(b.displayName||b.name)==="GeneratorFunction")},r.mark=function(E){return Object.setPrototypeOf?Object.setPrototypeOf(E,f):(E.__proto__=f,l(E,u,"GeneratorFunction")),E.prototype=Object.create(ee),E},r.awrap=function(E){return{__await:E}},H(ue.prototype),ue.prototype[a]=function(){return this},r.AsyncIterator=ue,r.async=function(E,b,O,N,T){T===void 0&&(T=Promise);var te=new ue(c(E,b,O,N),T);return r.isGeneratorFunction(b)?te:te.next().then(function(y){return y.done?y.value:te.next()})},H(ee),l(ee,u,"Generator"),ee[o]=function(){return this},ee.toString=function(){return"[object Generator]"},r.keys=function(E){var b=[];for(var O in E)b.push(O);return b.reverse(),function N(){for(;b.length;){var T=b.pop();if(T in E)return N.value=T,N.done=!1,N}return N.done=!0,N}},r.values=Ae,Re.prototype={constructor:Re,reset:function(E){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(Q),!E)for(var b in this)b.charAt(0)==="t"&&s.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=void 0)},stop:function(){this.done=!0;var E=this.tryEntries[0].completion;if(E.type==="throw")throw E.arg;return this.rval},dispatchException:function(E){if(this.done)throw E;var b=this;function O(_,C){return te.type="throw",te.arg=E,b.next=_,C&&(b.method="next",b.arg=void 0),!!C}for(var N=this.tryEntries.length-1;N>=0;--N){var T=this.tryEntries[N],te=T.completion;if(T.tryLoc==="root")return O("end");if(T.tryLoc<=this.prev){var y=s.call(T,"catchLoc"),m=s.call(T,"finallyLoc");if(y&&m){if(this.prev<T.catchLoc)return O(T.catchLoc,!0);if(this.prev<T.finallyLoc)return O(T.finallyLoc)}else if(y){if(this.prev<T.catchLoc)return O(T.catchLoc,!0)}else{if(!m)throw new Error("try statement without catch or finally");if(this.prev<T.finallyLoc)return O(T.finallyLoc)}}}},abrupt:function(E,b){for(var O=this.tryEntries.length-1;O>=0;--O){var N=this.tryEntries[O];if(N.tryLoc<=this.prev&&s.call(N,"finallyLoc")&&this.prev<N.finallyLoc){var T=N;break}}T&&(E==="break"||E==="continue")&&T.tryLoc<=b&&b<=T.finallyLoc&&(T=null);var te=T?T.completion:{};return te.type=E,te.arg=b,T?(this.method="next",this.next=T.finallyLoc,h):this.complete(te)},complete:function(E,b){if(E.type==="throw")throw E.arg;return E.type==="break"||E.type==="continue"?this.next=E.arg:E.type==="return"?(this.rval=this.arg=E.arg,this.method="return",this.next="end"):E.type==="normal"&&b&&(this.next=b),h},finish:function(E){for(var b=this.tryEntries.length-1;b>=0;--b){var O=this.tryEntries[b];if(O.finallyLoc===E)return this.complete(O.completion,O.afterLoc),Q(O),h}},catch:function(E){for(var b=this.tryEntries.length-1;b>=0;--b){var O=this.tryEntries[b];if(O.tryLoc===E){var N=O.completion;if(N.type==="throw"){var T=N.arg;Q(O)}return T}}throw new Error("illegal catch attempt")},delegateYield:function(E,b,O){return this.delegate={iterator:Ae(E),resultName:b,nextLoc:O},this.method==="next"&&(this.arg=void 0),h}},r}(e.exports);try{regeneratorRuntime=t}catch{Function("r","regeneratorRuntime = r")(t)}}(Md={exports:{}}),Md.exports),Xe=function e(t){return t!=null&&(Array.isArray(t)?t.filter(function(r){return e(r)}).length>0:typeof t=="object"?Object.keys(t).length>0:t!=null)},Bd=function(){var e=this;this.setCustomErrorMessage=function(t){e.customErrorMessage=t},this.setWhenCondition=function(t){e.whenCondition=t},this.setUnlessCondition=function(t){e.unlessCondition=t}},kd=function(e){function t(r){var n;return(n=e.call(this)||this).validateAsync=function(){var s=wt(ve.mark(function i(o,a){var u;return ve.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(n.whenCondition==null||n.whenCondition(a)){l.next=2;break}return l.abrupt("return",null);case 2:if(n.unlessCondition==null||!n.unlessCondition(a)){l.next=4;break}return l.abrupt("return",null);case 4:return l.next=6,n.asyncValueValidator(o,a);case 6:return l.abrupt("return",(u=l.sent)!=null?n.customErrorMessage||u:null);case 8:case"end":return l.stop()}},i)}));return function(i,o){return s.apply(this,arguments)}}(),n.asyncValueValidator=r,n}return B(t,e),t}(Bd),I0=function(e){function t(r){return e.call(this,function(){var n=wt(ve.mark(function s(i,o){var a,u,l,c,d;return ve.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!Array.isArray(r)){h.next=20;break}a=$e(r);case 2:if((u=a()).done){h.next=19;break}if(typeof(l=u.value)!="function"){h.next=12;break}return h.next=7,l(i,o);case 7:if(h.sent){h.next=10;break}return h.abrupt("return","Value is not valid");case 10:h.next=17;break;case 12:return h.next=14,l.predicate(i,o);case 14:if(h.sent){h.next=17;break}return h.abrupt("return",typeof l.message=="function"?l.message(i,o):l.message);case 17:h.next=2;break;case 19:return h.abrupt("return",null);case 20:if(typeof r!="function"){h.next=29;break}return h.next=23,r(i,o);case 23:if(!h.sent){h.next=27;break}h.t0=null,h.next=28;break;case 27:h.t0="Value is not valid";case 28:return h.abrupt("return",h.t0);case 29:return c=r.predicate,d=r.message,h.next=32,c(i,o);case 32:if(!h.sent){h.next=36;break}h.t1=null,h.next=37;break;case 36:h.t1=typeof d=="function"?d(i,o):d;case 37:return h.abrupt("return",h.t1);case 38:case"end":return h.stop()}},s)}));return function(s,i){return n.apply(this,arguments)}}())||this}return B(t,e),t}(kd),V0=function(e){function t(r){return e.call(this,function(){var n=wt(ve.mark(function s(i,o){return ve.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(i!=null){a.next=4;break}a.t0=Promise.resolve(null),a.next=7;break;case 4:return a.next=6,r(o).validateAsync(i);case 6:a.t0=a.sent;case 7:return a.abrupt("return",a.t0);case 8:case"end":return a.stop()}},s)}));return function(s,i){return n.apply(this,arguments)}}())||this}return B(t,e),t}(kd),ne=function(e){function t(r){var n;return(n=e.call(this)||this).validate=function(s,i){if(n.whenCondition!=null&&!n.whenCondition(i)||n.unlessCondition!=null&&n.unlessCondition(i))return null;var o=n.valueValidator(s,i);return o!=null?n.customErrorMessage||o:null},n.valueValidator=r,n}return B(t,e),t}(Bd),B0=/^[a-zA-Z0-9.!#$%&"*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)+$/,k0=function(e){function t(){return e.call(this,function(r){if(r==null)return null;if(typeof r!="string")throw new TypeError("A non-string value was passed to the emailAddress rule");return B0.test(r)?null:"Not a valid email address"})||this}return B(t,e),t}(ne),j0=function(e){function t(r){return e.call(this,function(n){return n===r?null:"Must equal '"+r+"'"})||this}return B(t,e),t}(ne),Te=function(e){return e.toLocaleString(void 0,{maximumFractionDigits:20})},L0=function(e){function t(r,n){return e.call(this,function(s){if(s==null)return null;if(typeof s!="number")throw new TypeError("A non-number value was passed to the exclusiveBetween rule");return s>r&&s<n?null:"Value must be between "+Te(r)+" and "+Te(n)+" (exclusive)"})||this}return B(t,e),t}(ne),F0=function(e){function t(r){return e.call(this,function(n){if(n==null)return null;if(typeof n!="number")throw new TypeError("A non-number value was passed to the greaterThanOrEqualTo rule");return n>=r?null:"Value must be greater than or equal to "+Te(r)})||this}return B(t,e),t}(ne),$0=function(e){function t(r){return e.call(this,function(n){if(n==null)return null;if(typeof n!="number")throw new TypeError("A non-number value was passed to the greaterThan rule");return n>r?null:"Value must be greater than "+Te(r)})||this}return B(t,e),t}(ne),U0=function(e){function t(r,n){return e.call(this,function(s){if(s==null)return null;if(typeof s!="number")throw new TypeError("A non-number value was passed to the inclusiveBetween rule");return s>=r&&s<=n?null:"Value must be between "+Te(r)+" and "+Te(n)+" (inclusive)"})||this}return B(t,e),t}(ne),W0=function(e){function t(r,n){return e.call(this,function(s){if(s==null)return null;if(typeof s!="string")throw new TypeError("A non-string value was passed to the length rule");return s.length>=r&&s.length<=n?null:"Value must be between "+Te(r)+" and "+Te(n)+" characters long"})||this}return B(t,e),t}(ne),G0=function(e){function t(r){return e.call(this,function(n){if(n==null)return null;if(typeof n!="number")throw new TypeError("A non-number value was passed to the lessThanOrEqualTo rule");return n<=r?null:"Value must be less than or equal to "+Te(r)})||this}return B(t,e),t}(ne),K0=function(e){function t(r){return e.call(this,function(n){if(n==null)return null;if(typeof n!="number")throw new TypeError("A non-number value was passed to the lessThan rule");return n<r?null:"Value must be less than "+Te(r)})||this}return B(t,e),t}(ne),z0=function(e){function t(r){return e.call(this,function(n){if(n==null)return null;if(typeof n!="string")throw new TypeError("A non-string value was passed to the matches rule");return r.test(n)?null:"Value does not match the required pattern"})||this}return B(t,e),t}(ne),Y0=function(e){function t(r){return e.call(this,function(n){if(n==null)return null;if(typeof n!="string")throw new TypeError("A non-string value was passed to the maxLength rule");return n.length<=r?null:"Value must be no more than "+Te(r)+" characters long"})||this}return B(t,e),t}(ne),J0=function(e){function t(r){return e.call(this,function(n){if(n==null)return null;if(typeof n!="string")throw new TypeError("A non-string value was passed to the minLength rule");return n.length>=r?null:"Value must be at least "+Te(r)+" characters long"})||this}return B(t,e),t}(ne),Q0=function(e){function t(r){return e.call(this,function(n,s){if(Array.isArray(r)){for(var i,o=$e(r);!(i=o()).done;){var a=i.value;if(typeof a=="function"){if(!a(n,s))return"Value is not valid"}else if(!a.predicate(n,s))return typeof a.message=="function"?a.message(n,s):a.message}return null}if(typeof r=="function")return r(n,s)?null:"Value is not valid";var u=r.message;return(0,r.predicate)(n,s)?null:typeof u=="function"?u(n,s):u})||this}return B(t,e),t}(ne),X0=function(e){function t(){return e.call(this,function(r){if(typeof r!="string"){if(r==null)return null;throw new TypeError("A non-string value was passed to the notEmpty rule")}return r.trim().length>0?null:"Value cannot be empty"})||this}return B(t,e),t}(ne),Z0=function(e){function t(r){return e.call(this,function(n){return n!==r?null:"Must not equal '"+r+"'"})||this}return B(t,e),t}(ne),e_=function(e){function t(){return e.call(this,function(r){return r!=null?null:"Value cannot be null"})||this}return B(t,e),t}(ne),t_=function(e){function t(){return e.call(this,function(r){return r==null?null:"Value must be null"})||this}return B(t,e),t}(ne),r_=function(e){function t(r,n){return e.call(this,function(s){if(s==null)return null;if(typeof s!="number")throw new TypeError("A non-number value was passed to the scalePrecision rule");return n_(n,r).test(s.toString())?null:"Value must not be more than "+n+" digits in total, with allowance for "+r+" decimals"})||this}return B(t,e),t}(ne),n_=function(e,t){return new RegExp("^(-)?([0-9]){0,"+(e-t)+"}(\\.[0-9]{0,"+t+"})?$")},s_=function(e){function t(r){return e.call(this,function(n,s){return n==null?null:r(s).validate(n)})||this}return B(t,e),t}(ne),jd=function(e,t){var r=this;this.rules=[],this.pushRule=function(n){r.rules.push({isAsync:!1,rule:n}),r.rebuildValidate()},this.pushAsyncRule=function(n){r.rules.push({isAsync:!0,rule:n}),r.rebuildValidate()},this.withMessage=function(n){return r.getLatestRule().rule.setCustomErrorMessage(n),r.rebuildValidate(),$r({},r.getAllRules(),{when:r.when,unless:r.unless})},this.when=function(n,s){if(s===void 0&&(s="AppliesToAllValidators"),s==="AppliesToAllValidators")for(var i,o=$e(r.rules);!(i=o()).done;)i.value.rule.setWhenCondition(n);else r.getLatestRule().rule.setWhenCondition(n);return r.rebuildValidate(),r.getAllRules()},this.unless=function(n,s){if(s===void 0&&(s="AppliesToAllValidators"),s==="AppliesToAllValidators")for(var i,o=$e(r.rules);!(i=o()).done;)i.value.rule.setUnlessCondition(n);else r.getLatestRule().rule.setUnlessCondition(n);return r.rebuildValidate(),r.getAllRules()},this.notEqual=function(n){var s=new Z0(n);return r.pushRule(s),r.getAllRulesAndExtensions()},this.equal=function(n){var s=new j0(n);return r.pushRule(s),r.getAllRulesAndExtensions()},this.must=function(n){var s=new Q0(n);return r.pushRule(s),r.getAllRulesAndExtensions()},this.notNull=function(){var n=new e_;return r.pushRule(n),r.getAllRulesAndExtensions()},this.null=function(){var n=new t_;return r.pushRule(n),r.getAllRulesAndExtensions()},this.notEmpty=function(){var n=new X0;return r.pushRule(n),r.getAllRulesAndExtensions()},this.length=function(n,s){var i=new W0(n,s);return r.pushRule(i),r.getAllRulesAndExtensions()},this.maxLength=function(n){var s=new Y0(n);return r.pushRule(s),r.getAllRulesAndExtensions()},this.minLength=function(n){var s=new J0(n);return r.pushRule(s),r.getAllRulesAndExtensions()},this.matches=function(n){var s=new z0(n);return r.pushRule(s),r.getAllRulesAndExtensions()},this.emailAddress=function(){var n=new k0;return r.pushRule(n),r.getAllRulesAndExtensions()},this.lessThan=function(n){var s=new K0(n);return r.pushRule(s),r.getAllRulesAndExtensions()},this.lessThanOrEqualTo=function(n){var s=new G0(n);return r.pushRule(s),r.getAllRulesAndExtensions()},this.greaterThan=function(n){var s=new $0(n);return r.pushRule(s),r.getAllRulesAndExtensions()},this.greaterThanOrEqualTo=function(n){var s=new F0(n);return r.pushRule(s),r.getAllRulesAndExtensions()},this.exclusiveBetween=function(n,s){var i=new L0(n,s);return r.pushRule(i),r.getAllRulesAndExtensions()},this.inclusiveBetween=function(n,s){var i=new U0(n,s);return r.pushRule(i),r.getAllRulesAndExtensions()},this.setValidator=function(n){var s=new s_(n);return r.pushRule(s),r.getAllRulesAndExtensions()},this.scalePrecision=function(n,s){if(s-n<=0)throw new Error("Invalid scale and precision were passed to the scalePrecision rule");var i=new r_(n,s);return r.pushRule(i),r.getAllRulesAndExtensions()},this._getAllRules=function(){return{notEqual:r.notEqual,equal:r.equal,must:r.must,notNull:r.notNull,null:r.null,notEmpty:r.notEmpty,length:r.length,maxLength:r.maxLength,minLength:r.minLength,matches:r.matches,emailAddress:r.emailAddress,lessThan:r.lessThan,lessThanOrEqualTo:r.lessThanOrEqualTo,greaterThan:r.greaterThan,greaterThanOrEqualTo:r.greaterThanOrEqualTo,exclusiveBetween:r.exclusiveBetween,inclusiveBetween:r.inclusiveBetween,setValidator:r.setValidator,scalePrecision:r.scalePrecision}},this.getAllRules=function(){throw new Error("getAllRules on CoreValueValidatorBuilder is an abstract method and should never be called")},this.getAllRulesAndExtensions=function(){return $r({},r.getAllRules(),{withMessage:r.withMessage,when:r.when,unless:r.unless})},this.getLatestRule=function(){return r.rules[r.rules.length-1]},this.rebuildValidate=e,this.transformValue=t},co=function(e){function t(r,n){var s;return(s=e.call(this,r,n)||this).build=function(){return function(){var i=wt(ve.mark(function o(a,u){var l,c,d,h,g;return ve.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:l=s.transformValue(a),c=$e(s.rules);case 2:if((d=c()).done){v.next=16;break}if(!(h=d.value).isAsync){v.next=10;break}return v.next=7,h.rule.validateAsync(l,u);case 7:v.t0=v.sent,v.next=11;break;case 10:v.t0=h.rule.validate(l,u);case 11:if(!Xe(g=v.t0)){v.next=14;break}return v.abrupt("return",g);case 14:v.next=2;break;case 16:return v.abrupt("return",null);case 17:case"end":return v.stop()}},o)}));return function(o,a){return i.apply(this,arguments)}}()},s.mustAsync=function(i){var o=new I0(i);return s.pushAsyncRule(o),s.getAllRulesAndExtensions()},s.setAsyncValidator=function(i){var o=new V0(i);return s.pushAsyncRule(o),s.getAllRulesAndExtensions()},s.getAllRules=function(){return $r({},s._getAllRules(),{mustAsync:s.mustAsync,setAsyncValidator:s.setAsyncValidator})},s}return B(t,e),t}(jd),Id=function(e,t,r){var n=this;this.build=function(){return function(){var s=wt(ve.mark(function i(o,a){var u,l,c,d,h,g,v;return ve.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(a[n.propertyName]!=null){f.next=2;break}return f.abrupt("return",null);case 2:u=n.eachAsyncValueValidatorBuilder.build(),l=[],c=$e(o);case 5:if((d=c()).done){f.next=14;break}return h=d.value,f.next=9,u(h,a);case 9:v=Xe(g=f.sent)?g:null,l.push(v);case 12:f.next=5;break;case 14:return f.abrupt("return",Xe(l)?l:null);case 15:case"end":return f.stop()}},i)}));return function(i,o){return s.apply(this,arguments)}}()},this.getAllRules=function(){return n.eachAsyncValueValidatorBuilder.getAllRules()},this.eachAsyncValueValidatorBuilder=new co(e,r),this.propertyName=t},ho=function(e){function t(r,n){var s;return(s=e.call(this,r,n)||this).build=function(){return function(i,o){for(var a,u=s.transformValue(i),l=$e(s.rules);!(a=l()).done;){var c=a.value.rule.validate(u,o);if(Xe(c))return c}return null}},s.getAllRules=function(){return $r({},s._getAllRules())},s}return B(t,e),t}(jd),Vd=function(e,t,r){var n=this;this.build=function(){return function(s,i){if(s==null||i[n.propertyName]==null)return null;var o=n.eachValueValidatorBuilder.build(),a=s.map(function(u){var l=o(u,i);return Xe(l)?l:null});return Xe(a)?a:null}},this.getAllRules=function(){return n.eachValueValidatorBuilder.getAllRules()},this.eachValueValidatorBuilder=new ho(e,r),this.propertyName=t},Ld=function(e){var t=this;this.valueValidatorBuildersByPropertyName={},this.asyncValueValidatorBuildersByPropertyName={},this._validate=function(){return{}},this._validateAsync=wt(ve.mark(function r(){return ve.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Promise.resolve({}));case 1:case"end":return n.stop()}},r)})),this.rebuildValidate=function(){t._validate=function(r){for(var n={},s=0,i=Object.keys(t.valueValidatorBuildersByPropertyName);s<i.length;s++)for(var o,a=i[s],u=$e(t.valueValidatorBuildersByPropertyName[a]);!(o=u()).done;){var l=o.value.build()(r[a],r);Xe(l)&&(n[a]=l)}return n}},this.rebuildValidateAsync=function(){t._validateAsync=function(){var r=wt(ve.mark(function n(s){var i,o,a,u,l,c,d,h;return ve.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:i={},o=0,a=Object.keys(t.asyncValueValidatorBuildersByPropertyName);case 2:if(!(o<a.length)){g.next=18;break}l=$e(t.asyncValueValidatorBuildersByPropertyName[u=a[o]]);case 6:if((c=l()).done){g.next=15;break}return d=c.value.build(),g.next=11,d(s[u],s);case 11:Xe(h=g.sent)&&(i[u]=h);case 13:g.next=6;break;case 15:o++,g.next=2;break;case 18:return g.abrupt("return",i);case 19:case"end":return g.stop()}},n)}));return function(n){return r.apply(this,arguments)}}()},this.ruleFor=function(r){if(t._isAsync){var n=new co(t.rebuildValidateAsync,function(i){return i});return t.asyncValueValidatorBuildersByPropertyName[r]=t.asyncValueValidatorBuildersByPropertyName[r]||[],t.asyncValueValidatorBuildersByPropertyName[r].push(n),n.getAllRules()}var s=new ho(t.rebuildValidate,function(i){return i});return t.valueValidatorBuildersByPropertyName[r]=t.valueValidatorBuildersByPropertyName[r]||[],t.valueValidatorBuildersByPropertyName[r].push(s),s.getAllRules()},this.ruleForTransformed=function(r,n){if(t._isAsync){var s=new co(t.rebuildValidateAsync,n);return t.asyncValueValidatorBuildersByPropertyName[r]=t.asyncValueValidatorBuildersByPropertyName[r]||[],t.asyncValueValidatorBuildersByPropertyName[r].push(s),s.getAllRules()}var i=new ho(t.rebuildValidate,n);return t.valueValidatorBuildersByPropertyName[r]=t.valueValidatorBuildersByPropertyName[r]||[],t.valueValidatorBuildersByPropertyName[r].push(i),i.getAllRules()},this.ruleForEach=function(r){if(t._isAsync){var n=new Id(t.rebuildValidateAsync,r,function(i){return i});return t.asyncValueValidatorBuildersByPropertyName[r]==null&&(t.asyncValueValidatorBuildersByPropertyName[r]=[]),t.asyncValueValidatorBuildersByPropertyName[r].push(n),n.getAllRules()}var s=new Vd(t.rebuildValidate,r,function(i){return i});return t.valueValidatorBuildersByPropertyName[r]==null&&(t.valueValidatorBuildersByPropertyName[r]=[]),t.valueValidatorBuildersByPropertyName[r].push(s),s.getAllRules()},this.ruleForEachTransformed=function(r,n){if(t._isAsync){var s=new Id(t.rebuildValidateAsync,r,n);return t.asyncValueValidatorBuildersByPropertyName[r]==null&&(t.asyncValueValidatorBuildersByPropertyName[r]=[]),t.asyncValueValidatorBuildersByPropertyName[r].push(s),s.getAllRules()}var i=new Vd(t.rebuildValidate,r,n);return t.valueValidatorBuildersByPropertyName[r]==null&&(t.valueValidatorBuildersByPropertyName[r]=[]),t.valueValidatorBuildersByPropertyName[r].push(i),i.getAllRules()},this._isAsync=e},i_=function(e){function t(){var r;return(r=e.call(this,!1)||this).validate=function(n){return r._validate(n)},r}return B(t,e),t}(Ld);as.AsyncValidator=function(e){function t(){var r;return(r=e.call(this,!0)||this).validateAsync=function(n){return r._validateAsync(n)},r}return B(t,e),t}(Ld),as.Validator=i_});var Qd=p(us=>{"use strict";Object.defineProperty(us,"__esModule",{value:!0});function $d(e,t,r,n,s,i,o){try{var a=e[i](o),u=a.value}catch(l){r(l);return}a.done?t(u):Promise.resolve(u).then(n,s)}function Rt(e){return function(){var t=this,r=arguments;return new Promise(function(n,s){var i=e.apply(t,r);function o(u){$d(i,n,s,o,a,"next",u)}function a(u){$d(i,n,s,o,a,"throw",u)}o(void 0)})}}function Zt(){return Zt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zt.apply(this,arguments)}function k(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,fo(e,t)}function fo(e,t){return fo=Object.setPrototypeOf||function(n,s){return n.__proto__=s,n},fo(e,t)}function o_(e,t){if(!!e){if(typeof e=="string")return Ud(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ud(e,t)}}function Ud(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ue(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=o_(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a_(e,t){return t={exports:{}},e(t,t.exports),t.exports}var ye=a_(function(e){var t=function(r){var n=Object.prototype,s=n.hasOwnProperty,i,o=typeof Symbol=="function"?Symbol:{},a=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(y,m,_){return Object.defineProperty(y,m,{value:_,enumerable:!0,configurable:!0,writable:!0}),y[m]}try{c({},"")}catch{c=function(m,_,C){return m[_]=C}}function d(y,m,_,C){var S=m&&m.prototype instanceof $?m:$,V=Object.create(S.prototype),K=new N(C||[]);return V._invoke=vs(y,_,K),V}r.wrap=d;function h(y,m,_){try{return{type:"normal",arg:y.call(m,_)}}catch(C){return{type:"throw",arg:C}}}var g="suspendedStart",v="suspendedYield",f="executing",w="completed",R={};function $(){}function ee(){}function H(){}var ue={};ue[a]=function(){return this};var U=Object.getPrototypeOf,de=U&&U(U(T([])));de&&de!==n&&s.call(de,a)&&(ue=de);var Q=H.prototype=$.prototype=Object.create(ue);ee.prototype=Q.constructor=H,H.constructor=ee,ee.displayName=c(H,l,"GeneratorFunction");function Re(y){["next","throw","return"].forEach(function(m){c(y,m,function(_){return this._invoke(m,_)})})}r.isGeneratorFunction=function(y){var m=typeof y=="function"&&y.constructor;return m?m===ee||(m.displayName||m.name)==="GeneratorFunction":!1},r.mark=function(y){return Object.setPrototypeOf?Object.setPrototypeOf(y,H):(y.__proto__=H,c(y,l,"GeneratorFunction")),y.prototype=Object.create(Q),y},r.awrap=function(y){return{__await:y}};function Ae(y,m){function _(V,K,z,Y){var Z=h(y[V],y,K);if(Z.type==="throw")Y(Z.arg);else{var Oe=Z.arg,ir=Oe.value;return ir&&typeof ir=="object"&&s.call(ir,"__await")?m.resolve(ir.__await).then(function(rt){_("next",rt,z,Y)},function(rt){_("throw",rt,z,Y)}):m.resolve(ir).then(function(rt){Oe.value=rt,z(Oe)},function(rt){return _("throw",rt,z,Y)})}}var C;function S(V,K){function z(){return new m(function(Y,Z){_(V,K,Y,Z)})}return C=C?C.then(z,z):z()}this._invoke=S}Re(Ae.prototype),Ae.prototype[u]=function(){return this},r.AsyncIterator=Ae,r.async=function(y,m,_,C,S){S===void 0&&(S=Promise);var V=new Ae(d(y,m,_,C),S);return r.isGeneratorFunction(m)?V:V.next().then(function(K){return K.done?K.value:V.next()})};function vs(y,m,_){var C=g;return function(V,K){if(C===f)throw new Error("Generator is already running");if(C===w){if(V==="throw")throw K;return te()}for(_.method=V,_.arg=K;;){var z=_.delegate;if(z){var Y=E(z,_);if(Y){if(Y===R)continue;return Y}}if(_.method==="next")_.sent=_._sent=_.arg;else if(_.method==="throw"){if(C===g)throw C=w,_.arg;_.dispatchException(_.arg)}else _.method==="return"&&_.abrupt("return",_.arg);C=f;var Z=h(y,m,_);if(Z.type==="normal"){if(C=_.done?w:v,Z.arg===R)continue;return{value:Z.arg,done:_.done}}else Z.type==="throw"&&(C=w,_.method="throw",_.arg=Z.arg)}}}function E(y,m){var _=y.iterator[m.method];if(_===i){if(m.delegate=null,m.method==="throw"){if(y.iterator.return&&(m.method="return",m.arg=i,E(y,m),m.method==="throw"))return R;m.method="throw",m.arg=new TypeError("The iterator does not provide a 'throw' method")}return R}var C=h(_,y.iterator,m.arg);if(C.type==="throw")return m.method="throw",m.arg=C.arg,m.delegate=null,R;var S=C.arg;if(!S)return m.method="throw",m.arg=new TypeError("iterator result is not an object"),m.delegate=null,R;if(S.done)m[y.resultName]=S.value,m.next=y.nextLoc,m.method!=="return"&&(m.method="next",m.arg=i);else return S;return m.delegate=null,R}Re(Q),c(Q,l,"Generator"),Q[a]=function(){return this},Q.toString=function(){return"[object Generator]"};function b(y){var m={tryLoc:y[0]};1 in y&&(m.catchLoc=y[1]),2 in y&&(m.finallyLoc=y[2],m.afterLoc=y[3]),this.tryEntries.push(m)}function O(y){var m=y.completion||{};m.type="normal",delete m.arg,y.completion=m}function N(y){this.tryEntries=[{tryLoc:"root"}],y.forEach(b,this),this.reset(!0)}r.keys=function(y){var m=[];for(var _ in y)m.push(_);return m.reverse(),function C(){for(;m.length;){var S=m.pop();if(S in y)return C.value=S,C.done=!1,C}return C.done=!0,C}};function T(y){if(y){var m=y[a];if(m)return m.call(y);if(typeof y.next=="function")return y;if(!isNaN(y.length)){var _=-1,C=function S(){for(;++_<y.length;)if(s.call(y,_))return S.value=y[_],S.done=!1,S;return S.value=i,S.done=!0,S};return C.next=C}}return{next:te}}r.values=T;function te(){return{value:i,done:!0}}return N.prototype={constructor:N,reset:function(y){if(this.prev=0,this.next=0,this.sent=this._sent=i,this.done=!1,this.delegate=null,this.method="next",this.arg=i,this.tryEntries.forEach(O),!y)for(var m in this)m.charAt(0)==="t"&&s.call(this,m)&&!isNaN(+m.slice(1))&&(this[m]=i)},stop:function(){this.done=!0;var y=this.tryEntries[0],m=y.completion;if(m.type==="throw")throw m.arg;return this.rval},dispatchException:function(y){if(this.done)throw y;var m=this;function _(Y,Z){return V.type="throw",V.arg=y,m.next=Y,Z&&(m.method="next",m.arg=i),!!Z}for(var C=this.tryEntries.length-1;C>=0;--C){var S=this.tryEntries[C],V=S.completion;if(S.tryLoc==="root")return _("end");if(S.tryLoc<=this.prev){var K=s.call(S,"catchLoc"),z=s.call(S,"finallyLoc");if(K&&z){if(this.prev<S.catchLoc)return _(S.catchLoc,!0);if(this.prev<S.finallyLoc)return _(S.finallyLoc)}else if(K){if(this.prev<S.catchLoc)return _(S.catchLoc,!0)}else if(z){if(this.prev<S.finallyLoc)return _(S.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(y,m){for(var _=this.tryEntries.length-1;_>=0;--_){var C=this.tryEntries[_];if(C.tryLoc<=this.prev&&s.call(C,"finallyLoc")&&this.prev<C.finallyLoc){var S=C;break}}S&&(y==="break"||y==="continue")&&S.tryLoc<=m&&m<=S.finallyLoc&&(S=null);var V=S?S.completion:{};return V.type=y,V.arg=m,S?(this.method="next",this.next=S.finallyLoc,R):this.complete(V)},complete:function(y,m){if(y.type==="throw")throw y.arg;return y.type==="break"||y.type==="continue"?this.next=y.arg:y.type==="return"?(this.rval=this.arg=y.arg,this.method="return",this.next="end"):y.type==="normal"&&m&&(this.next=m),R},finish:function(y){for(var m=this.tryEntries.length-1;m>=0;--m){var _=this.tryEntries[m];if(_.finallyLoc===y)return this.complete(_.completion,_.afterLoc),O(_),R}},catch:function(y){for(var m=this.tryEntries.length-1;m>=0;--m){var _=this.tryEntries[m];if(_.tryLoc===y){var C=_.completion;if(C.type==="throw"){var S=C.arg;O(_)}return S}}throw new Error("illegal catch attempt")},delegateYield:function(y,m,_){return this.delegate={iterator:T(y),resultName:m,nextLoc:_},this.method==="next"&&(this.arg=i),R}},r}(e.exports);try{regeneratorRuntime=t}catch{Function("r","regeneratorRuntime = r")(t)}}),Ze=function e(t){return t==null?!1:Array.isArray(t)?t.filter(function(r){return e(r)}).length>0:typeof t=="object"?Object.keys(t).length>0:t!=null},Kd=function(){var t=this;this.setCustomErrorMessage=function(r){t.customErrorMessage=r},this.setWhenCondition=function(r){t.whenCondition=r},this.setUnlessCondition=function(r){t.unlessCondition=r}},zd=function(e){k(t,e);function t(r){var n;return n=e.call(this)||this,n.validateAsync=function(){var s=Rt(ye.mark(function i(o,a){var u;return ye.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!(n.whenCondition!=null&&!n.whenCondition(a))){c.next=2;break}return c.abrupt("return",null);case 2:if(!(n.unlessCondition!=null&&n.unlessCondition(a))){c.next=4;break}return c.abrupt("return",null);case 4:return c.next=6,n.asyncValueValidator(o,a);case 6:return u=c.sent,c.abrupt("return",u!=null?n.customErrorMessage||u:null);case 8:case"end":return c.stop()}},i)}));return function(i,o){return s.apply(this,arguments)}}(),n.asyncValueValidator=r,n}return t}(Kd),u_=function(e){k(t,e);function t(r){return e.call(this,function(){var n=Rt(ye.mark(function s(i,o){var a,u,l,c,d,h,g;return ye.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!Array.isArray(r)){f.next=20;break}a=Ue(r);case 2:if((u=a()).done){f.next=19;break}if(l=u.value,typeof l!="function"){f.next=12;break}return f.next=7,l(i,o);case 7:if(c=f.sent,c){f.next=10;break}return f.abrupt("return","Value is not valid");case 10:f.next=17;break;case 12:return f.next=14,l.predicate(i,o);case 14:if(d=f.sent,d){f.next=17;break}return f.abrupt("return",typeof l.message=="function"?l.message(i,o):l.message);case 17:f.next=2;break;case 19:return f.abrupt("return",null);case 20:if(typeof r!="function"){f.next=29;break}return f.next=23,r(i,o);case 23:if(!f.sent){f.next=27;break}f.t0=null,f.next=28;break;case 27:f.t0="Value is not valid";case 28:return f.abrupt("return",f.t0);case 29:return h=r.predicate,g=r.message,f.next=32,h(i,o);case 32:if(!f.sent){f.next=36;break}f.t1=null,f.next=37;break;case 36:f.t1=typeof g=="function"?g(i,o):g;case 37:return f.abrupt("return",f.t1);case 38:case"end":return f.stop()}},s)}));return function(s,i){return n.apply(this,arguments)}}())||this}return t}(zd),l_=function(e){k(t,e);function t(r){return e.call(this,function(){var n=Rt(ye.mark(function s(i,o){return ye.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(i!=null){u.next=4;break}u.t0=Promise.resolve(null),u.next=7;break;case 4:return u.next=6,r(o).validateAsync(i);case 6:u.t0=u.sent;case 7:return u.abrupt("return",u.t0);case 8:case"end":return u.stop()}},s)}));return function(s,i){return n.apply(this,arguments)}}())||this}return t}(zd),se=function(e){k(t,e);function t(r){var n;return n=e.call(this)||this,n.validate=function(s,i){if(n.whenCondition!=null&&!n.whenCondition(i)||n.unlessCondition!=null&&n.unlessCondition(i))return null;var o=n.valueValidator(s,i);return o!=null?n.customErrorMessage||o:null},n.valueValidator=r,n}return t}(Kd),c_=/^[a-zA-Z0-9.!#$%&"*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)+$/,d_=function(e){k(t,e);function t(){return e.call(this,function(r){if(r==null)return null;if(typeof r!="string")throw new TypeError("A non-string value was passed to the emailAddress rule");return c_.test(r)?null:"Not a valid email address"})||this}return t}(se),h_=function(e){k(t,e);function t(r){return e.call(this,function(n){return n===r?null:"Must equal '"+r+"'"})||this}return t}(se),xe=function(t){return t.toLocaleString(void 0,{maximumFractionDigits:20})},f_=function(e){k(t,e);function t(r,n){return e.call(this,function(s){if(s==null)return null;if(typeof s!="number")throw new TypeError("A non-number value was passed to the exclusiveBetween rule");return s>r&&s<n?null:"Value must be between "+xe(r)+" and "+xe(n)+" (exclusive)"})||this}return t}(se),p_=function(e){k(t,e);function t(r){return e.call(this,function(n){if(n==null)return null;if(typeof n!="number")throw new TypeError("A non-number value was passed to the greaterThanOrEqualTo rule");return n>=r?null:"Value must be greater than or equal to "+xe(r)})||this}return t}(se),g_=function(e){k(t,e);function t(r){return e.call(this,function(n){if(n==null)return null;if(typeof n!="number")throw new TypeError("A non-number value was passed to the greaterThan rule");return n>r?null:"Value must be greater than "+xe(r)})||this}return t}(se),m_=function(e){k(t,e);function t(r,n){return e.call(this,function(s){if(s==null)return null;if(typeof s!="number")throw new TypeError("A non-number value was passed to the inclusiveBetween rule");return s>=r&&s<=n?null:"Value must be between "+xe(r)+" and "+xe(n)+" (inclusive)"})||this}return t}(se),v_=function(e){k(t,e);function t(r,n){return e.call(this,function(s){if(s==null)return null;if(typeof s!="string")throw new TypeError("A non-string value was passed to the length rule");return s.length>=r&&s.length<=n?null:"Value must be between "+xe(r)+" and "+xe(n)+" characters long"})||this}return t}(se),y_=function(e){k(t,e);function t(r){return e.call(this,function(n){if(n==null)return null;if(typeof n!="number")throw new TypeError("A non-number value was passed to the lessThanOrEqualTo rule");return n<=r?null:"Value must be less than or equal to "+xe(r)})||this}return t}(se),__=function(e){k(t,e);function t(r){return e.call(this,function(n){if(n==null)return null;if(typeof n!="number")throw new TypeError("A non-number value was passed to the lessThan rule");return n<r?null:"Value must be less than "+xe(r)})||this}return t}(se),b_=function(e){k(t,e);function t(r){return e.call(this,function(n){if(n==null)return null;if(typeof n!="string")throw new TypeError("A non-string value was passed to the matches rule");return r.test(n)?null:"Value does not match the required pattern"})||this}return t}(se),E_=function(e){k(t,e);function t(r){return e.call(this,function(n){if(n==null)return null;if(typeof n!="string")throw new TypeError("A non-string value was passed to the maxLength rule");return n.length<=r?null:"Value must be no more than "+xe(r)+" characters long"})||this}return t}(se),w_=function(e){k(t,e);function t(r){return e.call(this,function(n){if(n==null)return null;if(typeof n!="string")throw new TypeError("A non-string value was passed to the minLength rule");return n.length>=r?null:"Value must be at least "+xe(r)+" characters long"})||this}return t}(se),R_=function(e){k(t,e);function t(r){return e.call(this,function(n,s){if(Array.isArray(r)){for(var i=Ue(r),o;!(o=i()).done;){var a=o.value;if(typeof a=="function"){var u=a(n,s);if(!u)return"Value is not valid"}else{var l=a.predicate(n,s);if(!l)return typeof a.message=="function"?a.message(n,s):a.message}}return null}if(typeof r=="function")return r(n,s)?null:"Value is not valid";var c=r.predicate,d=r.message;return c(n,s)?null:typeof d=="function"?d(n,s):d})||this}return t}(se),A_=function(e){k(t,e);function t(){return e.call(this,function(r){if(typeof r!="string"){if(r==null)return null;throw new TypeError("A non-string value was passed to the notEmpty rule")}return r.trim().length>0?null:"Value cannot be empty"})||this}return t}(se),C_=function(e){k(t,e);function t(r){return e.call(this,function(n){return n!==r?null:"Must not equal '"+r+"'"})||this}return t}(se),S_=function(e){k(t,e);function t(){return e.call(this,function(r){return r!=null?null:"Value cannot be null"})||this}return t}(se),T_=function(e){k(t,e);function t(){return e.call(this,function(r){return r==null?null:"Value must be null"})||this}return t}(se),x_=function(e){k(t,e);function t(r,n){return e.call(this,function(s){if(s==null)return null;if(typeof s!="number")throw new TypeError("A non-number value was passed to the scalePrecision rule");var i=O_(n,r);return i.test(s.toString())?null:"Value must not be more than "+n+" digits in total, with allowance for "+r+" decimals"})||this}return t}(se),O_=function(t,r){return new RegExp("^(-)?([0-9]){0,"+(t-r)+"}(\\.[0-9]{0,"+r+"})?$")},P_=function(e){k(t,e);function t(r){return e.call(this,function(n,s){return n==null?null:r(s).validate(n)})||this}return t}(se),Yd=function(t,r){var n=this;this.rules=[],this.pushRule=function(s){n.rules.push({isAsync:!1,rule:s}),n.rebuildValidate()},this.pushAsyncRule=function(s){n.rules.push({isAsync:!0,rule:s}),n.rebuildValidate()},this.withMessage=function(s){var i=n.getLatestRule();return i.rule.setCustomErrorMessage(s),n.rebuildValidate(),Zt({},n.getAllRules(),{when:n.when,unless:n.unless})},this.when=function(s,i){if(i===void 0&&(i="AppliesToAllValidators"),i==="AppliesToAllValidators")for(var o=Ue(n.rules),a;!(a=o()).done;){var u=a.value;u.rule.setWhenCondition(s)}else{var l=n.getLatestRule();l.rule.setWhenCondition(s)}return n.rebuildValidate(),n.getAllRules()},this.unless=function(s,i){if(i===void 0&&(i="AppliesToAllValidators"),i==="AppliesToAllValidators")for(var o=Ue(n.rules),a;!(a=o()).done;){var u=a.value;u.rule.setUnlessCondition(s)}else{var l=n.getLatestRule();l.rule.setUnlessCondition(s)}return n.rebuildValidate(),n.getAllRules()},this.notEqual=function(s){var i=new C_(s);return n.pushRule(i),n.getAllRulesAndExtensions()},this.equal=function(s){var i=new h_(s);return n.pushRule(i),n.getAllRulesAndExtensions()},this.must=function(s){var i=new R_(s);return n.pushRule(i),n.getAllRulesAndExtensions()},this.notNull=function(){var s=new S_;return n.pushRule(s),n.getAllRulesAndExtensions()},this.null=function(){var s=new T_;return n.pushRule(s),n.getAllRulesAndExtensions()},this.notEmpty=function(){var s=new A_;return n.pushRule(s),n.getAllRulesAndExtensions()},this.length=function(s,i){var o=new v_(s,i);return n.pushRule(o),n.getAllRulesAndExtensions()},this.maxLength=function(s){var i=new E_(s);return n.pushRule(i),n.getAllRulesAndExtensions()},this.minLength=function(s){var i=new w_(s);return n.pushRule(i),n.getAllRulesAndExtensions()},this.matches=function(s){var i=new b_(s);return n.pushRule(i),n.getAllRulesAndExtensions()},this.emailAddress=function(){var s=new d_;return n.pushRule(s),n.getAllRulesAndExtensions()},this.lessThan=function(s){var i=new __(s);return n.pushRule(i),n.getAllRulesAndExtensions()},this.lessThanOrEqualTo=function(s){var i=new y_(s);return n.pushRule(i),n.getAllRulesAndExtensions()},this.greaterThan=function(s){var i=new g_(s);return n.pushRule(i),n.getAllRulesAndExtensions()},this.greaterThanOrEqualTo=function(s){var i=new p_(s);return n.pushRule(i),n.getAllRulesAndExtensions()},this.exclusiveBetween=function(s,i){var o=new f_(s,i);return n.pushRule(o),n.getAllRulesAndExtensions()},this.inclusiveBetween=function(s,i){var o=new m_(s,i);return n.pushRule(o),n.getAllRulesAndExtensions()},this.setValidator=function(s){var i=new P_(s);return n.pushRule(i),n.getAllRulesAndExtensions()},this.scalePrecision=function(s,i){if(i-s<=0)throw new Error("Invalid scale and precision were passed to the scalePrecision rule");var o=new x_(s,i);return n.pushRule(o),n.getAllRulesAndExtensions()},this._getAllRules=function(){return{notEqual:n.notEqual,equal:n.equal,must:n.must,notNull:n.notNull,null:n.null,notEmpty:n.notEmpty,length:n.length,maxLength:n.maxLength,minLength:n.minLength,matches:n.matches,emailAddress:n.emailAddress,lessThan:n.lessThan,lessThanOrEqualTo:n.lessThanOrEqualTo,greaterThan:n.greaterThan,greaterThanOrEqualTo:n.greaterThanOrEqualTo,exclusiveBetween:n.exclusiveBetween,inclusiveBetween:n.inclusiveBetween,setValidator:n.setValidator,scalePrecision:n.scalePrecision}},this.getAllRules=function(){throw new Error("getAllRules on CoreValueValidatorBuilder is an abstract method and should never be called")},this.getAllRulesAndExtensions=function(){return Zt({},n.getAllRules(),{withMessage:n.withMessage,when:n.when,unless:n.unless})},this.getLatestRule=function(){return n.rules[n.rules.length-1]},this.rebuildValidate=t,this.transformValue=r},po=function(e){k(t,e);function t(r,n){var s;return s=e.call(this,r,n)||this,s.build=function(){return function(){var i=Rt(ye.mark(function o(a,u){var l,c,d,h,g;return ye.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:l=s.transformValue(a),c=Ue(s.rules);case 2:if((d=c()).done){f.next=16;break}if(h=d.value,!h.isAsync){f.next=10;break}return f.next=7,h.rule.validateAsync(l,u);case 7:f.t0=f.sent,f.next=11;break;case 10:f.t0=h.rule.validate(l,u);case 11:if(g=f.t0,!Ze(g)){f.next=14;break}return f.abrupt("return",g);case 14:f.next=2;break;case 16:return f.abrupt("return",null);case 17:case"end":return f.stop()}},o)}));return function(o,a){return i.apply(this,arguments)}}()},s.mustAsync=function(i){var o=new u_(i);return s.pushAsyncRule(o),s.getAllRulesAndExtensions()},s.setAsyncValidator=function(i){var o=new l_(i);return s.pushAsyncRule(o),s.getAllRulesAndExtensions()},s.getAllRules=function(){return Zt({},s._getAllRules(),{mustAsync:s.mustAsync,setAsyncValidator:s.setAsyncValidator})},s}return t}(Yd),Wd=function(t,r,n){var s=this;this.build=function(){return function(){var i=Rt(ye.mark(function o(a,u){var l,c,d,h,g,v,f;return ye.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(u[s.propertyName]!=null){R.next=2;break}return R.abrupt("return",null);case 2:l=s.eachAsyncValueValidatorBuilder.build(),c=[],d=Ue(a);case 5:if((h=d()).done){R.next=14;break}return g=h.value,R.next=9,l(g,u);case 9:v=R.sent,f=Ze(v)?v:null,c.push(f);case 12:R.next=5;break;case 14:return R.abrupt("return",Ze(c)?c:null);case 15:case"end":return R.stop()}},o)}));return function(o,a){return i.apply(this,arguments)}}()},this.getAllRules=function(){return s.eachAsyncValueValidatorBuilder.getAllRules()},this.eachAsyncValueValidatorBuilder=new po(t,n),this.propertyName=r},go=function(e){k(t,e);function t(r,n){var s;return s=e.call(this,r,n)||this,s.build=function(){return function(i,o){for(var a=s.transformValue(i),u=Ue(s.rules),l;!(l=u()).done;){var c=l.value,d=c.rule.validate(a,o);if(Ze(d))return d}return null}},s.getAllRules=function(){return Zt({},s._getAllRules())},s}return t}(Yd),Gd=function(t,r,n){var s=this;this.build=function(){return function(i,o){if(i==null||o[s.propertyName]==null)return null;var a=s.eachValueValidatorBuilder.build(),u=i.map(function(l){var c=a(l,o);return Ze(c)?c:null});return Ze(u)?u:null}},this.getAllRules=function(){return s.eachValueValidatorBuilder.getAllRules()},this.eachValueValidatorBuilder=new go(t,n),this.propertyName=r},Jd=function(t){var r=this;this.valueValidatorBuildersByPropertyName={},this.asyncValueValidatorBuildersByPropertyName={},this._validate=function(){return{}},this._validateAsync=Rt(ye.mark(function n(){return ye.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Promise.resolve({}));case 1:case"end":return i.stop()}},n)})),this.rebuildValidate=function(){r._validate=function(n){for(var s={},i=0,o=Object.keys(r.valueValidatorBuildersByPropertyName);i<o.length;i++)for(var a=o[i],u=r.valueValidatorBuildersByPropertyName[a],l=Ue(u),c;!(c=l()).done;){var d=c.value,h=d.build(),g=h(n[a],n);Ze(g)&&(s[a]=g)}return s}},this.rebuildValidateAsync=function(){r._validateAsync=function(){var n=Rt(ye.mark(function s(i){var o,a,u,l,c,d,h,g,v,f;return ye.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:o={},a=0,u=Object.keys(r.asyncValueValidatorBuildersByPropertyName);case 2:if(!(a<u.length)){R.next=18;break}l=u[a],c=r.asyncValueValidatorBuildersByPropertyName[l],d=Ue(c);case 6:if((h=d()).done){R.next=15;break}return g=h.value,v=g.build(),R.next=11,v(i[l],i);case 11:f=R.sent,Ze(f)&&(o[l]=f);case 13:R.next=6;break;case 15:a++,R.next=2;break;case 18:return R.abrupt("return",o);case 19:case"end":return R.stop()}},s)}));return function(s){return n.apply(this,arguments)}}()},this.ruleFor=function(n){if(r._isAsync){var s=new po(r.rebuildValidateAsync,function(o){return o});return r.asyncValueValidatorBuildersByPropertyName[n]=r.asyncValueValidatorBuildersByPropertyName[n]||[],r.asyncValueValidatorBuildersByPropertyName[n].push(s),s.getAllRules()}else{var i=new go(r.rebuildValidate,function(o){return o});return r.valueValidatorBuildersByPropertyName[n]=r.valueValidatorBuildersByPropertyName[n]||[],r.valueValidatorBuildersByPropertyName[n].push(i),i.getAllRules()}},this.ruleForTransformed=function(n,s){if(r._isAsync){var i=new po(r.rebuildValidateAsync,s);return r.asyncValueValidatorBuildersByPropertyName[n]=r.asyncValueValidatorBuildersByPropertyName[n]||[],r.asyncValueValidatorBuildersByPropertyName[n].push(i),i.getAllRules()}else{var o=new go(r.rebuildValidate,s);return r.valueValidatorBuildersByPropertyName[n]=r.valueValidatorBuildersByPropertyName[n]||[],r.valueValidatorBuildersByPropertyName[n].push(o),o.getAllRules()}},this.ruleForEach=function(n){if(r._isAsync){var s=new Wd(r.rebuildValidateAsync,n,function(o){return o});return r.asyncValueValidatorBuildersByPropertyName[n]==null&&(r.asyncValueValidatorBuildersByPropertyName[n]=[]),r.asyncValueValidatorBuildersByPropertyName[n].push(s),s.getAllRules()}else{var i=new Gd(r.rebuildValidate,n,function(o){return o});return r.valueValidatorBuildersByPropertyName[n]==null&&(r.valueValidatorBuildersByPropertyName[n]=[]),r.valueValidatorBuildersByPropertyName[n].push(i),i.getAllRules()}},this.ruleForEachTransformed=function(n,s){if(r._isAsync){var i=new Wd(r.rebuildValidateAsync,n,s);return r.asyncValueValidatorBuildersByPropertyName[n]==null&&(r.asyncValueValidatorBuildersByPropertyName[n]=[]),r.asyncValueValidatorBuildersByPropertyName[n].push(i),i.getAllRules()}else{var o=new Gd(r.rebuildValidate,n,s);return r.valueValidatorBuildersByPropertyName[n]==null&&(r.valueValidatorBuildersByPropertyName[n]=[]),r.valueValidatorBuildersByPropertyName[n].push(o),o.getAllRules()}},this._isAsync=t},H_=function(e){k(t,e);function t(){var r;return r=e.call(this,!1)||this,r.validate=function(n){return r._validate(n)},r}return t}(Jd),N_=function(e){k(t,e);function t(){var r;return r=e.call(this,!0)||this,r.validateAsync=function(n){return r._validateAsync(n)},r}return t}(Jd);us.AsyncValidator=N_;us.Validator=H_});var Xd=p(($w,mo)=>{"use strict";process.env.NODE_ENV==="production"?mo.exports=Fd():mo.exports=Qd()});var L=p(Ur=>{"use strict";var q_=Ur&&Ur.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ur,"__esModule",{value:!0});var vo=q_(lo()),D_=Xd(),yo=class extends D_.Validator{validateWithThrow(t,r,n=null){let s=this.validate(t);if(Object.keys(s).length>0){let i=JSON.stringify(s,null,4);throw n=n!=null&&n.includes("#")?n:`${n}#${r.toLowerCase()}`,new Error(vo.default.redBright(`
Given parameters for "${r}" are invalid.
`)+vo.default.yellowBright(n?`Learn more here: ${n}
`:"")+vo.default.redBright(`${i}
`))}}};Ur.BaseValidator=yo});var Zd=p(At=>{"use strict";Object.defineProperty(At,"__esModule",{value:!0});var _o=Ei();At.isProhibitedHeaderName=e=>_o.EDGIO_PROHIBITED_HEADER_NAMES.find(t=>e.match(t))!==void 0;At.isProhibitedCookieName=e=>_o.EDGIO_PROHIBITED_COOKIE_NAMES.find(t=>e.match(t))!==void 0&&_o.EDGIO_WHITELISTED_COOKIE_NAMES.find(t=>e.match(t))===void 0;At.isValidHeaderName=e=>At.isValidHeaderValue(e);At.isValidHeaderValue=e=>/^[\x20-\x7E]*$/.test(e)});var W=p(D=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});var ls=Zd();D.ofType=(e,t)=>typeof e===t;D.ofTypeWhenNotNull=(e,t)=>D.notNull(e)?D.ofType(e,t):!0;D.beBoolean={predicate:e=>D.ofType(e,"boolean"),message:"must be a boolean"};D.beBooleanWhenNotNull={predicate:e=>D.ofTypeWhenNotNull(e,"boolean"),message:"must be a boolean"};D.beString={predicate:e=>D.ofType(e,"string"),message:"must be a string"};D.beStringWhenNotNull={predicate:e=>D.ofTypeWhenNotNull(e,"string"),message:"must be a string"};D.beNumber={predicate:e=>D.ofType(e,"number"),message:"must be a number"};D.beNumberWhenNotNull={predicate:e=>D.ofTypeWhenNotNull(e,"number"),message:"must be a number"};D.beFunction={predicate:e=>D.ofType(e,"function"),message:"must be a function"};D.beFunctionWhenNotNull={predicate:e=>D.ofTypeWhenNotNull(e,"function"),message:"must be a function"};D.beObject={predicate:e=>D.ofType(e,"object"),message:"must be an object"};D.beObjectWhenNotNull={predicate:e=>D.ofTypeWhenNotNull(e,"object"),message:"must be an object"};D.beArrayWhenNotNull={predicate:e=>D.notNull(e)?Array.isArray(e):!0,message:"must be an array"};D.notBeProhibitedHeaderName={predicate:e=>!ls.isProhibitedHeaderName(e),message:"reserved header names cannot be specified"};D.notBeProhibitedCookieName={predicate:e=>!ls.isProhibitedCookieName(e),message:"reserved cookie names cannot be specified"};D.beValidHeaderName={predicate:e=>ls.isValidHeaderName(e),message:"must comply to RFC standard specification for header names (allowed characters: /^[a-zA-Z_-]*$/)"};D.beValidHeaderValue={predicate:e=>ls.isValidHeaderValue(e),message:"must comply to RFC standard specification for header values (allowed characters: /^[a-zA-Z:;.,\\/\"'?!(){}[]@<>=\\-+*#$&`|~^%]*$/"};D.notNull=e=>e!=null});var eh=p(Wr=>{"use strict";var M_=Wr&&Wr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Wr,"__esModule",{value:!0});var I_=M_(es()),Ro=L(),Ne=W(),bo=class extends Ro.BaseValidator{constructor(){super(),this.ruleFor("forcePrivateCaching").must(Ne.beBooleanWhenNotNull),this.ruleFor("maxAgeSeconds").must(Ne.beNumberWhenNotNull),this.ruleFor("staleWhileRevalidateSeconds").must(Ne.beNumberWhenNotNull)}},Eo=class extends Ro.BaseValidator{constructor(){super(),this.ruleFor("convertToGet").must(Ne.beBooleanWhenNotNull),this.ruleFor("spa").must(Ne.beBooleanWhenNotNull),this.ruleFor("maxAgeSeconds").must(Ne.beNumberWhenNotNull),this.ruleFor("serviceWorkerSeconds").must(Ne.beNumberWhenNotNull)}},wo=class extends Ro.BaseValidator{constructor(){super(),this.ruleFor("edge").must(t=>t===!1||typeof t=="object").withMessage("when defined must be false or EdgeCacheOptions").setValidator(()=>new bo).when(t=>Ne.notNull(t.edge)),this.ruleFor("browser").must(t=>t===!1||typeof t=="object").withMessage("when defined must be false or BrowserCacheOptions").setValidator(()=>new Eo).when(t=>Ne.notNull(t.browser)),this.ruleFor("prefetchUpstreamRequests").must(Ne.beBooleanWhenNotNull),this.ruleFor("key").must(t=>t instanceof I_.default).when(t=>Ne.notNull(t.key))}};Wr.CacheOptionsValidator=wo});var th=p(Co=>{"use strict";Object.defineProperty(Co,"__esModule",{value:!0});var V_=L(),er=W(),Ao=class extends V_.BaseValidator{constructor(){super(),this.ruleFor("domainOrIp").must(er.beStringWhenNotNull),this.ruleFor("hostHeader").must(er.beStringWhenNotNull),this.ruleFor("basePath").must(er.beStringWhenNotNull),this.ruleFor("port").must(er.beNumberWhenNotNull),this.ruleFor("disableCheckCert").must(er.beBooleanWhenNotNull),this.ruleFor("firstByteTimeout").must(er.beNumberWhenNotNull)}};Co.BackendOptionsValidator=Ao});var cs=p(To=>{"use strict";Object.defineProperty(To,"__esModule",{value:!0});var B_=L(),tr=W(),So=class extends B_.BaseValidator{constructor(){super(),this.ruleFor("headers").must(tr.beObjectWhenNotNull),this.ruleFor("path").must(t=>tr.beString.predicate(t)||tr.beFunction.predicate(t)).withMessage("must be non empty string or a function").must(t=>typeof t=="string"?t.length>0:!0).withMessage("must be non empty string").when(t=>tr.notNull(t.path)),this.ruleFor("transformRequest").must(tr.beFunctionWhenNotNull),this.ruleFor("transformResponse").must(tr.beFunctionWhenNotNull)}};To.ProxyOptionsValidator=So});var rh=p(Oo=>{"use strict";Object.defineProperty(Oo,"__esModule",{value:!0});var k_=th(),j_=L(),L_=cs(),xo=class extends j_.BaseValidator{constructor(){super(),this.ruleFor("backendConfig").setValidator(t=>new k_.BackendOptionsValidator),this.ruleFor("options").setValidator(t=>new L_.ProxyOptionsValidator)}};Oo.ProxyHostParamsValidator=xo});var nh=p(No=>{"use strict";Object.defineProperty(No,"__esModule",{value:!0});var F_=L(),Po=W(),$_=cs(),Ho=class extends F_.BaseValidator{constructor(){super(),this.ruleFor("backend").must(Po.beString).must(t=>t.length>0).withMessage("must be greater than 0"),this.ruleFor("options").must(Po.beObjectWhenNotNull).setValidator(()=>new $_.ProxyOptionsValidator).when(t=>Po.notNull(t.options))}};No.ProxyParamsValidator=Ho});var sh=p(Do=>{"use strict";Object.defineProperty(Do,"__esModule",{value:!0});var U_=L(),W_=W(),qo=class extends U_.BaseValidator{constructor(){super(),this.ruleFor("to").must(W_.beString).notEmpty().notNull().withMessage("must be non empty string value"),this.ruleFor("options").must(t=>typeof t=="number"||typeof t=="object").withMessage("must be number or object").must(t=>typeof t=="number"?t>0:!0).withMessage("must be greather than 0")}};Do.RedirectParamsValidator=qo});var ih=p(Io=>{"use strict";Object.defineProperty(Io,"__esModule",{value:!0});var G_=L(),K_=W(),Mo=class extends G_.BaseValidator{constructor(){super(),this.ruleFor("cb").must(K_.beFunction)}};Io.RenderParamsValidator=Mo});var ah=p(Bo=>{"use strict";Object.defineProperty(Bo,"__esModule",{value:!0});var z_=L(),oh=W(),Vo=class extends z_.BaseValidator{constructor(){super(),this.ruleFor("destination").must(oh.beString),this.ruleFor("pattern").must(oh.beString)}};Bo.RewriteParamsValidator=Vo});var lh=p(Lo=>{"use strict";Object.defineProperty(Lo,"__esModule",{value:!0});var uh=L(),Me=W(),ko=class extends uh.BaseValidator{constructor(){super(),this.ruleFor("onNotFound").must(Me.beFunctionWhenNotNull),this.ruleFor("loadingPage").must(Me.beStringWhenNotNull),this.ruleFor("expiresSeconds").must(Me.beNumberWhenNotNull),this.ruleFor("statusCode").must(Me.beNumberWhenNotNull),this.ruleFor("statusMessage").must(Me.beStringWhenNotNull),this.ruleFor("permanent").must(Me.beBooleanWhenNotNull),this.ruleFor("exclude").must(Me.beArrayWhenNotNull),this.ruleForEach("exclude").must((t,r)=>Me.beString.predicate(t)).withMessage("each element in an array must be the string").when(t=>Me.notNull(t.exclude))}},jo=class extends uh.BaseValidator{constructor(){super(),this.ruleFor("options").setValidator(t=>new ko),this.ruleFor("path").must(Me.beString)}};Lo.ServeStaticParamsValidator=jo});var ch=p($o=>{"use strict";Object.defineProperty($o,"__esModule",{value:!0});var Y_=L(),Gr=W(),Fo=class extends Y_.BaseValidator{constructor(){super(),this.ruleFor("name").must(Gr.beString).must(Gr.notBeProhibitedHeaderName).must(Gr.beValidHeaderName),this.ruleFor("value").must(Gr.beString).must(Gr.beValidHeaderValue)}};$o.HeaderSetParamsValidator=Fo});var dh=p(Wo=>{"use strict";Object.defineProperty(Wo,"__esModule",{value:!0});var J_=L(),Q_=W(),Uo=class extends J_.BaseValidator{constructor(){super(),this.ruleFor("backend").must(Q_.beStringWhenNotNull)}};Wo.StreamParamsValidator=Uo});var hh=p(Ko=>{"use strict";Object.defineProperty(Ko,"__esModule",{value:!0});var X_=L(),Z_=W(),Go=class extends X_.BaseValidator{constructor(){super(),this.ruleFor("destination").must(Z_.beString)}};Ko.UpdatePathParamsValidator=Go});var fh=p(Yo=>{"use strict";Object.defineProperty(Yo,"__esModule",{value:!0});var eb=L(),ds=W(),zo=class extends eb.BaseValidator{constructor(){super(),this.ruleFor("name").must(ds.beString).must(ds.notBeProhibitedHeaderName).must(ds.beValidHeaderName),this.ruleFor("match").must(t=>t instanceof RegExp).withMessage("must be regex"),this.ruleFor("replace").must(ds.beString)}};Yo.HeaderUpdateParamsValidator=zo});var ph=p(Xo=>{"use strict";Object.defineProperty(Xo,"__esModule",{value:!0});var tb=L(),Jo=W(),Qo=class extends tb.BaseValidator{constructor(){super(),this.ruleFor("name").must(Jo.beString).must(Jo.notBeProhibitedHeaderName).must(Jo.beValidHeaderName)}};Xo.HeaderRemoveParamsValidator=Qo});var gh=p(ea=>{"use strict";Object.defineProperty(ea,"__esModule",{value:!0});var rb=L(),Ct=W(),Zo=class extends rb.BaseValidator{constructor(){super(),this.ruleFor("Expires").must(Ct.beStringWhenNotNull),this.ruleFor("Max-Age").must(Ct.beNumberWhenNotNull),this.ruleFor("Domain").must(Ct.beStringWhenNotNull),this.ruleFor("Path").must(Ct.beStringWhenNotNull),this.ruleFor("Secure").must(Ct.beBooleanWhenNotNull),this.ruleFor("HttpOnly").must(Ct.beBooleanWhenNotNull),this.ruleFor("SameSite").must(Ct.beStringWhenNotNull)}};ea.CookieOptionsValidator=Zo});var mh=p(na=>{"use strict";Object.defineProperty(na,"__esModule",{value:!0});var nb=L(),ta=W(),sb=gh(),ra=class extends nb.BaseValidator{constructor(){super(),this.ruleFor("name").must(ta.beString).must(ta.notBeProhibitedCookieName),this.ruleFor("value").must(ta.beString),this.ruleFor("options").setValidator(()=>new sb.CookieOptionsValidator).when(t=>t.options!==void 0)}};na.CookieAddParamsValidator=ra});var yh=p(ia=>{"use strict";Object.defineProperty(ia,"__esModule",{value:!0});var ib=L(),vh=W(),sa=class extends ib.BaseValidator{constructor(){super(),this.ruleFor("name").must(vh.beString).must(vh.notBeProhibitedCookieName)}};ia.CookieRemoveParamsValidator=sa});var _h=p(ua=>{"use strict";Object.defineProperty(ua,"__esModule",{value:!0});var ob=L(),oa=W(),aa=class extends ob.BaseValidator{constructor(){super(),this.ruleFor("name").must(oa.beString).must(oa.notBeProhibitedCookieName),this.ruleFor("match").must(t=>t instanceof RegExp).withMessage("must be RegExp instance"),this.ruleFor("replace").must(oa.beString)}};ua.CookieUpdateParamsValidator=aa});var bh=p(ca=>{"use strict";Object.defineProperty(ca,"__esModule",{value:!0});var ab=L(),ub=W(),la=class extends ab.BaseValidator{constructor(){super(),this.ruleFor("path").must(ub.beString)}};ca.ServiceWorkerParamsValidator=la});var Eh=p(ha=>{"use strict";Object.defineProperty(ha,"__esModule",{value:!0});var lb=L(),cb=W(),da=class extends lb.BaseValidator{constructor(){super(),this.ruleFor("indexHtmlPath").must(cb.beString)}};ha.AppShellParmsValidator=da});var wh=p(pa=>{"use strict";Object.defineProperty(pa,"__esModule",{value:!0});var db=L(),St=W(),fa=class extends db.BaseValidator{constructor(){super(),this.ruleFor("origin").must(St.beStringWhenNotNull),this.ruleFor("methods").must(St.beArrayWhenNotNull).must((t,r)=>t.every(n=>typeof n=="string")).withMessage("all elements must be of string instance").when(t=>St.notNull(t.methods)),this.ruleFor("headers").must(St.beArrayWhenNotNull).must((t,r)=>t.every(n=>typeof n=="string")).withMessage("all elements must be of string instance").when(t=>St.notNull(t.headers)),this.ruleFor("maxAge").must(St.beNumberWhenNotNull),this.ruleFor("credentials").must(St.beBooleanWhenNotNull)}};pa.CorsOptionsValidator=fa});var Rh=p(va=>{"use strict";Object.defineProperty(va,"__esModule",{value:!0});var hb=L(),ga=W(),ma=class extends hb.BaseValidator{constructor(){super(),this.ruleFor("content").must(t=>typeof t=="string"||typeof t=="function").withMessage("must be string or function").when(t=>ga.notNull(t.content)),this.ruleFor("statusCode").must(ga.beNumberWhenNotNull),this.ruleFor("statusMessage").must(ga.beStringWhenNotNull)}};va.SendParamsValidator=ma});var Ah=p(_a=>{"use strict";Object.defineProperty(_a,"__esModule",{value:!0});var fb=L(),pb=W(),ya=class extends fb.BaseValidator{constructor(){super(),this.ruleFor("callback").must(pb.beFunction)}};_a.ComputeParamsValidator=ya});var Ch=p(Ea=>{"use strict";Object.defineProperty(Ea,"__esModule",{value:!0});var gb=L(),mb=W(),vb=cs(),ba=class extends gb.BaseValidator{constructor(){super(),this.ruleFor("options").must(mb.beObjectWhenNotNull).setValidator(()=>new vb.ProxyOptionsValidator).when(t=>t.options!==void 0)}};Ea.RenderWithAppParamsValidator=ba});var wa=p(et=>{"use strict";Object.defineProperty(et,"__esModule",{value:!0});et.API_DOCS_BASE_URL="https://docs.edg.io/docs/api/core";et.API_DOCS_LINKS={ResponseWriter:`${et.API_DOCS_BASE_URL}/classes/_router_responsewriter_.responsewriter.html`,DeploymentBuilder:`${et.API_DOCS_BASE_URL}/classes/_deploy_deploymentbuilder_.deploymentbuilder.html`,Router:`${et.API_DOCS_BASE_URL}/classes/_router_router_.router.html`};et.DOCS_BASE_URL="https://docs.edg.io"});var Ra=p(G=>{"use strict";Object.defineProperty(G,"__esModule",{value:!0});var yb=eh(),_b=rh(),bb=nh(),Eb=sh(),wb=ih(),Rb=ah(),Ab=lh(),Cb=ch(),Sb=dh(),Tb=hh(),xb=fh(),Ob=ph(),Pb=mh(),Hb=yh(),Nb=_h(),qb=bh(),Db=Eh(),Mb=wh(),Ib=Rh(),Vb=Ah(),Bb=Ch(),X=wa();G.validateRender=e=>{new wb.RenderParamsValidator().validateWithThrow(e,"render",X.API_DOCS_LINKS.ResponseWriter)};G.validateCache=e=>{new yb.CacheOptionsValidator().validateWithThrow(e,"cache",X.API_DOCS_LINKS.ResponseWriter)};G.validateProxyHost=e=>{new _b.ProxyHostParamsValidator().validateWithThrow(e,"proxyHost",X.API_DOCS_LINKS.ResponseWriter)};G.validateRewrite=e=>{new Rb.RewriteParamsValidator().validateWithThrow(e,"rewrite",X.API_DOCS_LINKS.ResponseWriter)};G.validateServeStatic=e=>{new Ab.ServeStaticParamsValidator().validateWithThrow(e,"serveStatic",X.API_DOCS_LINKS.ResponseWriter)};G.validateHeaderSet=(e,t)=>{new Cb.HeaderSetParamsValidator().validateWithThrow(e,t,X.API_DOCS_LINKS.ResponseWriter)};G.validateHeaderUpdate=(e,t)=>{new xb.HeaderUpdateParamsValidator().validateWithThrow(e,t,X.API_DOCS_LINKS.ResponseWriter)};G.validateHeaderRemove=(e,t)=>{new Ob.HeaderRemoveParamsValidator().validateWithThrow(e,t,X.API_DOCS_LINKS.ResponseWriter)};G.validateRenderWithApp=e=>{new Bb.RenderWithAppParamsValidator().validateWithThrow(e,"renderWithApp",X.API_DOCS_LINKS.ResponseWriter)};G.validateCookieAdd=(e,t)=>{new Pb.CookieAddParamsValidator().validateWithThrow(e,t,X.API_DOCS_LINKS.ResponseWriter)};G.validateCookieUpdate=(e,t)=>{new Nb.CookieUpdateParamsValidator().validateWithThrow(e,t,X.API_DOCS_LINKS.ResponseWriter)};G.validateCookieRemove=(e,t)=>{new Hb.CookieRemoveParamsValidator().validateWithThrow(e,t,X.API_DOCS_LINKS.ResponseWriter)};G.validateUpdatePath=e=>{new Tb.UpdatePathParamsValidator().validateWithThrow(e,"updatePath",X.API_DOCS_LINKS.ResponseWriter)};G.validateStream=e=>{new Sb.StreamParamsValidator().validateWithThrow(e,"stream",X.API_DOCS_LINKS.ResponseWriter)};G.validateRedirect=e=>{new Eb.RedirectParamsValidator().validateWithThrow(e,"redirect",X.API_DOCS_LINKS.ResponseWriter)};G.validateServiceWorker=e=>{new qb.ServiceWorkerParamsValidator().validateWithThrow(e,"serviceWorker",X.API_DOCS_LINKS.ResponseWriter)};G.validateAppShell=e=>{new Db.AppShellParmsValidator().validateWithThrow(e,"appShell",X.API_DOCS_LINKS.ResponseWriter)};G.validateAllowCors=e=>{new Mb.CorsOptionsValidator().validateWithThrow(e,"allowCors",X.API_DOCS_LINKS.ResponseWriter)};G.validateSend=e=>{new Ib.SendParamsValidator().validateWithThrow(e,"send",X.API_DOCS_LINKS.ResponseWriter)};G.validateCompute=e=>{new Vb.ComputeParamsValidator().validateWithThrow(e,"compute",X.API_DOCS_LINKS.ResponseWriter)};G.validateProxy=e=>{new bb.ProxyParamsValidator().validateWithThrow(e,"proxy",X.API_DOCS_LINKS.ResponseWriter)}});var ps=p(Tt=>{"use strict";var _e=Tt&&Tt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Tt,"__esModule",{value:!0});var Kr=_e(require("fs")),kb=require("path"),rr=_e(Ks()),hs=_e(ut()),jb=_e(rl()),Lb=_e(oi()),Fb=_e(Xl()),F=re(),Aa=qt(),fs=Ei(),Sh=_e($n()),$b=_e(rc()),zr=Ki(),Ub=_e(td()),pe=Cs(),Wb=_e(Ai()),Th=_e(Ge()),tt=rd(),Gb=Ds(),xh=_e(Wi()),Kb=_e(ri()),zb=_e(or()),I=Ra();Tt.FAR_FUTURE_TTL=60*60*24*365*10;var Ca=class extends Gb.BaseResponseWriter{constructor(t,r,n,s){super(t,r,n),this.params={},this.streaming=!1,this.preCacheRequestActions=[],this.postCacheRequestActions=[],this.preCacheResponseActions=[],this.postCacheResponseActions=[],this.interpolateParams=i=>Lb.default(this.request,this.response,i),this.redirect=(i,o={})=>{I.validateRedirect({to:i,options:o});let{to:a,statusCode:u,query:l}=this._readRedirectParams(i,o),c=Kb.default(this.request.url,rr.default(Aa.isBrowser()?this.interpolateParams(Sh.default.pathWithQueryString(a,l)):Sh.default.pathWithQueryString(a,l),this.request.params));this.setResponseHeader(F.HTTP_HEADERS.location,c),this.send("",u)},this.proxy=async(i,o)=>{I.validateProxy({backend:i,options:o});let a=hs.default.get(`backends.${i}`);await this.proxyHost(a,o)},this.render=i=>{I.validateRender({cb:i}),console.warn(`${tt.warnLogLabel} Warning ResponseWriter#render is deprecated.`),i(this.request,this.proxy,this.request.params)},this.renderWithApp=i=>(I.validateRenderWithApp({options:i}),this.proxy(F.BACKENDS.js,i)),this.stream=i=>{if(I.validateStream({backend:i}),process.env.NODE_ENV==="production")throw new Error("stream can only be used in development");let o=Oh(hs.default.get(`backends.${i}`));this.response.setHeader(F.HTTP_HEADERS.contentType,"text/event-stream"),this.streaming=!0,Fb.default(this.request,this.response,o,Function.prototype),this.setCreateResponseAction(()=>Promise.resolve())},this.proxyHost=async(i,o={})=>{let{path:a,transformRequest:u,transformResponse:l,headers:c,removeEmptySearchParamValues:d}=o;I.validateProxyHost({backendConfig:i,options:o}),i=Oh(i);let h=jb.default.create(i),g;typeof a=="function"?g=a():g=a,g=g&&rr.default(g,this.request.params),await this.setCreateResponseAction(async()=>{var v,f;try{if(u){let R=new pe.InternalTiming(pe.InternalNames.transformRequest).start();try{await this.runImmediately(()=>u(this.request))}finally{R.end()}}let w=new pe.InternalTiming(pe.InternalNames.proxying).start();try{await h.fetch(this.request,this.response,{path:g||this.request.url,disableCheckCert:i.disableCheckCert,headers:c,removeEmptySearchParamValues:d})}finally{w.end()}if(l){let R=new pe.InternalTiming(pe.InternalNames.transformResponse).start();try{$b.default(this.response),await this.runImmediately(()=>l(this.response,this.request))}finally{R.end()}Aa.isCloud()||this.internalSetResponseHeader(F.HTTP_HEADERS.contentLength,Buffer.byteLength((f=(v=this.response.body)===null||v===void 0?void 0:v.toString())!==null&&f!==void 0?f:"","utf8").toString(),!1,this.postCacheResponseActions)}}catch(w){w.type==="BackendFetchError"?(console.error(`${tt.errorLogLabel} Could not connect to backend ${i.domainOrIp}:`,w.message),this.response.statusCode=503):(console.error(`${tt.errorLogLabel} Error in ResponseWriter:`,w.message,w.stack),this.response.statusCode=500)}})},this.updatePath=i=>{I.validateUpdatePath({destination:i});let o=rr.default(i,this.request.params);Object.defineProperty(this.request,"path",{get:()=>o})},this.rewrite=(i,o)=>{I.validateRewrite({destination:i,pattern:o});let a=rr.default(i,this.request.params),u=new URL(this.request.url,"http://host");u.pathname=a,this.request.url=u.pathname+u.search,this.request.path=a,this.request.params=new Wb.default(o).match(a)},this.serveStatic=async(i,o={})=>{I.validateServeStatic({path:i,options:o});let a=i&&rr.default(i,this.request.params),{permanent:u,exclude:l}=o;if(a=a.replace(/\/$/,""),l!=null&&l.some(c=>a.indexOf(c)>=0))return this.send("404 - Not found",404);if(Aa.isCloud()){let c=hs.default.get(`backends.${u?F.BACKENDS.permanentStatic:F.BACKENDS.static}`);await this.proxyHost(c,{path:zb.default(a),transformResponse:async d=>{d.setHeader(F.HTTP_HEADERS.cacheControl,`s-maxage=${Tt.FAR_FUTURE_TTL}`),d.statusCode===403&&(o.loadingPage?await this.proxyHost(hs.default.get(`backends.${F.BACKENDS.static}`),{path:rr.default(o.loadingPage,this.request.params)}):o.onNotFound?await o.onNotFound(this):(d.statusCode=404,d.statusMessage="Not Found")),o.statusCode&&(d.statusCode=o.statusCode),o.statusMessage&&(d.statusMessage=o.statusMessage)}})}else{if(!Kr.default.existsSync(a))return this.send("404 - Not found",404);Kr.default.lstatSync(a).isDirectory()&&(a=kb.join(a,"./index.html"));let c=Kr.default.statSync(a),d=Th.default("mime-types"),h=Th.default("chardet"),g=d.lookup(a);if(g)try{let v=h.analyse(Kr.default.readFileSync(a));if(v.length>0){let{name:f,confidence:w}=v[0];f&&w>90&&(g+=`; charset=${f}`)}}catch{}else g="application/octet-stream";this.setUpstreamResponseHeader(F.HTTP_HEADERS.contentType,g),this.internalSetResponseHeader(F.HTTP_HEADERS.contentLength,c.size.toString(),!1,this.postCacheResponseActions),o.statusCode&&(this.response.statusCode=o.statusCode,this.response.statusMessage=o.statusMessage),await this.setCreateResponseAction(()=>new Promise((v,f)=>{Kr.default.readFile(a,(w,R)=>{w?f(w):(this.response.body=R,v())})}))}},this.cache=i=>{I.validateCache(i);let{browser:o,edge:a,key:u}=i;if(a){let{maxAgeSeconds:l,staleWhileRevalidateSeconds:c,forcePrivateCaching:d}=a,h=[];typeof d<"u"&&(this.context.forcePrivateCaching=d===!0),this.cacheKey=u,typeof this.route.criteria.method=="string"&&(this.context.cacheRouteMethod=this.route.criteria.method),l&&(h.push("max-age="+l),c&&h.push("stale-while-revalidate="+c)),h.length&&this.internalSetResponseHeader(F.HTTP_HEADERS.x0CacheControl,h.join(", "),!1,this.preCacheResponseActions)}if(o||o===!1){let{maxAgeSeconds:l,serviceWorkerSeconds:c}=o||{maxAgeSeconds:0,serviceWorkerSeconds:0};if(c&&l&&l>0)throw console.error(`${tt.errorLogLabel} Within the caching configuration of your "${this.route.criteria.path}" route, when service worker caching is set, the browser max age must be set to zero. Refer to https://docs.edg.io/guides/caching#section_caching_a_response`),new Error("When service worker caching is set, the browser max age must be set to zero. Refer to https://docs.edg.io/guides/caching#section_caching_a_response");l===0?this.setResponseHeader(F.HTTP_HEADERS.cacheControl,"private, no-store, no-cache"):l&&this.setResponseHeader(F.HTTP_HEADERS.cacheControl,`private, max-age=${l}`),(c||c===0)&&this.setResponseHeader(F.HTTP_HEADERS.xSwCacheControl,`max-age=${c}`),o===!1&&this.removeResponseHeader(F.HTTP_HEADERS.xSwCacheControl)}},this.setResponseHeader=(i,o)=>{I.validateHeaderSet({name:i,value:o},"setResponseHeader"),this.internalSetResponseHeader(i,o,!0,this.postCacheResponseActions)},this.internalSetResponseHeader=(i,o,a,u)=>{a&&fs.validateSetResponseHeader(i),this.scheduleExecution(u,()=>{let l=this.interpolateParams(o);this.response.setHeader(i,l)})},this.updateResponseHeader=(i,o,a)=>{I.validateHeaderUpdate({name:i,match:o,replace:a},"updateResponseHeader"),this.internalUpdateResponseHeader(i,o,a,this.preCacheResponseActions)},this.internalUpdateResponseHeader=(i,o,a,u)=>{fs.validateUpdateResponseHeader(i),this.scheduleExecution(u,()=>{let l=this.response.getHeader(i),c=this.interpolateParams(a);l&&this.response.setHeader(i,l.replace(o,c))})},this.removeResponseHeader=i=>{I.validateHeaderRemove({name:i},"removeResponseHeader"),this.internalRemoveResponseHeader(i,this.postCacheResponseActions)},this.internalRemoveResponseHeader=(i,o)=>{fs.validateRemoveResponseHeader(i),this.scheduleExecution(o,()=>{this.response.removeHeader(i)})},this.getSetCookieValues=()=>{let i=this.response.getHeader(F.HTTP_HEADERS.setCookie);return typeof i=="string"?[i]:i||[]},this.getAddResponseCookieAction=(i,o,a={})=>()=>{let u=this.getSetCookieValues(),l=this.interpolateParams(o),c=`${i}=${l}`,d;for(d in a){let h=a[d];typeof h=="boolean"&&h?c+=`; ${d}`:c+=`; ${d}=${h}`}this.response.setHeader(F.HTTP_HEADERS.setCookie,[...u,c])},this.addUpstreamResponseCookie=(i,o,a)=>{I.validateCookieAdd({name:i,value:o,options:a},"addUpstreamResponseCookie"),this.scheduleExecution(this.preCacheResponseActions,this.getAddResponseCookieAction(i,o,a))},this.addResponseCookie=(i,o,a)=>{I.validateCookieAdd({name:i,value:o,options:a},"addResponseCookie"),this.scheduleExecution(this.postCacheResponseActions,this.getAddResponseCookieAction(i,o,a))},this.getUpdateResponseCookieAction=(i,o,a)=>()=>{let u=this.getSetCookieValues().map(l=>{let[c,...d]=l.split("=");if(c!==i)return l;let h=d.join("=").replace(o,a);return[c,h].join("=")});this.response.setHeader(F.HTTP_HEADERS.setCookie,u)},this.updateUpstreamResponseCookie=(i,o,a)=>{I.validateCookieUpdate({name:i,match:o,replace:a},"updateUpstreamResponseCookie"),this.scheduleExecution(this.preCacheResponseActions,this.getUpdateResponseCookieAction(i,o,a))},this.updateResponseCookie=(i,o,a)=>{I.validateCookieUpdate({name:i,match:o,replace:a},"updateResponseCookie"),this.scheduleExecution(this.postCacheResponseActions,this.getUpdateResponseCookieAction(i,o,a))},this.getRemoveResponseCookieAction=i=>()=>{let o=this.getSetCookieValues().filter(a=>a.split("=")[0]!==i);this.response.setHeader(F.HTTP_HEADERS.setCookie,o)},this.removeUpstreamResponseCookie=i=>{I.validateCookieRemove({name:i},"removeUpstreamResponseCookie"),this.scheduleExecution(this.preCacheResponseActions,this.getRemoveResponseCookieAction(i))},this.removeResponseCookie=i=>{I.validateCookieRemove({name:i},"removeResponseCookie"),this.scheduleExecution(this.postCacheResponseActions,this.getRemoveResponseCookieAction(i))},this.setUpstreamResponseHeader=(i,o)=>{I.validateHeaderSet({name:i,value:o},"setUpstreamResponseHeader");let a=i.toLowerCase()!=F.HTTP_HEADERS.x0SurrogateKey;return this.internalSetResponseHeader(i,o,a,this.preCacheResponseActions)},this.updateUpstreamResponseHeader=(i,o,a)=>(I.validateHeaderUpdate({name:i,match:o,replace:a},"updateUpstreamResponseHeader"),this.internalUpdateResponseHeader(i,o,a,this.preCacheResponseActions)),this.removeUpstreamResponseHeader=i=>(I.validateHeaderRemove({name:i},"removeUpstreamResponseHeader"),this.internalRemoveResponseHeader(i,this.preCacheResponseActions)),this.setRequestHeader=(i,o)=>{fs.validateSetRequestHeader(i),this.scheduleExecution(this.postCacheRequestActions,()=>{this.request.headers[i.toLowerCase()]=o})},this.runImmediatelyDepthCounter=0,this.runImmediately=async i=>{try{++this.runImmediatelyDepthCounter,await i()}finally{--this.runImmediatelyDepthCounter}},this.scheduleExecution=(i,o)=>{this.runningImmediately?o():i.push(o)},this.updateRequestHeader=(i,o,a)=>{I.validateHeaderUpdate({name:i,match:o,replace:a},"updateRequestHeader"),this.scheduleExecution(this.postCacheRequestActions,()=>{let u=i.toLowerCase(),l=this.request.headers[u],c=this.interpolateParams(a);Array.isArray(l)?this.request.headers[u]=l.map(d=>d.replace(o,c)):l&&(this.request.headers[u]=l.replace(o,c))})},this.removeRequestHeader=i=>{I.validateHeaderRemove({name:i},"removeRequestHeader"),this.scheduleExecution(this.postCacheRequestActions,()=>{delete this.request.headers[i.toLowerCase()]})},this.serviceWorker=i=>{I.validateServiceWorker({path:i}),this.cache({edge:{maxAgeSeconds:30758400},browser:{maxAgeSeconds:0}}),this.serveStatic(i)},this.appShell=i=>{I.validateAppShell({indexHtmlPath:i}),this.setResponseHeader(F.HTTP_HEADERS.contentType,"text/html"),this.serveStatic(i)},this.allowCors=(i={})=>{I.validateAllowCors(i),this.setResponseHeader("Access-Control-Allow-Origin",i.origin||"*"),i.methods&&this.setResponseHeader("Access-Control-Allow-Methods",i.methods.join(", ")),i.headers&&this.setResponseHeader("Access-Control-Allow-Headers",i.headers.join(", ")),i.maxAge&&this.setResponseHeader("Access-Control-Max-Age",i.maxAge.toString()),i.credentials!=null&&this.setResponseHeader("Access-Control-Allow-Credentials",i.credentials.toString())},this.send=(i,o=200,a)=>{I.validateSend({content:i,statusCode:o,statusMessage:a}),this.setCreateResponseAction(async()=>{this.response.statusCode=o,this.response.statusMessage=a,typeof i=="function"?this.response.body=i():this.response.body=i})},this.compute=i=>{I.validateCompute({callback:i}),this.setCreateResponseAction(async()=>{await this.clearResponseAction().runImmediately(()=>i(this.request,this.response))})},this.onRouteError=i=>{let o={status:"error",message:i.message},a=i.isUserError;a&&console.error(`${tt.errorLogLabel} ${i.message}`),process.env.NODE_ENV!=="production"&&(o={message:`An error occured while running route ${this.route.toString()}: ${i.message}`,stack:a?void 0:i.stack,url:this.request.url});try{this.response.setHeader(F.HTTP_HEADERS.contentType,"application/json"),this.response.writeHead(500),this.response.end(JSON.stringify(o))}catch{console.error(`${tt.errorLogLabel} Could not write error response because headers have already been sent.`,o)}},this.request=t,this.response=r,this.route=n,this.context=s}async sendResponse({beforeResponse:t=()=>!0}={}){let r=!1;for(let i of this.preCacheRequestActions)i();let n,s;if(zr.isCacheEnabled()&&(s=this.context.cacheKey||Ub.default.create(this.request,this.cacheKey),n=zr.getCachedResponse(s),this.cacheKey&&(this.context.cacheKey=s),!this.validatePrefetch(n)))return console.log(`${tt.infoLogLabel} throttle ${this.request.url}`),!0;if(n)r=!0,new pe.InternalTiming(pe.InternalNames.edgeCache).set(pe.CacheValue.hit),this.applyCachedResponse(n);else{for(let o of this.postCacheRequestActions)o();this.createResponseAction&&(await this.createResponseAction(),r=!0);for(let o of this.preCacheResponseActions)o();if(!await t(this.response))return r}if(r&&!this.streaming&&!n&&zr.isCacheEnabled()){let i=zr.maybeCacheResponse({response:this.response,cacheKey:s,context:this.context});new pe.InternalTiming(pe.InternalNames.edgeCache).set(i?pe.CacheValue.cached:pe.CacheValue.pass)}for(let i of this.postCacheResponseActions)i();return r&&!this.streaming&&(this.logCacheStatus(),pe.addTimings(this.response),this.response.statusCode&&this.response.writeHead(this.response.statusCode,this.response.statusMessage||void 0),this.response.end(this.response.body)),r}logCacheStatus(){if(zr.isCacheEnabled()){let t=this.response.getHeader(F.HTTP_HEADERS.x0CachingStatus),r=pe.getInternalTiming(pe.InternalNames.edgeCache),{url:n}=this.request;console.log(`${tt.infoLogLabel} ${r} ${n}${t?` (${t})`:""}`)}}applyCachedResponse(t){this.response.statusCode=t.statusCode,this.response.statusMessage=t.statusMessage,this.response.body=xh.default(t.body);for(let r of Object.keys(t.headers))this.response.setHeader(r,xh.default(t.headers[r]))}validatePrefetch(t){return Object.keys(this.request.query||{}).includes(F.THROTTLED_QUERY_PARAM)&&!t?(this.response.writeHead(F.EDGIO_UNCACHED_PREFETCH_STATUS),this.response.end(),!1):!0}async setCreateResponseAction(t){if(this.runningImmediately)await t();else{if(this.createResponseAction!=null)throw new Error("You may only call one of the following once in your route handler: proxy, serveStatic, serviceWorker, redirect, send.");this.createResponseAction=t}}get runningImmediately(){return this.runImmediatelyDepthCounter>0}clearResponseAction(){return this.createResponseAction=void 0,this}};Tt.default=Ca;function Oh(e){return typeof e=="string"&&(e={domainOrIp:e}),e}});var qh=p(Yr=>{"use strict";var Nh=Yr&&Yr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Yr,"__esModule",{value:!0});var qe=require("os"),Yb=re(),Ph=Nh(ut()),gs=Nh(lo()),Hh=wa();function Jb(e){if(Object.values(Yb.BACKENDS).includes(e)||Ph.default.get(`backends.${e}`,!1))return;let t=Object.keys(Ph.default.get("backends"));throw t&&t.length?new Error(gs.default.redBright(`${qe.EOL}To fix this problem use one of the "backends" configured in edgio.config.js:${qe.EOL}${qe.EOL} - ${t.join(`${qe.EOL} - `)}${qe.EOL}${qe.EOL}or add "${e}" to the "backends" property in edgio.config.js.${qe.EOL}`)+gs.default.yellowBright(`Learn more here: ${Hh.DOCS_BASE_URL}/guides/edgio_config#backends${qe.EOL}`)):new Error(gs.default.redBright(`${qe.EOL}Add "${e}" to the "backends" property in edgio.config.js.${qe.EOL}`)+gs.default.yellowBright(`Learn more here: ${Hh.DOCS_BASE_URL}/guides/edgio_config#backends${qe.EOL}`))}Yr.default=Jb});var xa=p(xt=>{"use strict";var Qb=xt&&xt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},nr=xt&&xt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(xt,"__esModule",{value:!0});var Jr=Qb(Yu()),P=re(),Xb=nr(An()),Zb=nr(Ju()),e1=nr(ps()),Sa=nr($n()),t1=nr(qh()),r1=cr(),n1=nr(or()),J=Ra(),s1=60*60*24*365*10,Ta=class extends e1.default{constructor(t,r,n,s){super(t,r,n,s),this.stream=()=>{},this.setRequestHeader=(i,o)=>{J.validateHeaderSet({name:i,value:o},"setRequestHeader"),this.edgeConfig.transform.request.push({action:P.ACTIONS.setHeader,name:i,value:o})},this.updateRequestHeader=(i,o,a)=>{J.validateHeaderUpdate({name:i,match:o,replace:a},"updateRequestHeader"),this.edgeConfig.transform.request.push({action:P.ACTIONS.updateHeader,name:i,valueRegex:o.source,replaceValue:a})},this.removeRequestHeader=i=>{J.validateHeaderRemove({name:i},"removeRequestHeader"),this.edgeConfig.transform.request.push({action:P.ACTIONS.removeHeader,name:i})},this.setResponseHeader=(i,o)=>{J.validateHeaderSet({name:i,value:o},"setResponseHeader"),this.edgeConfig.transform.response.push({action:P.ACTIONS.setHeader,name:i,value:o})},this.updateResponseHeader=(i,o,a)=>{J.validateHeaderUpdate({name:i,match:o,replace:a},"updateResponseHeader"),this.edgeConfig.transform.response.push({action:P.ACTIONS.updateHeader,name:i,valueRegex:o.source,replaceValue:a})},this.removeResponseHeader=i=>{J.validateHeaderRemove({name:i},"removeResponseHeader"),this.edgeConfig.transform.response.push({action:P.ACTIONS.removeHeader,name:i})},this.setUpstreamResponseHeader=(i,o)=>{J.validateHeaderSet({name:i,value:o},"setUpstreamResponseHeader"),this.edgeConfig.transform.upstreamResponse.push({action:P.ACTIONS.setHeader,name:i,value:o})},this.updateUpstreamResponseHeader=(i,o,a)=>{J.validateHeaderUpdate({name:i,match:o,replace:a},"updateUpstreamResponseHeader"),this.edgeConfig.transform.upstreamResponse.push({action:P.ACTIONS.updateHeader,name:i,valueRegex:o.source,replaceValue:a})},this.removeUpstreamResponseHeader=i=>{J.validateHeaderRemove({name:i},"removeUpstreamResponseHeader"),this.edgeConfig.transform.upstreamResponse.push({action:P.ACTIONS.removeHeader,name:i})},this.addResponseCookie=(i,o)=>{J.validateCookieAdd({name:i,value:o},"addResponseCookie"),this.edgeConfig.transform.response.push({action:P.ACTIONS.addCookie,name:i,value:o})},this.updateResponseCookie=(i,o,a)=>{J.validateCookieUpdate({name:i,match:o,replace:a},"updateResponseCookie"),this.edgeConfig.transform.response.push({action:P.ACTIONS.updateCookie,name:i,valueRegex:o.source,replaceValue:a})},this.removeResponseCookie=i=>{J.validateCookieRemove({name:i},"removeResponseCookie"),this.edgeConfig.transform.response.push({action:P.ACTIONS.removeCookie,name:i})},this.addUpstreamResponseCookie=(i,o)=>{J.validateCookieAdd({name:i,value:o},"addUpstreamResponseCookie"),this.edgeConfig.transform.upstreamResponse.push({action:P.ACTIONS.addCookie,name:i,value:o})},this.updateUpstreamResponseCookie=(i,o,a)=>{J.validateCookieUpdate({name:i,match:o,replace:a},"updateUpstreamResponseCookie"),this.edgeConfig.transform.upstreamResponse.push({action:P.ACTIONS.updateCookie,name:i,valueRegex:o.source,replaceValue:a})},this.removeUpstreamResponseCookie=i=>{J.validateCookieRemove({name:i},"removeUpstreamResponseCookie"),this.edgeConfig.transform.upstreamResponse.push({action:P.ACTIONS.removeCookie,name:i})},this.redirect=(i,o={})=>{J.validateRedirect({to:i,options:o});let{to:a,statusCode:u,query:l}=this._readRedirectParams(i,o),c=!Zb.default(l),d=Jr.getBackReferences(Sa.default.pathWithQueryString(a,l));if(this.shouldParseQueryString(d)||c){this.cache({edge:{maxAgeSeconds:s1}}),this.proxy(P.BACKENDS.js);return}if(this.setEdgeRoute({action:P.ACTIONS.syntheticRes,statusCode:u}),this.edgeConfig.transform.response.push({action:P.ACTIONS.setHeader,name:P.HTTP_HEADERS.location,value:"${url}"}),this.route.criteria.path){let g=Sa.default.toEdgeRegexString(this.route.criteria.path+"{(\\?[^#]+)}?"),v=Jr.getBackReferences(this.route.criteria.path),f=Jr.default(this.route.criteria.path,a)+`\\${Object.keys(v).length+1}`;this.edgeConfig.transform.response.push({action:P.ACTIONS.updateHeader,name:P.HTTP_HEADERS.location,valueRegex:g,replaceValue:f})}else this.edgeConfig.transform.response.push({action:P.ACTIONS.updateHeader,name:P.HTTP_HEADERS.location,valueRegex:Sa.default.toEdgeRegexString("([^?]*){(\\?[^#]+)}?"),replaceValue:`${a}\\2`})},this.serveStatic=(i,o={})=>{let{permanent:a,exclude:u,onNotFound:l,loadingPage:c,expiresSeconds:d,statusCode:h,statusMessage:g,disableAutoPublish:v}=o;J.validateServeStatic({path:i,options:o}),i&&!i.startsWith("/")&&(i=`/${i}`);let f=[],w;c&&(f.push(c),w={valueRegex:this.route.toEdgeRegexString(),replaceValue:Jr.default(this.route.criteria.path,c)}),i&&this.updatePath(n1.default(i)),typeof i=="string"&&f.push(i);let R=a===!0||Xb.default(a,"enabled")||!1;return this.setEdgeRoute({action:P.ACTIONS.proxy,backend:R?P.BACKENDS.permanentStatic:P.BACKENDS.static,fsPath:f,fsExclude:u,fallbackToCompute:l!=null,loadingPage:w,expiresSeconds:d,statusMessage:g,statusCode:h,disableAutoPublish:v}),Promise.resolve()},this.proxy=(i,o={})=>{let{path:a,transformResponse:u,transformRequest:l}=o;return t1.default(i),J.validateProxy({backend:i,options:o}),u!=null||l!=null||typeof a=="function"?i=P.BACKENDS.js:typeof a=="string"&&this.updatePath(a),this.setEdgeRoute({action:P.ACTIONS.proxy,backend:i}),Promise.resolve()},this.updatePath=i=>{J.validateUpdatePath({destination:i});let o=Jr.default(this.route.criteria.path,i);o[0]!=="/"&&(o=`/${o}`),this.edgeConfig.transform.request.push({action:P.ACTIONS.updatePath,valueRegex:this.route.toEdgeRegexString(),replaceValue:o})},this.cache=i=>{J.validateCache(i);let{edge:o,browser:a,key:u}=i;if(o){let{maxAgeSeconds:l,staleWhileRevalidateSeconds:c,forcePrivateCaching:d}=o;this.edgeConfig.cache={maxAgeSeconds:l,staleWhileRevalidateSeconds:c,forcePrivateCaching:d}}else o===!1&&(this.edgeConfig.cache={disabled:!0});if(u&&(this.edgeConfig.cache||(this.edgeConfig.cache={}),this.edgeConfig.cache.customKey=u.toJSON()),a||a===!1){let{maxAgeSeconds:l,serviceWorkerSeconds:c}=a||{maxAgeSeconds:0,serviceWorkerSeconds:0};if(c&&l&&l>0)throw new Error("When service worker caching is set, the browser max age must be set to zero. Refer to https://docs.edg.io/guides/caching#section_caching_a_response");l===0?this.edgeConfig.transform.response.push({action:P.ACTIONS.setHeader,name:P.HTTP_HEADERS.cacheControl,value:"private, no-store, no-cache"}):l&&this.edgeConfig.transform.response.push({action:P.ACTIONS.setHeader,name:P.HTTP_HEADERS.cacheControl,value:`private, max-age=${l}`}),(c||c===0&&a!==!1)&&this.edgeConfig.transform.response.push({action:P.ACTIONS.setHeader,name:P.HTTP_HEADERS.xSwCacheControl,value:`max-age=${c}`}),a===!1&&this.edgeConfig.transform.response.push({action:P.ACTIONS.removeHeader,name:P.HTTP_HEADERS.xSwCacheControl})}},this.send=(i,o,a)=>{J.validateSend({content:i,statusCode:o,statusMessage:a}),typeof i=="function"?this.render():this.setEdgeRoute({action:P.ACTIONS.syntheticRes,statusCode:o,statusMessage:a,content:i})},this.compute=i=>{J.validateCompute({callback:i}),this.setEdgeRoute({action:P.ACTIONS.proxy,backend:P.BACKENDS.js})},this.render=()=>(this.setEdgeRoute({action:P.ACTIONS.proxy,backend:P.BACKENDS.js}),Promise.resolve()),this.edgeConfig={transform:{request:[],upstreamResponse:[],response:[]}}}shouldParseQueryString(t){let r=this.route.criteria.query;return r===void 0?!1:Object.keys(r).some(n=>{let s=r[n];return r1.isParamMatcher(s)&&!!t[n]})}setEdgeRoute(t){this.edgeConfig.route=t,this.edgeConfig.transform.upstreamResponse.push({action:P.ACTIONS.setHeader,name:P.HTTP_HEADERS.vary,value:P.HTTP_HEADERS.acceptEncoding})}};xt.default=Ta});var Ha=p(Pa=>{"use strict";Object.defineProperty(Pa,"__esModule",{value:!0});var Oa=class{constructor(){this.forcePrivateCaching=!1}};Pa.default=Oa});var Dh=p(Qr=>{"use strict";var i1=Qr&&Qr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Qr,"__esModule",{value:!0});var o1=i1(xa()),Na=class extends o1.default{constructor(){super(...arguments),this.proxy=(t,r={})=>{throw new Error("Proxy cannot be used inside router.catch()")}}};Qr.default=Na});var Mh=p((AR,a1)=>{a1.exports={name:"@edgio/core",version:"6.1.0",main:"./index.js",license:"UNLICENSED",scripts:{docs:"typedoc",build:"rm -rf ./dist; mkdir ./dist; cp -r package.json README.md serverless.yml default-app ./dist; tsc; npm run bundle-handler;","bundle-handler":"esbuild src/lambda/handler.ts --bundle --minify --platform=node --target=node14.0 --outfile=dist/lambda/handler.js --log-level=error --sourcemap",watch:"npm-watch","ts:watch":"tsc --watch","push-build":"npm run build && cd dist && yalc push --force && cd ..",release:"cd ./dist; npm publish --access public","release:next":"npm run release -- --tag next",test:"jest --watchAll=false --runInBand --forceExit"},dependencies:{"@babel/parser":"^7.18.9","@babel/traverse":"^7.18.9","@types/lodash.clonedeep":"^4.5.6",ajv:"^6.12.6","babel-loader":"^8.2.2",chalk:"^4.1.2",chardet:"^1.4.0",chokidar:"^3.5.1","cls-hooked":"^4.2.2","content-type":"^1.0.4",cookie:"^0.4.1","cross-spawn":"^7.0.3","decode-uri-component":"^0.2.0",deepmerge:"^4.2.2",esbuild:"^0.14.49",express:"^4.17.1","fluentvalidation-ts":"^2.2.2","fs-extra":"^8.1.0",globby:"^11.0.2","http-proxy":"^1.18.1","lodash.clonedeep":"^4.5.0","lru-cache":"^6.0.0","mime-types":"^2.1.35","node-fetch":"^2.6.1","path-to-regexp":"^6.2.0",pino:"^6.13.3",qs:"^6.11.0","resolve-package-path":"^4.0.3",semver:"^7.3.5",shelljs:"^0.8.5",slash:"^3.0.0","tcp-port-used":"^1.0.2","ts-loader":"^8.2.0",unixify:"^1.0.0",uuid:"^8.3.2","workbox-build":"^6.5.4"},publishConfig:{directory:"dist"},watch:{"push-build":{patterns:["src","bin","serverless.yml","default-app","package.json"],extensions:["js","ts"],quiet:!1}},jest:{clearMocks:!0,collectCoverage:!0,transform:{"^.+\\.(js)?$":"babel-jest","^.+\\.ts$":"ts-jest"},moduleFileExtensions:["ts","js","json"],setupFilesAfterEnv:["<rootDir>/test/jest.js"],transformIgnorePatterns:["<rootDir>/node_modules/"],moduleNameMapper:{"../package.json":"<rootDir>/package.json","^@edgio/core(.*)$":"<rootDir>/src/$1"},collectCoverageFrom:["./src/**/*.{ts,js}","!**/mocks/**","!**/test-utils/**","!**/index.ts","!**/src/types.ts","!**/plugins/PluginBase.ts","!**/bin/**/*"]},devDependencies:{"@types/cls-hooked":"^4.3.1","@types/content-type":"^1.1.3","@types/cookie":"^0.3.3","@types/cross-spawn":"^6.0.2","@types/decode-uri-component":"^0.2.0","@types/express":"^4.17.7","@types/fs-extra":"^8.1.1","@types/http-proxy":"^1.17.4","@types/jest":"^26.0.23","@types/lodash":"^4.14.162","@types/lru-cache":"^5.1.0","@types/mime-types":"^2.1.0","@types/node":"^14.6.4","@types/route-parser":"^0.1.3","@types/semver":"^7.3.9","@types/shelljs":"^0.8.8","@types/tcp-port-used":"^1.0.0","@types/unixify":"^1.0.0","@types/uuid":"^8.0.1","@types/webpack-bundle-analyzer":"^3.9.0","@types/workbox-build":"^5.0.1",lodash:"^4.17.21",nock:"^13.2.8",stripe:"^9.12.0",webpack:"^5.27.0","webpack-bundle-analyzer":"^3.9.0","webpack-dev-middleware":"^4.1.0"}}});var Lh=p(Xr=>{"use strict";var Ot=Xr&&Xr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Xr,"__esModule",{value:!0});var u1=Ot(ut()),Ih=Ot(Tn()),l1=Ot(Fu()),qa=Ot(Uu()),c1=Ot(xa()),jh=re(),Vh=Ot(Ha()),d1=cr(),h1=Ot(Dh());function f1({edgeConfig:e},t){var r,n;return e.cache&&((r=e.cache)===null||r===void 0?void 0:r.maxAgeSeconds)&&((n=e.cache)===null||n===void 0?void 0:n.maxAgeSeconds)>0&&t?{...e.cache,matchExplicitMethod:t}:e.cache}function p1({edgeConfig:e},t){var r;let n=e.route;return((r=e.route)===null||r===void 0?void 0:r.action)===jh.ACTIONS.syntheticRes&&!e.route.statusCode&&!t&&(e.route.statusCode=200),n}function g1({edgeConfig:e}){return e.transform}function m1(e){var t;let r=[],n=[],s,i;if(e.criteria.protocol){let o;if(typeof e.criteria.protocol=="string"?o=new RegExp(`^${e.criteria.protocol}$`,"i"):o=new RegExp(e.criteria.protocol),!o.test("http")&&!o.test("https"))throw new Error('Protocol matcher must match either "http" or "https"');s=o.source}if(e.criteria.path&&r.push({value:"${path}",matchRegex:e.toEdgeRegexString()}),e.criteria.method){let o;typeof e.criteria.method!="string"?o=e.criteria.method:(o=l1.default(e.criteria.method),Object.values(jh.HTTP_METHODS).includes(e.criteria.method)&&(i=e.criteria.method)),r.push({value:"${method}",matchRegex:Ih.default(o)})}return e.criteria.headers&&Object.entries(e.criteria.headers).forEach(([o,a])=>{r.push({value:`\${req:${o}}`,matchRegex:qa.default(a)})}),!((t=e.criteria.response)===null||t===void 0)&&t.statusCode&&n.push({value:"${res:status}",matchRegex:Ih.default(e.criteria.response.statusCode)}),e.criteria.query&&Object.entries(e.criteria.query).forEach(([o,a])=>{d1.isParamMatcher(a)||r.push({value:`\${query:${o}}`,matchRegex:qa.default(a)})}),e.criteria.cookies&&Object.entries(e.criteria.cookies).forEach(([o,a])=>{r.push({value:`\${req:cookie:${o}}`,matchRegex:qa.default(a)})}),{match:r,matchResp:n,matchExplicitMethod:i,matchProtocolJavaScriptRegExpSource:s}}async function v1(e){let t={};if(!Object.keys(e.getDestinations()).length)t={default:await kh(e)};else for(let r in e.getDestinations())t[r]=await kh(e.getDestinations()[r]);return{version:y1(),backends:{...u1.default.get("backends")},destinations:t}}Xr.default=v1;function y1(){return Mh().version}async function Bh(e,t,r,n){try{await e.handler(t)}catch(u){Error.captureStackTrace(u),r.push({route:e.toString(),stackTrace:u.stack})}let{match:s,matchResp:i,matchExplicitMethod:o,matchProtocolJavaScriptRegExpSource:a}=m1(e);return{path:e.criteria.path,routeJson:e.toJson(),match:s,matchResp:i,matchProtocolJavaScriptRegExpSource:a,cache:f1(t,o),route:p1(t,n),transform:g1(t)}}async function kh(e){let t=[],r={index:e.index,errorRoutes:await Promise.all(e.getRouteGroups().getRoutes().filter(n=>n.isRespRoute()).map(n=>Bh(n,new h1.default({url:"",headers:{}},{},n,new Vh.default),t,!0))),routes:await Promise.all(e.getRouteGroups().getRoutes().filter(n=>!n.isRespRoute()).map(n=>Bh(n,new c1.default({url:"",headers:{}},{},n,new Vh.default),t,!1)))};if(t.length){let n=`
Errors occurred while attempting to deploy your application to Edgio edge.
The following ${t.length>1?"routes":"route"} could not be processed:`;throw t.forEach(({route:s,stackTrace:i})=>{n=n.concat(`
* ${s}: ${i}`)}),new Error(n)}return r}});var Fh=p(Da=>{"use strict";Object.defineProperty(Da,"__esModule",{value:!0});function _1(e,t){if(!e||!e.length)return;let r,n,s=!1;for(let i of e){if(!s){r=i,t&&(n=t(i)),s=!0;continue}if(t){let o=t(i);o<n&&(r=i,n=o)}else i<r&&(r=i)}return r}Da.default=_1});var $h=p(Ia=>{"use strict";Object.defineProperty(Ia,"__esModule",{value:!0});var Ma=class{constructor(){this._tasks=[],this._resolveHandler=Function.prototype,this._errorHandler=t=>{throw t}}add(...t){return this._tasks.push(...t),this}onTaskDone(t){return this._resolveHandler=t,this}onTaskError(t){return this._errorHandler=t,this}resolve(){let t=this._convertTasksToPromises().map((r,n)=>r.then(s=>(this._resolveHandler(s),s)).catch(s=>this._errorHandler(s)));return Promise.all(t)}_convertTasksToPromises(){return this._tasks.map(t=>{if(typeof t!="function")return Promise.resolve(t);try{let r=t();return r instanceof Promise?r:Promise.resolve(r)}catch(r){return Promise.reject(r)}})}};Ia.default=Ma});var Gh=p(Zr=>{"use strict";var Wh=Zr&&Zr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Zr,"__esModule",{value:!0});var b1=Wh(ut()),Uh=Wh($h()),sr=class{constructor(){this.options=[]}push(...t){this.options.push(...t)}static async resolveDestinationPreloadConfig(t,r){let n=[];return await new Uh.default().add(...t.preloadRequests.options).onTaskDone(s=>{n.push(...s.map(i=>({...i,destination:r})))}).resolve(),{requests:n}}static async resolvePreloadConfig(t){let r=[],n=new Uh.default,s=t.getDestinations();if(!Object.keys(s).length)n.add(sr.resolveDestinationPreloadConfig(t,"default"));else for(let i in s)n.add(sr.resolveDestinationPreloadConfig(s[i],i));return await n.onTaskDone(({requests:i})=>{r.push(...i)}).resolve(),{requests:r,concurrency:b1.default.get("prerenderConcurrency",null)}}};Zr.default=sr});var Kh=p(Va=>{"use strict";Object.defineProperty(Va,"__esModule",{value:!0});function E1(e){return new Promise((t,r)=>{let n=[];e.on("data",s=>s&&n.push(s)),e.on("end",()=>{t(Buffer.concat(n))}),e.on("abort",s=>{r(s)})})}Va.default=E1});var zh=p(ms=>{"use strict";Object.defineProperty(ms,"__esModule",{value:!0});function w1(){return process.env.EDGIO_ROOT_SOURCE_DIR||process.cwd()}ms.getSourceDir=w1;function R1(e){process.env.EDGIO_ROOT_SOURCE_DIR=e}ms.setSourceDir=R1});var Jh=p(en=>{"use strict";var A1=en&&en.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(en,"__esModule",{value:!0});var Yh=A1(Ge());function C1(e){try{let t=require.resolve(e,{paths:[require.resolve("@edgio/core")]});return Yh.default(t)}catch{return Yh.default(e)}}en.default=C1});var ja=p(We=>{"use strict";var rn=We&&We.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(We,"__esModule",{value:!0});var S1=rn($n()),T1=Ki(),Ba=qt(),Qh=require("path"),x1=rn(Ge()),O1=rn(Ri()),tn=re(),P1=zh(),Xh=rn(or()),H1=rn(Jh());We.staticAssetManifest={};We.STATIC_ASSET_MANIFEST_FILE="static-asset-manifest.json";var ka=class{constructor(t){if(this._routes=[],!t)throw new Error("Route group name is required!");this.name=t}match(t,r,{index:n,label:s}={}){let i=new S1.default(t,r,{label:s});return n!=null?this._routes.splice(n,0,i):this._routes.push(i),this}dir(t,r){let n=Qh.join(P1.getSourceDir(),t),s=We.staticAssetManifest[Xh.default(t)]=[],{ignore:i,label:o}=r;typeof i=="string"&&(i=[i]);let a=Ba.isCloud()?this.staticAssetsForPath(t):H1.default("globby").sync(r.glob||"**/*",{cwd:n,onlyFiles:!0,ignore:i||[]});r.sort&&(a=r.sort(a));for(let u of a){let l=r.paths&&r.paths(u)||[`/${u}`];Ba.isCloud()||s.push(Xh.default(u));for(let c of l){let d=c.replace(/\/index.html$/,"");d.length===0&&(d="/"),this.match(d,async h=>{r.handler&&r.handler(u)(h)},{label:o})}}return this}static(t,r){let n=s=>i=>{r.handler&&r.handler(s)(i),i.serveStatic(`${t}/${s}`)};return this.dir(t,{...r,handler:n,label:`static('${t}')`})}requireBasicAuth(t){let{route:r,username:n,password:s,realm:i="Access to the site"}=t;if(n&&s){let o=Buffer.from(`${n}:${s}`).toString("base64");r=O1.default(r),this.match({...r,headers:{...r.headers,[tn.HTTP_HEADERS.authorization]:null,[tn.HTTP_HEADERS.x0MatchedRoutes]:null}},({send:a,setResponseHeader:u})=>{u("WWW-Authenticate",`Basic realm="${i}"`),a("",401,"Unauthorized")}).match({...r,headers:{...r.headers,[tn.HTTP_HEADERS.authorization]:new RegExp(`^((?!Basic ${o}).)*$`),[tn.HTTP_HEADERS.x0MatchedRoutes]:null}},({send:a})=>{a("",403,"Forbidden")}).match({...r,headers:{...r.headers,[tn.HTTP_HEADERS.x0MatchedRoutes]:null}},({removeRequestHeader:a})=>{a("authorization")})}return this}staticAssetsForPath(t){return x1.default(Qh.join(process.cwd(),We.STATIC_ASSET_MANIFEST_FILE))[t]}clear(){return this._routes=[],Ba.isCloud()||T1.clearCache(),this}get routes(){return this._routes}get length(){return this._routes.length}};We.default=ka});var Zh=p(nn=>{"use strict";var N1=nn&&nn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(nn,"__esModule",{value:!0});var q1=N1(ja()),D1=re(),La=class{constructor(){this.routeGroups=[]}add(t){return this.routeGroups.push(t),this}getGroups(){return this.routeGroups}findByName(t){return this.routeGroups.find(r=>r.name===t)}getRoutes(){let t=[];return this.getGroups().forEach(r=>{t=t.concat(r.routes)}),this.fallback&&(t=t.concat(this.fallback.routes)),t}setFallback(t){let r=new q1.default(D1.ROUTES_FALLBACK);r.match(null,t),this.fallback=r}get length(){return this.routeGroups.length}};nn.default=La});var nf=p(Ht=>{"use strict";var De=Ht&&Ht.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},M1=Ht&&Ht.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(Ht,"__esModule",{value:!0});var x=re(),ef=Cs(),I1=vu(),V1=De(Pu()),B1=De(Hu()),k1=De(ut()),j1=De(Lh()),L1=De(oi()),F1=De(Fh()),tf=De(Gh()),$1=De(Kh()),U1=De(Ha()),W1=De(ps()),rf=M1(ja()),G1=De(Zh()),K1=/\bbr\b/,z1=/\bgzip\b/,Pt=class{constructor(t={excludeBuiltInRoutes:!1}){this.routeGroups=new G1.default,this.preloadRequests=new tf.default,this.plugins=[],this.destinations={},this.nextRouterIndex=0,this._index=0,this.processRequestHeaders=r=>{r.headers[x.HTTP_HEADERS.xRequestId]||(this.newRequestId=I1.v4(),r.headers[x.HTTP_HEADERS.xRequestId]=this.newRequestId);let n=r.headers[x.HTTP_HEADERS.acceptEncoding];if(typeof n=="string"){let o=z1.test(n),a=K1.test(n);o&&a?n=`${x.GZIP_ENCODING}, ${x.BROTLI_ENCODING}`:o?n=x.GZIP_ENCODING:a?n=x.BROTLI_ENCODING:n=null}else n=null;n?r.headers[x.HTTP_HEADERS.acceptEncoding]=n:delete r.headers[x.HTTP_HEADERS.acceptEncoding];let s=r.connection,i="127.0.0.1";if(s&&s.remoteAddress){if(i=s.remoteAddress,r.headers[x.HTTP_HEADERS.x0Protocol]!=="http"){let o=r.headers[x.HTTP_HEADERS.cookie];typeof o=="string"&&/\blocal_edgio_emulate_http_protocol=true\b/.test(o)?r.headers[x.HTTP_HEADERS.x0Protocol]="http":r.headers[x.HTTP_HEADERS.x0Protocol]="https"}}else r.headers[x.HTTP_HEADERS.x0Protocol]||(r.headers[x.HTTP_HEADERS.x0Protocol]="https");r.headers[x.HTTP_HEADERS.xForwardedFor]?r.headers[x.HTTP_HEADERS.xForwardedFor]=`${r.headers[x.HTTP_HEADERS.xForwardedFor]}, ${i}`:r.headers[x.HTTP_HEADERS.xForwardedFor]=`${i}`,r.headers[x.HTTP_HEADERS.x0ClientIp]||(r.headers[x.HTTP_HEADERS.x0ClientIp]=r.headers[x.HTTP_HEADERS.xForwardedFor].split(",")[0]),Pt.isRequestFromEdge(r)||(this.processRequestDeviceHeaders(r),this.processRequestGeoHeaders(r))},this.processRequestDeviceHeaders=r=>{let n="desktop",s="generic",i=!1,o="generic",a=(r.headers[x.HTTP_HEADERS.userAgent]||"").toLowerCase();/ipad/.test(a)?(n="tablet",s="apple"):/ip(hone|od)/.test(a)?(n="smartphone",s="apple"):/android.*(mobile|mini)/.test(a)?(n="smartphone",s="android"):/android/.test(a)?(n="tablet",s="android"):/opera mobi/.test(a)?(n="smartphone",s="android"):/playbook u rim tablet/.test(a)?(n="tablet",s="blackberry"):/hp-tablet.*touchpad/.test(a)?(n="tablet",s="hp"):/kindle\/3/.test(a)?(n="tablet",s="kindle"):/mobile.+firefox/.test(a)?(n="mobile",s="firefoxos"):/^htc/.test(a)?(n="smartphone",s="htc"):/fennec/.test(a)?(n="smartphone",s="fennec"):/iemobile/.test(a)?(n="smartphone",s="microsoft"):/blackberry/.test(a)||/bb10.*mobile/.test(a)?(n="smartphone",s="blackberry"):/gt-.*build\/gingerbread/.test(a)?(n="smartphone",s="android"):/symbianos.*applewebkit/.test(a)?(n="smartphone",s="symbian"):(/symbian/.test(a)||/^sonyericsson/.test(a)||/^nokia/.test(a)||/^samsung/.test(a)||/^lg/.test(a)||/bada/.test(a)||/blazer/.test(a)||/cellphone/.test(a)||/midp-2.0/.test(a)||/u990/.test(a)||/netfront/.test(a)||/opera mini/.test(a)||/palm/.test(a)||/nintendo wii/.test(a)||/playstation portable/.test(a)||/portalmmm/.test(a)||/proxinet/.test(a)||/sonyericsson/.test(a)||/windows ?ce/.test(a)||/winwap/.test(a)||/eudoraweb/.test(a)||/240x320/.test(a)||/avantgo/.test(a))&&(n="mobile"),/bot/.test(a)||/crawler/.test(a)||/headless/.test(a)||/prerender/.test(a)||/preview/.test(a)||/scanner/.test(a)||/slurp/.test(a)||/spider/.test(a)||/(developers.google.com\/+\/web\/snippet|embedly|facebookexternalhit|flipboard|googlepagespeed|google page speed)/.test(a)||/(ia_archiver|moov-prerender-cache-exerciser|nuzzel|outbrain|pinterest|qwantify|tumblr|vkshare)/.test(a)||/(w3c_validator|whatsapp|xing-contenttabreceiver|yahoo)/.test(a)?i=!0:i=!1,/edge/.test(a)?o="edge":/chrome|chromium|crios/.test(a)?o="chrome":/firefox/.test(a)?o="firefox":/opera|opr/.test(a)?o="opera":/msie/.test(a)||/trident/.test(a)?o="msie":/safari/.test(a)&&(o="safari"),r.headers[x.HTTP_HEADERS.x0Device]=n,r.headers[x.HTTP_HEADERS.x0DeviceIsBot]=i?"1":"0",r.headers[x.HTTP_HEADERS.x0Vendor]=s,r.headers[x.HTTP_HEADERS.x0Browser]=o},this.processRequestGeoHeaders=r=>{r.headers[x.HTTP_HEADERS.x0GeoCity]="San Francisco",r.headers[x.HTTP_HEADERS.x0GeoCountryCode]="US",r.headers[x.HTTP_HEADERS.x0GeoLatitude]="37.792094",r.headers[x.HTTP_HEADERS.x0GeoLongitude]="-122.401622",r.headers[x.HTTP_HEADERS.x0GeoPostalCode]="94104"},this.processRequestBody=async r=>{r.rawBody=await $1.default(r),Object.defineProperty(r,"body",{configurable:!0,get(){return this.rawBody.toString("utf8")}})},this.isUserHeaderCountWithinLimits=r=>Object.keys(r).filter(s=>s.toLowerCase().indexOf(x.EDGIO_HEADERS_PREFIX)!==0).length<=x.EDGIO_MAX_USER_HEADERS_ALLOWED,this.patchResWriteHead=(r,n)=>{let s=n.writeHead;n.writeHead=(...i)=>{n.writeHead=s,this.newRequestId&&n.setHeader(x.HTTP_HEADERS.xRequestId,this.newRequestId);let a=i[2];if(a)for(let u of Object.keys(a))n.setHeader(u,L1.default(r,n,a[u]));if(this.isUserHeaderCountWithinLimits(n.getHeaders())){n.writeHead(...i);return}n.writeHead(x.EDGIO_TOO_MANY_HEADERS_STATUS_CODE,"Too many response headers")}},this.run=async(r,n)=>{let s=new ef.InternalTiming(ef.InternalNames.routeMatching).start(),i=this,o=new U1.default;if(this.processRequestHeaders(r),!this.isUserHeaderCountWithinLimits(r.headers)){n.writeHead(x.EDGIO_TOO_MANY_HEADERS_STATUS_CODE,"Too many request headers"),n.end();return}if(await this.processRequestBody(r),this.patchResWriteHead(r,n),Object.keys(this.destinations).length>1){let{EDGIO_ROUTER_DESTINATION:c}=process.env,d=r.headers[x.HTTP_HEADERS.x0Destination]||c;if(d||(d=F1.default(Object.keys(this.destinations),h=>this.destinations[h]._index)),i=this.destinations[d],!i)throw new Error(`Routing destination "${d}" not found.`)}i.plugins.forEach(c=>c.onRequest(r));let a=c=>{let d=new W1.default(r,n,c,o);return Pt.isRequestFromEdge(r)?B1.default.create(d):d},u=i.routeGroups.getRoutes().filter(c=>!c.isRespRoute()),l=i.routeGroups.getRoutes().filter(c=>c.isRespRoute());for(let c of u){let d;try{if(s.resume(),!c.match(r))continue;if(s.pause(),d=a(c),await c.handler(d),await d.sendResponse({beforeResponse:async g=>{if(!Pt.isRequestFromEdge(r)){for(let v of l)if(s.resume(),!!v.matchResponse(g))return s.pause(),d=a(v),await v.handler(d),d.sendResponse(),!1}return!0}}))return}catch(h){d=d||a(r,n,c,o),d.onRouteError(h);return}}this.builtInFallback(r,n)},t.excludeBuiltInRoutes||V1.default(this,t)}getStaticAssetManifest(){return rf.staticAssetManifest}setBackend(t,r){return k1.default.get("backends")[t]=r,this}use(t){return t.onRegister(this),this.plugins.push(t),this}destination(t,r){return r.setIndex(this.nextRouterIndex++),this.destinations[t]=r,this}getPlugins(){let t=this.plugins;for(let r of Object.values(this.destinations))t=t.concat(r.getPlugins());return t}setIndex(t){this._index=t}get index(){return this._index}group(t,r){let n=new rf.default(t);return r(n),this.routeGroups.add(n),this}match(t,r){return this.group("root",n=>n.match(t,r))}prerender(...t){return this.preloadRequests.push(...t),this}matchMethod(t,r,n){if(typeof r=="string")return this.match({method:t,path:r},n);if(r.method)throw new Error(`Invalid criteria property method passed to call to Router#${t}. Specifying a method in the criteria is redundant.`);return this.match({...r,method:t},n)}head(t,r){return this.matchMethod(x.HTTP_METHODS.head,t,r)}get(t,r){return this.matchMethod(x.HTTP_METHODS.get,t,r)}post(t,r){return this.matchMethod(x.HTTP_METHODS.post,t,r)}delete(t,r){return this.matchMethod(x.HTTP_METHODS.delete,t,r)}put(t,r){return this.matchMethod(x.HTTP_METHODS.put,t,r)}patch(t,r){return this.matchMethod(x.HTTP_METHODS.patch,t,r)}options(t,r){return this.matchMethod(x.HTTP_METHODS.options,t,r)}fallback(t){return this.routeGroups.setFallback(t),this}catch(t,r){let n;return t instanceof RegExp?n=t:n=new RegExp(`^${t.toString()}$`),this.group(x.ROUTES_CATCH_GROUP,s=>s.match({headers:{"x-0-error-status-code":n},response:{statusCode:n}},async i=>{await r(i),i.cache({edge:!1,browser:{maxAgeSeconds:0}})})),this}noIndexPermalink(){return this}builtInFallback(t,r){let n=t.connection;n&&n.remoteAddress?r.writeHead(404):t.headers[x.HTTP_HEADERS.x0Protocol]==="http"?(r.setHeader(x.HTTP_HEADERS.location,`https://${t.headers[x.HTTP_HEADERS.host]}${t.url}`),r.writeHead(301)):r.writeHead(404),r.end()}static(t,r={}){return this.group("root",n=>n.static(t,r))}requireBasicAuth(t){return this.group("root",r=>r.requireBasicAuth(t))}createEdgeConfig(){return j1.default(this)}createPreloadConfig(){return tf.default.resolvePreloadConfig(this)}getDestinations(){return this.destinations}getRouteGroups(){return this.routeGroups}toString(){return`Routes
======
`+this.routeGroups.getRoutes().map((t,r)=>`${r}:	${t.toString()}`).join(`
`)}static isRequestFromEdge(t){return typeof t.headers[x.HTTP_HEADERS.x0Version]=="string"}};Ht.default=Pt});var of=p(sn=>{"use strict";function sf(e){for(var t in e)sn.hasOwnProperty(t)||(sn[t]=e[t])}Object.defineProperty(sn,"__esModule",{value:!0});sf(Fa());sf(re());var Y1=ut();sn.config=Y1.default});var uf=p($a=>{"use strict";Object.defineProperty($a,"__esModule",{value:!0});var af=of();function J1(e,t={onConflict:"merge"}){return async r=>{let n=e(Q1(r.body));if(!Array.isArray(n)){console.warn(`The function provided to deriveSurrogateKeysFromJson should return an array, but returned a value of type "${typeof n}" instead. Surrogate keys will not be set.`);return}let s=new Set(n);if(t.onConflict==="merge"){let i=r.getHeader(af.HTTP_HEADERS.x0SurrogateKey);if(i!=null){Array.isArray(i)||(i=[i]);for(let o of i)for(let a of o.split(" "))s.add(a)}}else if(t.onConflict!=="override")throw new Error(`invalid value "${t.onConflict}" for onConflict option in deriveSurrogateKeysFromJson. Use "override" or "merge".`);s.size>0&&r.setHeader(af.HTTP_HEADERS.x0SurrogateKey,Array.from(s).join(" "))}}$a.default=J1;function Q1(e){if(!!e)try{return JSON.parse(typeof e=="string"?e:e.toString("utf8"))}catch{return}}});var lf=p(on=>{"use strict";var X1=on&&on.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(on,"__esModule",{value:!0});var Z1=X1(es());function eE(){return new Z1.default}on.default=eE});var Fa=p(Nt=>{"use strict";Object.defineProperty(Nt,"__esModule",{value:!0});var tE=nf();Nt.Router=tE.default;var rE=es();Nt.CustomCacheKey=rE.default;var nE=ps();Nt.ResponseWriter=nE.default;var sE=uf();Nt.deriveSurrogateKeysFromJson=sE.default;var iE=lf();Nt.createCustomCacheKey=iE.default});var aE={};mf(aE,{default:()=>oE});module.exports=vf(aE);var cf=Wa(Fa()),oE=new cf.Router().fallback(({proxy:e})=>e("origin"));0&&(module.exports={});
/*!
 * Array of passes.
 *
 * A `pass` is just a function that is executed on `req, res, options`
 * so that you can easily add new checks while still keeping the base
 * flexible.
 */
/*!
 * Array of passes.
 *
 * A `pass` is just a function that is executed on `req, socket, options`
 * so that you can easily add new checks while still keeping the base
 * flexible.
 */
/*!
 * Caron dimonio, con occhi di bragia
 * loro accennando, tutte le raccoglie;
 * batte col remo qualunque sadagia 
 *
 * Charon the demon, with the eyes of glede,
 * Beckoning to them, collects them all together,
 * Beats with his oar whoever lags behind
 *          
 *          Dante - The Divine Comedy (Canto III)
 */
/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */
//# sourceMappingURL=routes.js.map
